<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GitHub Token 配置说明 - Bookmark Backup</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #ffffff;
      --card: #f6f8fa;
      --text: #24292f;
      --muted: #57606a;
      --border: #d0d7de;
      --link: #0969da;
      --code-bg: rgba(175, 184, 193, 0.2);
      --btn-bg: transparent;
      --btn-border: #0969da;
      --btn-text: #0969da;
      --ok: #1a7f37;
      --warn: #bf8700;
    }

    /* Dark Mode - respects system pref unless overridden by data-theme="light", or forced by data-theme="dark" */
    @media (prefers-color-scheme: dark) {
      :root:not([data-theme="light"]) {
        --bg: #0d1117;
        --card: #161b22;
        --text: #c9d1d9;
        --muted: #8b949e;
        --border: #30363d;
        --link: #58a6ff;
        --code-bg: rgba(110, 118, 129, 0.4);
        --btn-border: #58a6ff;
        --btn-text: #58a6ff;
        --ok: #3fb950;
        --warn: #d29922;
      }
    }

    :root[data-theme="dark"] {
      --bg: #0d1117;
      --card: #161b22;
      --text: #c9d1d9;
      --muted: #8b949e;
      --border: #30363d;
      --link: #58a6ff;
      --code-bg: rgba(110, 118, 129, 0.4);
      --btn-border: #58a6ff;
      --btn-text: #58a6ff;
      --ok: #3fb950;
      --warn: #d29922;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 18px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial,
        "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
      line-height: 1.65;
    }

    .container {
      max-width: 920px;
      margin: 0 auto;
    }

    .topbar {
      position: sticky;
      top: 0;
      z-index: 10;
      background: color-mix(in srgb, var(--bg) 85%, transparent);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      padding: 12px 0;
      margin: -18px -18px 18px -18px;
    }

    .topbar-inner {
      max-width: 920px;
      margin: 0 auto;
      padding: 0 18px;
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
    }

    .title {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    h1 {
      margin: 0;
      font-size: 18px;
      line-height: 1.25;
    }

    .subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 13px;
    }

    .lang-toggle {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .lang-btn {
      appearance: none;
      border: 1px solid var(--border);
      background: var(--btn-bg);
      color: var(--text);
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 13px;
      cursor: pointer;
    }


    .lang-btn.active {
      border-color: var(--btn-border);
      color: var(--btn-text);
      font-weight: 600;
    }

    .theme-btn {
      appearance: none;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 999px;
      color: var(--text);
      cursor: pointer;
      padding: 6px;
      width: 32px;
      height: 32px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-right: 8px;
    }

    .theme-btn:hover {
      background: var(--btn-bg);
      border-color: var(--btn-border);
      color: var(--btn-text);
    }

    .theme-icon {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 14px 16px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    @media (min-width: 860px) {
      .grid.two {
        grid-template-columns: 1fr 1fr;
      }
    }

    .flow {
      display: grid;
      grid-template-columns: 1fr;
      gap: 15px;
    }

    @media (min-width: 860px) {
      .flow {
        /* User wants them wider, so maybe 2 columns instead of 3, or just let them expand */
        grid-template-columns: 1fr 1fr;
      }
    }

    .flow-step {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px 16px;
      background: color-mix(in srgb, var(--card) 82%, transparent);
      display: flex;
      flex-direction: column;
      min-height: 140px;
      /* Ensure some height */
    }

    .step-head {
      display: flex;
      gap: 10px;
      align-items: flex-start;
    }

    .badge {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      border: 1px solid var(--border);
      flex: 0 0 auto;
    }

    .badge.ok {
      border-color: color-mix(in srgb, var(--ok) 55%, var(--border));
      color: var(--ok);
    }

    .badge.warn {
      border-color: color-mix(in srgb, var(--warn) 55%, var(--border));
      color: var(--warn);
    }

    .step-title {
      font-weight: 700;
      margin: 0;
      line-height: 1.25;
    }

    .step-desc {
      margin: 6px 0 0 0;
      color: var(--muted);
      font-size: 13px;
    }

    .actions {
      margin-top: auto;
      /* Push to bottom */
      display: flex;
      justify-content: flex-end;
      /* Align right */
      gap: 8px;
      padding-top: 12px;
    }

    a {
      color: var(--link);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    .btn-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--btn-border);
      color: var(--btn-text);
      background: var(--btn-bg);
      border-radius: 10px;
      padding: 8px 10px;
      font-size: 13px;
      text-decoration: none;
    }

    code {
      background: var(--code-bg);
      padding: 2px 6px;
      border-radius: 6px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
        "Courier New", monospace;
      font-size: 0.95em;
    }

    h2 {
      margin: 18px 0 8px 0;
      font-size: 16px;
    }

    h3 {
      margin: 12px 0 6px 0;
      font-size: 14px;
    }

    p {
      margin: 6px 0;
    }

    ul,
    ol {
      margin: 8px 0 0 18px;
      padding: 0;
    }

    li {
      margin: 6px 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0 4px 0;
      font-size: 13px;
    }

    th,
    td {
      border: 1px solid var(--border);
      padding: 8px 10px;
      vertical-align: top;
    }

    th {
      text-align: left;
      background: rgba(0, 0, 0, 0.04);
    }

    @media (prefers-color-scheme: dark) {
      th {
        background: rgba(255, 255, 255, 0.04);
      }
    }

    .callout {
      border: 1px solid var(--border);
      border-left: 4px solid var(--btn-border);
      border-radius: 12px;
      padding: 10px 12px;
      margin-top: 10px;
      background: color-mix(in srgb, var(--card) 75%, transparent);
    }

    .muted {
      color: var(--muted);
    }

    details {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      background: color-mix(in srgb, var(--card) 78%, transparent);
      margin-top: 10px;
    }

    summary {
      cursor: pointer;
      font-weight: 700;
    }

    .lang-block[hidden] {
      display: none !important;
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="title">
        <div data-lang="zh">
          <h1 data-i18n="title">GitHub Token 配置说明（用于本插件的备份功能）</h1>
          <p class="subtitle" data-i18n="subtitle">
            Cloud 2 使用 GitHub 私有仓库备份：先建仓库，再建 Token，最后填入插件并测试连接。
          </p>
        </div>
        <div data-lang="en" hidden>
          <h1>GitHub Token Config Guide (Backup)</h1>
          <p class="subtitle">
            Cloud 2 uses a private GitHub repo: Create repo first, then Token, fill in config and test connection.
          </p>
        </div>
      </div>
      <div class="lang-toggle" aria-label="Language and Theme">
        <button class="theme-btn" id="themeBtn" type="button" aria-label="Toggle theme">
          <svg class="theme-icon" id="iconMoon" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" hidden>
            <path
              d="M9.598 1.591a.75.75 0 0 1 .785-.175 7 7 0 1 1-8.967 8.967.75.75 0 0 1 .961-.96 5.5 5.5 0 0 0 7.046-7.046.75.75 0 0 1 .175-.786Zm1.616 1.945a7 7 0 0 1-7.678 7.678 5.5 5.5 0 1 0 7.678-7.678Z" />
          </svg>
          <svg class="theme-icon" id="iconSun" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" hidden>
            <path
              d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.415-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708" />
          </svg>
        </button>
        <button class="lang-btn" type="button" data-set-lang="zh">中文</button>
        <button class="lang-btn" type="button" data-set-lang="en">English</button>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- ZH -->
    <div class="lang-block" data-lang="zh">
      <div class="card">
        <div class="flow" aria-label="流程总览">
          <div class="flow-step">
            <div class="step-head">
              <div class="badge ok">1</div>
              <div>
                <p class="step-title">创建一个私有仓库（只做一次）</p>
                <p class="step-desc">Fine-grained Token 必须绑定“已存在的仓库”。建议 Private。</p>
              </div>
            </div>
            <div class="actions">
              <a class="btn-link" href="https://github.com/new" target="_blank" rel="noreferrer">打开 github.com/new</a>
            </div>
          </div>

          <div class="flow-step">
            <div class="step-head">
              <div class="badge ok">2</div>
              <div>
                <p class="step-title">创建 Fine‑grained PAT（最小权限）</p>
                <p class="step-desc">
                  • <strong>有效期：</strong>建议永久；<br>
                  • <strong>权限：</strong>Contents (Read and write), Metadata (Read-only)；<br>
                  • <strong>访问范围：</strong>“Only select repositories” (只勾选备份库)。
                </p>
              </div>
            </div>
            <div class="actions">
              <a class="btn-link" href="https://github.com/settings/tokens?type=beta" target="_blank"
                rel="noreferrer">打开 Token 页面</a>
            </div>
          </div>

          <div class="flow-step">
            <div class="step-head">
              <div class="badge ok">3</div>
              <div>
                <p class="step-title">复制 Token（只显示一次）</p>
                <p class="step-desc">
                  <span style="color: var(--warn);">请立即复制并妥善保存 Token。</span>页面刷新后不再显示，若遗忘需重新生成。
                </p>
              </div>
            </div>
          </div>

          <div class="flow-step">
            <div class="step-head">
              <div class="badge ok">4</div>
              <div>
                <p class="step-title">回到插件：填写配置 + 测试连接</p>
                <p class="step-desc">
                  常见报错“仓库不存在或无权限(404)”：Owner/Repo 填错或 Token 没勾选该仓库。
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>



      <h2>1) 创建一个用于备份的仓库（手动一次即可）</h2>
      <ol>
        <li>打开：<a href="https://github.com/new" target="_blank">https://github.com/new</a></li>
        <li>填写：<strong>Repository name</strong>（例如 <code>my-backup</code>），<strong>Visibility</strong> 选 Private（推荐）
        </li>
        <li>点击 <strong>Create repository</strong></li>
      </ol>

      <h2>2) 创建 Fine‑grained Token（绑定该仓库）</h2>
      <ol>
        <li>打开：<a href="https://github.com/settings/tokens?type=beta"
            target="_blank">https://github.com/settings/tokens?type=beta</a></li>
        <li>点击 <strong>Generate new token（fine‑grained）</strong></li>
        <li>填写 Token 名称，例如：<code>backup-access-token</code>；设置有效期（建议 永久）</li>
        <li><strong>Repository access</strong> → 选择 <strong>Only select repositories</strong> → 勾选你的备份仓库</li>
        <li><strong>Repository permissions</strong>：Contents → <strong>Read and write</strong>；Metadata →
          <strong>Read-only</strong>
        </li>
        <li>点击 <strong>Generate token</strong>，并复制 Token（只显示一次）（只显示一次）</li>
      </ol>

      <h2>3) 在插件中填写配置（字段顺序与界面一致）</h2>
      <p>在插件「云端2：GitHub仓库配置」中按以下顺序填写：</p>
      <ul>
        <li><strong>Owner</strong>：GitHub 用户名/组织名</li>
        <li><strong>Repo</strong>：仓库名（例如 <code>my-backup</code>）</li>
        <li><strong>Token（PAT）</strong>：粘贴刚生成的 Fine‑grained Token</li>
        <li><strong>Branch（可选）</strong>：留空=默认分支（推荐）</li>
        <li>
          <strong>Base Path（可选）</strong>：仓库内的“前缀目录”。留空=直接写入
          <code>书签备份/...</code>；例如填 <code>backups/chrome</code>，最终写入
          <code>backups/chrome/书签备份/...</code>
        </li>
      </ul>
      <p>然后点击“测试连接”，通过后点击“保存配置”。</p>

      <h2>问答 (Q&A)</h2>
      <details>
        <summary>FAQ：为什么不能只授权“未来要创建的仓库”？</summary>
        <p class="muted">
          Fine‑grained Token 必须绑定到“已存在的仓库”，GitHub 不允许绑定不存在的仓库。
        </p>
      </details>

      <details>
        <summary>FAQ：插件能访问我的其他仓库吗？</summary>
        <p class="muted">不能。你选择了 “Only select repositories” 后，Token 只能访问你指定的仓库。</p>
      </details>

      <details>
        <summary>FAQ：需要 Administration 权限吗？</summary>
        <p class="muted">不需要。插件不创建/删除仓库，也不会使用该权限。</p>
      </details>

      <h2>说明：我们需要什么 Token？（最小权限）</h2>
      <p>插件只需要读写你指定的某一个仓库，因此推荐创建 <strong>Fine‑grained PAT</strong> 并授予最小权限：</p>

      <h3>Repository access</h3>
      <ul>
        <li><strong>Only select repositories</strong></li>
        <li>只选择你用于备份的那个仓库</li>
      </ul>

      <h3>Repository permissions</h3>
      <table>
        <thead>
          <tr>
            <th>权限</th>
            <th>作用</th>
            <th>是否必须</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Contents: Read and write</strong></td>
            <td>上传/更新备份文件（含导出文件）</td>
            <td>✔ 必须</td>
          </tr>
          <tr>
            <td><strong>Metadata: Read-only</strong></td>
            <td>基础权限（获取仓库信息/默认分支等）</td>
            <td>✔ 必须</td>
          </tr>
          <tr>
            <td>Administration</td>
            <td>创建/删除仓库</td>
            <td>✘ 不需要</td>
          </tr>
        </tbody>
      </table>

      <div class="callout">
        <p><strong>重要：</strong>插件不会创建或删除仓库，因此不需要 <code>Administration</code> 权限。</p>
      </div>
    </div>

    <!-- EN -->
    <div class="lang-block" data-lang="en" hidden>
      <div class="card">
        <div class="flow" aria-label="Quick flow">
          <div class="flow-step">
            <div class="step-head">
              <div class="badge ok">1</div>
              <div>
                <p class="step-title">Create a private repo (one-time)</p>
                <p class="step-desc">Fine‑grained PAT must be scoped to an existing repository. Private is recommended.
                </p>
              </div>
            </div>
            <div class="actions">
              <a class="btn-link" href="https://github.com/new" target="_blank" rel="noreferrer">Open github.com/new</a>
            </div>
          </div>

          <div class="flow-step">
            <div class="step-head">
              <div class="badge ok">2</div>
              <div>
                <p class="step-title">Create a Fine‑grained PAT (minimal perms)</p>
                <p class="step-desc">
                  <strong>Expiration:</strong> No expiration (recommended);<br>
                  <strong>Permissions:</strong> Contents (RW), Metadata (RO);<br>
                  <strong>Access:</strong> “Only select repositories” (your backup repo).
                </p>
              </div>
            </div>
            <div class="actions">
              <a class="btn-link" href="https://github.com/settings/tokens?type=beta" target="_blank"
                rel="noreferrer">Open token page</a>
            </div>
          </div>

          <div class="flow-step">
            <div class="step-head">
              <div class="badge ok">3</div>
              <div>
                <p class="step-title">Copy Token (Shown once)</p>
                <p class="step-desc">
                  <span style="color: var(--warn);">Please copy and save the Token securely.</span> It will not be shown
                  again; if lost, you must regenerate it.
                </p>
              </div>
            </div>
          </div>

          <div class="flow-step">
            <div class="step-head">
              <div class="badge ok">4</div>
              <div>
                <p class="step-title">Back to extension: fill config + test</p>
                <p class="step-desc">“Repo not found or no permission (404)” usually means wrong owner/repo or token not
                  scoped to this repo.</p>
              </div>
            </div>
          </div>
        </div>
      </div>



      <h2>1) Create a backup repository (one-time)</h2>
      <ol>
        <li>Open: <a href="https://github.com/new" target="_blank">https://github.com/new</a></li>
        <li>Set <strong>Repository name</strong> (e.g. <code>my-backup</code>), choose <strong>Private</strong>
          (recommended)</li>
        <li>Click <strong>Create repository</strong></li>
      </ol>

      <h2>2) Create a Fine‑grained PAT (scoped to that repo)</h2>
      <ol>
        <li>Open: <a href="https://github.com/settings/tokens?type=beta"
            target="_blank">https://github.com/settings/tokens?type=beta</a></li>
        <li>Click <strong>Generate new token (fine‑grained)</strong></li>
        <li>Name it (e.g. <code>backup-access-token</code>) and set an expiration (suggested: no expiration / permanent)
        </li>
        <li><strong>Repository access</strong> → <strong>Only select repositories</strong> → select your backup repo
        </li>
        <li><strong>Repository permissions</strong>: Contents → <strong>Read and write</strong>; Metadata →
          <strong>Read-only</strong>
        </li>
        <li>Click <strong>Generate token</strong>, then copy it (shown only once) (Shows only once)</li>
      </ol>

      <h2>3) Fill the extension config (same order as the UI)</h2>
      <p>In “Cloud 2: GitHub Repo Config”, fill in:</p>
      <ul>
        <li><strong>Owner</strong>: your GitHub username or org</li>
        <li><strong>Repo</strong>: repository name (e.g. <code>my-backup</code>)</li>
        <li><strong>Token (PAT)</strong>: paste the Fine‑grained token</li>
        <li><strong>Branch (optional)</strong>: leave empty to use the default branch (recommended)</li>
        <li>
          <strong>Base Path (optional)</strong>: a prefix folder inside the repo. Empty = write to
          <code>Bookmark Backup/...</code>; e.g. <code>backups/chrome</code> → write to
          <code>backups/chrome/Bookmark Backup/...</code>
        </li>
      </ul>
      <p>Then click “Test Connection”, and “Save Config”.</p>

      <h2>Q&A</h2>
      <details>
        <summary>FAQ: Why can’t I scope to a repo that doesn’t exist yet?</summary>
        <p class="muted">Fine‑grained PAT must be scoped to an existing repository.</p>
      </details>

      <details>
        <summary>FAQ: Can the extension access my other repositories?</summary>
        <p class="muted">No. With “Only select repositories”, the token can only access the repo you selected.</p>
      </details>

      <details>
        <summary>FAQ: Do I need Administration permission?</summary>
        <p class="muted">No. The extension doesn’t create/delete repositories.</p>
      </details>

      <h2>Explanation: What token do you need? (minimal permissions)</h2>
      <p>The extension only needs to read/write a single repository you choose. Create a <strong>Fine‑grained
          PAT</strong> with minimal permissions:</p>

      <h3>Repository access</h3>
      <ul>
        <li><strong>Only select repositories</strong></li>
        <li>Select only the repository used for backups</li>
      </ul>

      <h3>Repository permissions</h3>
      <table>
        <thead>
          <tr>
            <th>Permission</th>
            <th>Why</th>
            <th>Required</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Contents: Read and write</strong></td>
            <td>Upload/update backup files (including exported files)</td>
            <td>✔ Yes</td>
          </tr>
          <tr>
            <td><strong>Metadata: Read-only</strong></td>
            <td>Basic access (repo info / default branch)</td>
            <td>✔ Yes</td>
          </tr>
          <tr>
            <td>Administration</td>
            <td>Create/delete repositories</td>
            <td>✘ No</td>
          </tr>
        </tbody>
      </table>

      <div class="callout">
        <p><strong>Note:</strong> The extension will not create or delete repositories, so <code>Administration</code>
          is not needed.</p>
      </div>
    </div>
  </div>

  <script src="github-token-guide.js"></script>
</body>

</html>
