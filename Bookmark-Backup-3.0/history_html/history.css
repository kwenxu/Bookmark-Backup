/* ==================== 主题变量 ==================== */
:root {
    /* Light Theme */
    --bg-primary: #ffffff;
    --bg-secondary: #f8f9fa;
    --bg-tertiary: #f0f2f5;
    --bg-elevated: #ffffff;

    --text-primary: #1c1e21;
    --text-secondary: #65676b;
    --text-tertiary: #8a8d91;

    --border-color: #e4e6eb;
    --border-hover: #ccd0d5;

    --accent-primary: #1877f2;
    --accent-hover: #166fe5;
    --accent-light: #e7f3ff;
    --link-color: #1877f2;

    --success: #42b72a;
    --success-light: #e7f5e4;
    --warning: #ff9800;
    --warning-light: #fff3e0;
    --error: #e74c3c;
    --error-light: #ffebee;
    --info: #17a2b8;
    --info-light: #e0f7fa;

    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.1);
    --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.15);

    /* Git 风格颜色 */
    --git-added: #22863a;
    --git-added-bg: #e6ffed;
    --git-deleted: #cb2431;
    --git-deleted-bg: #ffeef0;
    --git-modified: #f97316;
    --git-modified-bg: #fff7ed;
    --git-moved: #3b82f6;
    --git-moved-bg: #eff6ff;

    /* Layout constants */
    --sidebar-collapsed-width: 60px;
}

[data-theme="dark"] {
    --bg-primary: #18191a;
    --bg-secondary: #242526;
    --bg-tertiary: #3a3b3c;
    --bg-elevated: #242526;

    --text-primary: #e4e6eb;
    --text-secondary: #b0b3b8;
    --text-tertiary: #8a8d91;

    --border-color: #3a3b3c;
    --border-hover: #4e4f50;

    --accent-primary: #2d88ff;
    --accent-hover: #4d9eff;
    --accent-light: #1a3a5f;
    --link-color: #4d9eff;

    --success: #42b72a;
    --success-light: #1b3a1b;
    --warning: #ff9800;
    --warning-light: #3d2b1f;
    --error: #e74c3c;
    --error-light: #3d1f1f;
    --info: #17a2b8;
    --info-light: #1a3540;

    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
    --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.4);
    --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.5);

    --git-added: #3fb950;
    --git-added-bg: #1b3a1b;
    --git-deleted: #f85149;
    --git-deleted-bg: #3d1f1f;
    --git-modified: #fb923c;
    --git-modified-bg: #431407;
    --git-moved: #60a5fa;
    --git-moved-bg: #172554;
}

@keyframes pulse-green {
    0% {
        box-shadow: 0 0 0 0 rgba(66, 183, 42, 0.7);
    }

    70% {
        box-shadow: 0 0 0 10px rgba(66, 183, 42, 0);
    }

    100% {
        box-shadow: 0 0 0 0 rgba(66, 183, 42, 0);
    }
}

@keyframes pulse-blue {
    0% {
        box-shadow: 0 0 0 0 rgba(24, 119, 242, 0.7);
    }

    70% {
        box-shadow: 0 0 0 10px rgba(24, 119, 242, 0);
    }

    100% {
        box-shadow: 0 0 0 0 rgba(24, 119, 242, 0);
    }
}

@keyframes bounce-in {
    0% {
        transform: scale(0);
        opacity: 0;
    }

    60% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* ==================== 基础样式 ==================== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    height: 100%;
    scrollbar-gutter: auto;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.6;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* ==================== 头部导航 ==================== */
.history-header {
    background: var(--bg-elevated);
    border-bottom: 1px solid var(--border-color);
    /* Keep a consistent rhythm: header height == collapsed sidebar width */
    height: 60px;
    min-height: 60px;
    flex-shrink: 0;
    padding: 0 24px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: var(--shadow-sm);
    position: sticky;
    top: 0;
    z-index: 100;
}

.header-left {
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-height: 0;
    overflow: hidden;
    /* Ensure content clips */
}

.header-left h1 {
    font-size: 20px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
    line-height: 1.2;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.header-subtitle {
    font-size: 12px;
    color: var(--text-secondary);
    margin-top: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.header-right {
    display: flex;
    gap: 16px;
    align-items: center;
}

/* Search Container - Flex Layout */
.search-container {
    position: relative;
    display: flex;
    align-items: center;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 20px;
    /* [User Request] Fixed width, no animation */
    /* width: 280px; -> changed to expanded width 320px -> Standardized to Canvas width 420px */
    width: 420px;
    padding: 2px;
    /* transition: all 0.3s ease; -> Removed width transition */
    transition: border-color 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
}

.search-container:focus-within {
    border-color: var(--accent-primary);
    background: var(--bg-primary);
    /* width: 320px; -> Removed expansion */
    box-shadow: 0 0 0 2px var(--accent-light);
}

/* [User Request] Global Scrollbar Styling - Refined "Floating" Style */
::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 5px;
}

::-webkit-scrollbar-thumb {
    /* "Floating" effect: solid color with transparent border to simulate margin */
    background-color: rgba(140, 140, 140, 0.35);
    /* Neutral grey */
    border: 3px solid transparent;
    background-clip: content-box;
    border-radius: 99px;
    /* Pill shape */
}

::-webkit-scrollbar-thumb:hover {
    background-color: rgba(140, 140, 140, 0.55);
}

::-webkit-scrollbar-corner {
    background: transparent;
}

/* Input Area */
.search-input-wrapper {
    flex: 1;
    display: flex;
    align-items: center;
    position: relative;
}

.search-container input {
    width: 100%;
    padding: 6px 12px 6px 4px;
    border: none;
    background: transparent;
    color: var(--text-primary);
    font-size: 14px;
    outline: none;
    height: 32px;
}

.search-container input:focus {
    /* Reset original focus styles since container handles it */
    outline: none;
    background: transparent;
    border: none;
    width: 100%;
}

/* Search Mode Trigger Button (Left - Expanded) */
.search-mode-trigger {
    display: flex;
    align-items: center;
    justify-content: center;
    /* width: auto; let it grow */
    gap: 6px;
    /* Match input height so text is vertically centered */
    height: 32px;
    margin-left: 4px;
    padding: 0 8px;
    /* Add padding for text */
    border: none;
    background: transparent;
    border-radius: 16px;
    /* Pill shape */
    cursor: pointer;
    color: var(--text-secondary);
    transition: all 0.2s ease;
    font-size: 13px;
    font-weight: 500;
    white-space: nowrap;
}

.search-mode-trigger:hover,
.search-mode-trigger.active {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.search-mode-trigger i {
    font-size: 14px;
    /* Space between icon and text handled by gap */
    line-height: 1;
}

/* Text span inside trigger */
.search-mode-label {
    display: inline-flex;
    align-items: center;
    line-height: 1;
}

/* [User Request] Hint at top of menu */
.search-mode-hint {
    padding: 6px 12px;
    font-size: 11px;
    color: var(--text-tertiary);
    border-bottom: 1px solid var(--border-color);
    margin-bottom: 4px;
    text-align: left;
    background: var(--bg-tertiary);
    border-radius: 4px 4px 0 0;
}

/* Menu width increased */
.search-mode-menu {
    position: absolute;
    top: calc(100% + 8px);
    left: 0;
    width: 420px;
    /* Widened from 220px/380px to match container 420px */
    background: var(--bg-elevated);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    box-shadow: var(--shadow-lg);
    z-index: 210;
    padding: 4px;
    animation: bounce-in 0.2s ease-out;
    transform-origin: top left;
}

.search-mode-menu[hidden] {
    display: none;
}

.search-mode-menu-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
    color: var(--text-primary);
    transition: background 0.15s ease;
}

.search-mode-menu-item:hover {
    background: var(--bg-tertiary);
}

.search-mode-menu-item.active {
    font-weight: 500;
}

/* Mode-Specific Active States */
.search-mode-menu-item[data-mode-key="current-changes"].active {
    background: rgba(24, 119, 242, 0.1);
}

.search-mode-menu-item[data-mode-key="current-changes"].active .mode-name,
.search-mode-menu-item[data-mode-key="current-changes"].active .mode-icon {
    color: #1877f2;
}

.search-mode-menu-item[data-mode-key="history"].active {
    background: rgba(249, 115, 22, 0.1);
    /* Orange */
}

.search-mode-menu-item[data-mode-key="history"].active .mode-name,
.search-mode-menu-item[data-mode-key="history"].active .mode-icon {
    color: #f97316;
}

/* Dark Theme Adjustments for Active Modes */
[data-theme="dark"] .search-mode-menu-item[data-mode-key="current-changes"].active {
    background: rgba(24, 119, 242, 0.2);
}

[data-theme="dark"] .search-mode-menu-item[data-mode-key="current-changes"].active .mode-name,
[data-theme="dark"] .search-mode-menu-item[data-mode-key="current-changes"].active .mode-icon {
    color: #4a9eff;
}

[data-theme="dark"] .search-mode-menu-item[data-mode-key="history"].active {
    background: rgba(249, 115, 22, 0.2);
}

[data-theme="dark"] .search-mode-menu-item[data-mode-key="history"].active .mode-name,
[data-theme="dark"] .search-mode-menu-item[data-mode-key="history"].active .mode-icon {
    color: #fb923c;
}

.mode-icon {
    width: 20px;
    text-align: center;
    font-size: 14px;
}

.mode-info {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.mode-name {
    line-height: 1.2;
}

.mode-desc {
    font-size: 11px;
    color: var(--text-tertiary);
    margin-top: 2px;
}

.search-mode-guide {
    margin: 8px 4px 4px;
    padding: 10px 12px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background: var(--bg-secondary);
}

.search-mode-guide-title {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
}

.search-mode-guide-summary {
    font-size: 11px;
    line-height: 1.5;
    color: var(--text-secondary);
    margin-bottom: 6px;
}

.search-mode-guide-list {
    margin: 0;
    padding-left: 16px;
    color: var(--text-secondary);
    font-size: 11px;
    line-height: 1.45;
}

.search-mode-guide-list li {
    margin-bottom: 4px;
}

.search-mode-guide-examples {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 6px;
    margin-top: 8px;
}

.search-mode-guide-label {
    font-size: 11px;
    color: var(--text-tertiary);
}

.search-mode-guide-pill {
    padding: 2px 6px;
    border-radius: 999px;
    border: 1px solid var(--border-color);
    background: var(--bg-tertiary);
    color: var(--text-primary);
    font-size: 11px;
    line-height: 1.2;
    white-space: nowrap;
}

/* Remove legacy chip styles */
.search-mode-chip {
    display: none !important;
}

/* Hide shortcuts in menu if user prefers simple UI */
.mode-shortcut {
    display: none;
}

/* Mode Colors - Applied to icon/text in trigger */
.mode-color-blue {
    color: #1877f2;
}

.mode-color-green {
    color: #42b72a;
}

.mode-color-orange {
    color: #f97316;
}

/* 搜索结果样式已移动到 search/search.css */

.tool-buttons {
    display: flex;
    gap: 8px;
}

.tool-btn {
    width: 36px;
    height: 36px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background: var(--bg-secondary);
    color: var(--text-primary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    position: relative;
}

.tool-btn:hover {
    background: var(--bg-tertiary);
    border-color: var(--border-hover);
}

.tool-btn:hover .btn-tooltip {
    visibility: visible;
    opacity: 1;
}

.tool-btn .lang-text {
    font-size: 12px;
    font-weight: 600;
}

.btn-tooltip {
    position: absolute;
    top: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    white-space: nowrap;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.05s ease, visibility 0.05s ease;
    pointer-events: auto;
    z-index: 1000;
    box-shadow: var(--shadow-md);
}

.btn-tooltip::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 5px solid transparent;
    border-bottom-color: rgba(0, 0, 0, 0.9);
}

#helpToggle .btn-tooltip {
    left: auto;
    right: 0;
    transform: none;
}

#helpToggle .btn-tooltip::before {
    left: auto;
    right: 10px;
    transform: none;
}

/* 快捷键 & 开源信息弹窗 */
.shortcuts-modal {
    display: inline-block;
    width: auto;
    max-width: none;
    margin: 24px auto;
    background: var(--bg-elevated, #ffffff);
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    padding: 10px 10px 8px;
    color: var(--text-primary, #111827);
}

.shortcuts-modal h2 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--accent-color, #007AFF);
}

.shortcuts-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    margin-bottom: 8px;
    padding-left: 12px;
    /* Align title with card text content */
}

.shortcuts-header .modal-close {
    margin-top: 4px;
    /* 略向下对齐标题基线 */
}

.shortcuts-section {
    font-size: 13px;
    line-height: 1.6;
    color: var(--text-secondary);
    margin: 0;
}

.shortcuts-card {
    background: var(--bg-secondary);
    border-radius: 8px;
    padding: 10px 12px;
}

.open-source-section {
    margin: 0 0 6px 0;
}

.shortcuts-divider {
    margin: 4px 0 6px 0;
    border: 0;
    border-top: 1px solid var(--border-subtle, rgba(148, 163, 184, 0.6));
}

.shortcuts-header-row {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 6px;
    /* 文字与按钮之间稍微拉开一点，更明显 */
    margin-bottom: 4px;
}

.shortcuts-settings-btn {
    border: none;
    background: transparent;
    padding: 0;
    cursor: pointer;
    color: var(--accent-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-left: 0;
    /* 几乎紧贴文字 */
}

.shortcuts-settings-btn:hover {
    color: var(--accent-hover);
}

.shortcuts-settings-btn i {
    font-size: 12px;
}

.shortcuts-section table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 4px;
}

.shortcuts-section th,
.shortcuts-section td {
    padding: 4px 6px;
    font-size: 12px;
    text-align: left;
}

.shortcuts-section th {
    color: var(--text-secondary, #9ca3af);
    font-weight: 500;
}

/* 新的快捷键行布局（使用 flex 而不是表格单元格类） */
.shortcuts-columns-header {
    display: flex;
    align-items: center;
    gap: 16px;
    font-size: 11px;
    color: var(--text-secondary, #9ca3af);
    margin-bottom: 2px;
}

.shortcuts-key-header {
    min-width: 60px;
    text-align: center;
}

.shortcuts-action-header {
    flex: 1;
    text-align: center;
}

.shortcuts-list {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.shortcuts-row {
    display: flex;
    align-items: flex-start;
    gap: 16px;
    /* 按键列与功能列的水平间距 */
    justify-content: center;
}

.shortcuts-key {
    min-width: 60px;
    text-align: center;
}

.shortcuts-key kbd {
    display: inline-block;
    min-width: 60px;
    text-align: center;
}

.shortcuts-action {
    flex: 1;
    text-align: center;
}

.shortcuts-section kbd {
    padding: 2px 6px;
    border-radius: 4px;
    border: 1px solid var(--border-color);
    background: var(--bg-tertiary);
    font-size: 11px;
}

.shortcuts-footer {
    margin-top: 14px;
    text-align: right;
}

.shortcuts-footer .view-action-btn {
    font-size: 12px;
}

/* ==================== 主容器 ==================== */
.main-container {
    display: flex;
    flex: 1 1 auto;
    /* 允许子级滚动容器正确收缩，避免撑开导致 body 出现滚动条 */
    min-height: 0;
}

/* ==================== 内容区域 ==================== */
.content-area {
    flex: 1;
    padding: 24px;
    overflow-y: auto;
    scrollbar-gutter: auto;
    /* 让内容区域成为稳定的滚动容器（避免撑开父级） */
    min-height: 0;
}

.content-area.canvas-full-bleed {
    padding: 0;
    overflow: hidden;
    background: transparent;
    scrollbar-gutter: auto;
}

.view {
    display: none;
}

.view.active {
    display: block;
}

/* 视图头部布局 */
.view-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    /* 改为 center，让按钮和标题水平对齐 */
    margin-bottom: 20px;
}

.view-header-left {
    flex: 1;
}

.view-header-right {
    display: flex;
    align-items: center;
    gap: 10px;
}

/* 视图操作按钮（复制所有记录按钮） */
.view-action-btn {
    padding: 8px 16px;
    background: var(--accent-primary);
    color: #ffffff;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.view-action-btn:hover {
    background: var(--accent-hover);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

.view-action-btn:active {
    transform: translateY(0);
}

.view-action-btn i {
    font-size: 13px;
}

/* 切换按钮 */
.view-toggle-btn {
    display: flex;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    overflow: hidden;
    padding: 0;
}

.toggle-option {
    padding: 8px 16px;
    cursor: pointer;
    font-size: 13px;
    color: var(--text-secondary);
    transition: all 0.2s;
    border: none;
    background: transparent;
    display: flex;
    align-items: center;
    gap: 6px;
}

.toggle-option:hover {
    background: rgba(33, 150, 243, 0.1);
    color: var(--text-primary);
}

.toggle-option.active {
    background: #2196F3;
    color: white;
}

/* ==================== 侧边栏 ==================== */
.sidebar {
    width: 260px;
    background: var(--bg-secondary);
    border-right: 1px solid var(--border-color);
    padding: 16px;
    overflow-y: auto;
    overflow-x: hidden;
    /* 避免在 macOS overlay scrollbar 下预留“空白条”，导致右侧看起来不贴边 */
    scrollbar-gutter: auto;
    /* 关键：让 overflow-y 在 flex 布局下生效 */
    min-height: 0;
    position: relative;
    transition: width 0.3s ease, padding 0.3s ease;
    /* Hide native scrollbar to avoid right-side inset mismatch (scroll still works via wheel/trackpad). */
    scrollbar-width: none;
}

.sidebar::-webkit-scrollbar {
    width: 0;
    height: 0;
}

/* 侧边栏收起状态 */
.sidebar.collapsed {
    width: var(--sidebar-collapsed-width);
    padding: 16px 4px;
}

/* 收起状态：nav-tabs 的负 margin/内 padding 需要匹配新的 sidebar padding，避免左右留白不一致 */
.sidebar.collapsed .nav-tabs {
    margin-left: -4px;
    margin-right: -4px;
    padding-left: 4px;
    padding-right: 4px;
}

/* 收起后隐藏文字 */
.sidebar.collapsed .nav-tab span,
.sidebar.collapsed .nav-group-title {
    display: none;
}

/* 收起后隐藏分组边框 */
.sidebar.collapsed .nav-group {
    border-bottom: none;
    margin-bottom: 8px;
    padding-bottom: 8px;
}

/* 收起后调整按钮样式 */
.sidebar.collapsed .nav-tab {
    justify-content: center;
    padding: 12px 0;
}

.sidebar.collapsed .nav-tab i {
    margin: 0;
}

/* 侧边栏切换按钮 - 圆形设计，水平居中靠近底部 */
.sidebar-toggle {
    position: absolute;
    left: 50%;
    bottom: 20px;
    transform: translateX(-50%);
    width: 32px;
    height: 32px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: all 0.2s ease;
    color: var(--text-secondary);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.sidebar-toggle:hover {
    background: var(--hover-bg);
    color: var(--primary-color);
    transform: translateX(-50%) scale(1.1);
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.15);
}

.sidebar-toggle i {
    font-size: 14px;
    transition: transform 0.3s ease;
    /* FontAwesome chevron glyph 在圆形按钮里视觉上略偏左，轻微右移以居中 */
    transform: translateX(0.5px);
}

/* 收起状态时旋转图标 */
.sidebar.collapsed .sidebar-toggle i {
    /* translateX 在 rotate 前执行，旋转后会自然变成反方向的微调 */
    transform: rotate(180deg) translateX(0.5px);
}

.nav-tabs {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin-bottom: 24px;
    margin-left: -16px;
    margin-right: -16px;
    padding-left: 16px;
    padding-right: 16px;
}

.nav-tab {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 12px;
    border: none;
    border-radius: 8px;
    background: transparent;
    color: var(--text-secondary);
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: left;
    width: 100%;
    box-sizing: border-box;
}

.nav-tab i {
    font-size: 16px;
    width: 20px;
    text-align: center;
}

.nav-tab:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.nav-tab.active {
    background: var(--accent-light);
    color: var(--accent-primary);
    font-weight: 600;
}

/* 导航分组样式 */
.nav-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
    /* Add spacing between items */
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border-color);
}

.nav-group:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.nav-group-title {
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 8px;
    margin-left: -16px;
    margin-right: -16px;
    padding-left: 28px;
    padding-right: 28px;
    padding-top: 0;
    padding-bottom: 0;
    letter-spacing: 0.5px;
}

/* ==================== 备份历史列表（Git 风格）==================== */
.history-commits {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.commit-item {
    background: var(--bg-elevated);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 16px;
    transition: all 0.2s ease;
    cursor: pointer;
    position: relative;
}

.commit-item:hover {
    border-color: var(--accent-primary);
    box-shadow: var(--shadow-md);
}

.commit-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
    gap: 12px;
}

.commit-title-group {
    display: inline-flex;
    flex-direction: row;
    align-items: center;
    gap: 6px;
}

.commit-seq-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 22px;
    height: 22px;
    padding: 0 6px;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 700;
    line-height: 1;
    color: var(--text-secondary);
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
}

.commit-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    display: inline;
    word-break: break-word;
    max-width: 500px;
}

.commit-time {
    font-size: 12px;
    color: var(--text-tertiary);
    display: flex;
    align-items: center;
    gap: 4px;
}

.commit-time i {
    font-size: 12px;
}

/* 历史记录操作按钮组 */
.commit-actions {
    display: flex;
    gap: 6px;
    opacity: 1;
    transition: all 0.2s ease;
    flex-shrink: 0;
}

/* Reserve a slot for the "restore" button on other branches */
.commit-action-placeholder {
    display: inline-block;
    width: 28px;
    height: 28px;
    flex: 0 0 28px;
    pointer-events: none;
}

/* 单个操作按钮 */
.action-btn {
    padding: 6px 10px;
    background: var(--bg-secondary);
    color: var(--text-secondary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    height: 32px;
    white-space: nowrap;
    position: relative;
    overflow: visible;
}

.action-btn.restore-btn {
    background: transparent;
    color: var(--text-secondary);
    border: 1px solid var(--border-color);
    padding: 0;
    gap: 0;
    height: 28px;
    width: 28px;
    min-width: 28px;
    border-radius: 6px;
}

.action-btn.restore-btn i {
    font-size: 13px;
}

.action-btn.restore-btn::after {
    display: none !important;
    content: none !important;
}

.action-btn.detail-search-open-btn::after {
    display: none !important;
    content: none !important;
}

.restore-title {
    color: var(--accent-primary) !important;
}

.commit-seq-badge.restore-seq {
    color: var(--accent-primary);
    border-color: var(--accent-primary);
    background: var(--accent-light);
}

#restoreVersionInfo .commit-item {
    margin: 0;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    cursor: default;
    box-shadow: none;
    pointer-events: none;
}

#restoreVersionInfo .commit-item:hover {
    border-color: var(--border-color);
    box-shadow: none;
    transform: none;
}

.action-btn .btn-tooltip {
    position: absolute;
    top: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    white-space: nowrap;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.05s ease, visibility 0.05s ease;
    pointer-events: none;
    z-index: 1000;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    font-weight: normal;
    text-transform: none;
}

.action-btn .btn-tooltip::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 5px solid transparent;
    border-bottom-color: rgba(0, 0, 0, 0.9);
}

/* ========================================
   Restore Modal - 恢复弹窗样式
   ======================================== */
#restoreModal .modal-header.compact {
    padding: 8px 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid var(--border-color);
}

#restoreModal .modal-header.compact h3 {
    margin: 0;
    margin-left: 4px;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 28px;
}

#restoreModal .modal-header.compact .modal-close {
    width: 28px;
    height: 28px;
    border-radius: 6px;
    flex-shrink: 0;
}

/* 模态框主体 - 减少垂直间距 */
#restoreModal .modal-content,
#revertModal .modal-content {
    border-radius: 12px;
    overflow: hidden;
}

#restoreModal #restoreMainView,
#revertModal #revertMainView {
    padding: 12px 20px 14px;
}

/* 版本信息区域 - 更紧凑 */
#restoreModal #restoreVersionInfo {
    margin-bottom: 12px !important;
}

#restoreModal #restoreVersionInfo .commit-item {
    padding: 10px 12px !important;
    margin: 0 !important;
}

#restoreModal .restore-title {
    color: var(--text-primary) !important;
}

#restoreModal .commit-seq-badge.restore-seq {
    color: var(--text-secondary);
    border-color: var(--border-color);
    background: var(--bg-secondary);
}

/* 对比统计区域 - 更紧凑 */
#restoreModal #restoreComparison,
#revertModal #revertComparison {
    margin-bottom: 14px !important;
}

#restoreModal #restoreComparison>div:first-child,
#revertModal #revertComparison>div:first-child {
    gap: 10px !important;
}

#restoreModal #restoreComparison>div:first-child>div,
#revertModal #revertComparison>div:first-child>div {
    padding: 10px 8px !important;
}

/* 差异摘要行 - 更紧凑 */
#restoreModal #restoreComparison>div:last-child {
    margin-top: 8px !important;
    padding: 6px 10px !important;
}

#restoreModal .restore-diff-bar,
#revertModal .restore-diff-bar {
    margin-top: 8px;
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 6px 10px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
}

#restoreModal .restore-preview-btn,
#restoreModal .restore-ambiguity-btn,
#revertModal .restore-preview-btn {
    height: 24px;
    padding: 0 10px;
    font-size: 11px;
    border: 1px solid var(--border-color);
    background: var(--bg-primary);
    color: var(--text-secondary);
    border-radius: 6px;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s ease;

    display: inline-flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
}

#restoreModal .restore-preview-btn:hover:not(:disabled),
#restoreModal .restore-ambiguity-btn:hover:not(:disabled),
#revertModal .restore-preview-btn:hover:not(:disabled) {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

#restoreModal .restore-ambiguity-hint {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 2px 8px;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 600;
    line-height: 1.2;
    white-space: nowrap;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-secondary);
}

#restoreModal .restore-ambiguity-hint.ok {
    border-color: rgba(66, 183, 42, 0.35);
    background: var(--success-light);
    color: var(--success);
}

#restoreModal .restore-ambiguity-hint.warn {
    border-color: var(--warning);
    background: var(--warning-light);
    color: var(--warning);
}

#restoreModal .restore-ambiguity-hint-block {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 8px;
    margin: 6px 0 10px;
}

#restoreModal .restore-import-target-hint {
    margin: 6px 0 10px;
    font-size: 12px;
    color: var(--text-secondary);
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 6px 8px;
}

#importTargetModal .import-target-list {
    max-height: 320px;
    overflow-y: auto;
    margin: 6px 0 12px;
    border: 1px solid var(--border-color);
    border-radius: 10px;
    background: var(--bg-primary);
    padding: 6px;
}

#importTargetModal .import-target-tree-node {
    display: block;
}

#importTargetModal .import-target-tree-row {
    border: 1px solid transparent;
    background: var(--bg-secondary);
    color: var(--text-primary);
    border-radius: 8px;
    min-height: 32px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s ease;
    margin: 2px 0;
    padding-right: 8px;
}

#importTargetModal .import-target-tree-row:hover {
    background: var(--bg-tertiary);
}

#importTargetModal .import-target-tree-row.selected {
    border-color: var(--accent-primary);
    background: rgba(13, 110, 253, 0.08);
}

#importTargetModal .import-target-tree-toggle {
    width: 20px;
    height: 20px;
    border: none;
    border-radius: 4px;
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex: 0 0 20px;
}

#importTargetModal .import-target-tree-toggle:hover {
    background: var(--bg-primary);
    color: var(--text-primary);
}

#importTargetModal .import-target-tree-icon {
    color: var(--warning);
    width: 16px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex: 0 0 16px;
}

#importTargetModal .import-target-tree-title {
    flex: 1;
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: 13px;
}

#importTargetModal .import-target-tree-meta {
    font-size: 11px;
    color: var(--text-tertiary);
    white-space: nowrap;
}

#importTargetModal .import-target-tree-selected-mark {
    width: 14px;
    color: var(--accent-primary);
    text-align: center;
    flex: 0 0 14px;
}

#importTargetModal .import-target-tree-children {
    margin-left: 0;
}

#importTargetModal .import-target-tree-loading,
#importTargetModal .import-target-tree-empty {
    font-size: 12px;
    color: var(--text-tertiary);
    padding: 6px 10px;
}

#importTargetModal .import-target-tree-empty.error {
    color: var(--warning);
}

#importTargetModal .import-target-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
}

#importTargetModal .import-target-actions .restore-modal-action-btn {
    min-width: 92px;
    height: 32px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-primary);
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
    padding: 0 12px;
    transition: all 0.2s ease;
}

#importTargetModal .import-target-actions .restore-modal-action-btn.secondary {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);
}

#importTargetModal .import-target-actions .restore-modal-action-btn.secondary:hover:not(:disabled) {
    background: var(--bg-tertiary);
}

#importTargetModal .import-target-actions .restore-modal-action-btn.primary {
    background: var(--accent-primary);
    color: #ffffff;
    border-color: var(--accent-primary);
}

#importTargetModal .import-target-actions .restore-modal-action-btn.primary:hover:not(:disabled) {
    filter: brightness(0.95);
}

#importTargetModal .import-target-actions .restore-modal-action-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

#restoreModal .restore-preview-btn:hover:not(:disabled),
#revertModal .restore-preview-btn:hover:not(:disabled) {
    background: var(--warning-light);
    color: var(--warning);
    border-color: var(--warning);
}

/* 预览按钮：与补丁二次确认一致的状态色 */
#restoreModal .restore-preview-btn.preview-warning,
#revertModal .restore-preview-btn.preview-warning {
    border-color: var(--warning);
    color: var(--warning);
    background: var(--warning-light);
}

/* 默认预览按钮：黄色提示（预演阶段入口） */
#restoreModal .restore-preview-btn,
#revertModal .restore-preview-btn {
    border-color: var(--warning);
    color: var(--warning);
    background: var(--warning-light);
}

#restoreModal .restore-preview-btn.preview-warning:hover:not(:disabled),
#revertModal .restore-preview-btn.preview-warning:hover:not(:disabled) {
    border-color: var(--warning);
    color: var(--warning);
    background: var(--warning-light);
}

#restoreModal .restore-preview-btn.preview-warning:focus-visible,
#revertModal .restore-preview-btn.preview-warning:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.28);
}

#restoreModal .restore-preview-btn.preview-danger {
    border-color: var(--error);
    color: #ffffff;
    background: var(--error);
}

#restoreModal .restore-preview-btn.preview-danger:hover:not(:disabled) {
    border-color: var(--error);
    color: #ffffff;
    background: var(--error);
}

#restoreModal .restore-preview-btn.preview-danger:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.28);
}

#restoreModal .restore-ambiguity-btn {
    border-color: var(--warning);
    color: var(--warning);
}

#restoreModal .restore-ambiguity-btn:hover:not(:disabled) {
    background: var(--warning-light);
}

#restoreModal .restore-ambiguity-panel {
    display: none;
    margin-top: 8px;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    border-radius: 8px;
    overflow: hidden;
}

#restoreModal .restore-ambiguity-panel.show {
    display: block;
}

#restoreModal .restore-ambiguity-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    padding: 8px 10px;
    background: var(--bg-tertiary);
    border-bottom: 1px solid var(--border-color);
}

#restoreModal .restore-ambiguity-title {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-primary);
}

#restoreModal .restore-ambiguity-close-btn {
    height: 24px;
    padding: 0 10px;
    font-size: 11px;
    border: 1px solid var(--border-color);
    background: var(--bg-primary);
    color: var(--text-secondary);
    border-radius: 6px;
    cursor: pointer;
    white-space: nowrap;
}

#restoreModal .restore-ambiguity-close-btn:hover {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

#restoreModal .restore-ambiguity-list {
    max-height: 180px;
    overflow: auto;
    padding: 8px 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

#restoreModal .restore-ambiguity-item {
    padding: 8px 10px;
    border: 1px solid var(--border-color);
    background: var(--bg-primary);
    border-radius: 8px;
}

#restoreModal .restore-ambiguity-item-title {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
}

#restoreModal .restore-ambiguity-item-sub {
    font-size: 11px;
    color: var(--text-tertiary);
    word-break: break-word;
}

#restoreModal .restore-ambiguity-candidates {
    margin-top: 6px;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

#restoreModal .restore-ambiguity-candidate {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    padding: 6px 8px;
    border: 1px dashed var(--border-color);
    border-radius: 8px;
    font-size: 11px;
    color: var(--text-secondary);
    cursor: pointer;
}

#restoreModal .restore-ambiguity-candidate:hover {
    background: var(--bg-secondary);
}

#restoreModal .restore-ambiguity-candidate code {
    font-family: SF Mono, Monaco, Consolas, monospace;
    font-size: 11px;
    color: var(--text-tertiary);
}

#restoreModal .restore-ambiguity-radio {
    width: 14px;
    height: 14px;
    accent-color: var(--accent-primary);
}

#restoreModal .restore-target-label {
    margin-bottom: 10px;
    font-size: 12px;
    color: var(--text-secondary);
    text-align: left;
}

/* 警告/说明（放在操作区分割线下方） */
#restoreModal .restore-warning,
#revertModal .restore-warning {
    margin: 0;
    padding: 10px;
    border-radius: 8px;
    background: var(--warning-light);
    border: 1px solid var(--warning);
}

#restoreModal .restore-warning i,
#revertModal .restore-warning i {
    color: var(--warning);
}

/* 进度区域 - 更紧凑 */
#restoreModal #restoreProgressSection,
#revertModal #revertProgressSection {
    margin-bottom: 12px !important;
}

/* 底部操作区 - 更聚焦 */
#restoreModal .modal-footer,
#revertModal .modal-footer {
    border-top: 1px solid var(--border-color);
    padding-top: 12px !important;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
}

#restoreModal .restore-footer-actions,
#revertModal .restore-footer-actions {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
}

#revertModal .restore-footer-actions {
    justify-content: flex-end;
    width: 100%;
    min-height: 36px;
}


#revertModal .revert-strategy-stack {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    align-self: flex-end;
    gap: 8px;
    flex-wrap: wrap;
    margin-left: auto;
    text-align: right;
}

#revertModal .revert-strategy-stack .restore-strategy-group {
    margin: 0;
}

#revertModal #revertModeGroup {
    min-width: 170px;
}

#revertModal #revertStrategyGroup {
    min-width: 170px;
}

#revertModal #revertStrategyGroup.disabled {
    opacity: 0.55;
}


#revertModal .revert-threshold-label {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--text-secondary);
}

#revertModal .revert-threshold-inline {
    margin-left: 8px;
    white-space: nowrap;
}

#revertModal .restore-warning .revert-threshold-inline input {
    width: 52px;
    height: 22px;
    font-size: 11px;
}

#revertModal .revert-threshold-label input {
    width: 56px;
    height: 24px;
    border-radius: 6px;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-primary);
    text-align: center;
    padding: 0 4px;
}

#revertModal .revert-threshold-label input:disabled {
    opacity: 0.7;
}

#revertModal .revert-threshold-unit {
    font-size: 11px;
    color: var(--text-tertiary);
}

/* Strategy pills（与主 UI 的 Restore Modal 一致） */
#restoreModal #restoreStrategySegment {
    display: inline-flex;
    align-items: center;
}

#restoreModal .restore-strategy-group,
#revertModal .restore-strategy-group {
    height: 34px;
    padding: 2px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
    background-color: var(--bg-tertiary);
    display: inline-flex;
    gap: 2px;
    box-sizing: border-box;
}

#restoreModal .restore-strategy-group.disabled,
#revertModal .restore-strategy-group.disabled {
    opacity: 0.6;
    pointer-events: none;
}

#restoreModal .restore-strategy-label,
#revertModal .restore-strategy-label {
    cursor: pointer;
    user-select: none;
    margin: 0;
    height: 100%;
    display: flex;
}

#restoreModal .restore-strategy-label input,
#revertModal .restore-strategy-label input {
    display: none;
}

#restoreModal .restore-strategy-option,
#revertModal .restore-strategy-option {
    height: 100%;
    padding: 0 9px;
    border-radius: 7px;
    font-size: 13px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    color: var(--text-secondary);
    transition: all 0.2s ease;
    white-space: nowrap;
}

#restoreModal .restore-strategy-option:hover,
#revertModal .restore-strategy-option:hover {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
}

#restoreModal .restore-strategy-icon,
#revertModal .restore-strategy-icon {
    display: none;
    /* only render when checked to avoid leading blank */
    font-size: 12px;
    margin-left: -3px;
    opacity: 0.95;
}

#restoreModal .restore-strategy-label input:checked+.restore-strategy-option,
#revertModal .restore-strategy-label input:checked+.restore-strategy-option {
    background-color: var(--accent-primary);
    color: #ffffff;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
    font-weight: 500;
}

#restoreModal .restore-strategy-label input:checked+.restore-strategy-option .restore-strategy-icon,
#revertModal .restore-strategy-label input:checked+.restore-strategy-option .restore-strategy-icon {
    display: inline-flex;
}

#restoreModal .restore-strategy-divider,
#revertModal .restore-strategy-divider {
    width: 1px;
    height: 18px;
    align-self: center;
    background-color: var(--border-color);
    opacity: 0.9;
    margin: 0 2px;
}

/* Action Buttons（与主 UI 的 Restore Modal 一致） */
#restoreModal .modal-btn,
#revertModal .modal-btn {
    min-width: 92px;
    height: 34px;
    padding: 0 12px;
    border-radius: 8px;
    font-size: 14px;
    line-height: 1;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    cursor: pointer;
    user-select: none;
    transition: all 0.2s ease;

    background-color: var(--bg-tertiary);
    color: var(--text-secondary);
    border: 1px solid var(--border-color);
}

#restoreModal .modal-btn:hover:not(:disabled),
#revertModal .modal-btn:hover:not(:disabled) {
    background-color: var(--bg-secondary);
    color: var(--text-primary);
}

#restoreModal .modal-btn.primary,
#revertModal .modal-btn.primary {
    background-color: var(--accent-primary);
    color: #ffffff;
    border: none;
}

#restoreModal .modal-btn.primary:hover:not(:disabled),
#revertModal .modal-btn.primary:hover:not(:disabled) {
    background-color: var(--accent-hover);
}

#restoreModal .modal-btn.patch-confirm-warning {
    border: 1px solid var(--warning);
    background: var(--warning-light);
    color: var(--warning);
}

#restoreModal .modal-btn.patch-confirm-warning:hover:not(:disabled) {
    background: var(--warning-light);
    background-color: var(--warning-light);
    color: var(--warning);
    border-color: var(--warning);
    filter: brightness(0.98);
}

#restoreModal .modal-btn.patch-confirm-warning:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.28);
}

#restoreModal .modal-btn.patch-confirm-danger {
    border: none;
    background: var(--error);
    color: white;
}

#restoreModal .modal-btn.patch-confirm-danger:hover:not(:disabled) {
    background: var(--error);
    background-color: var(--error);
    color: #ffffff;
    filter: brightness(0.95);
}

#restoreModal .modal-btn.patch-confirm-danger:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.28);
}

#restoreModal .modal-btn:disabled,
#revertModal .modal-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

/* 预览视图样式 */
#restoreModal #restorePreviewView {
    max-height: 400px;
}

#restoreModal #restorePreviewContent {
    padding: 8px 20px !important;
}

#revertModal #revertPreviewView {
    max-height: 400px;
}

#revertModal #revertPreviewContent {
    padding: 8px 20px !important;
}

/* Revert Snapshot 卡片 */
#revertModal .revert-snapshot-card {
    background: var(--bg-elevated);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    padding: 10px 12px;
    margin-bottom: 12px;
}

#revertModal .revert-snapshot-row {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    margin-bottom: 4px;
}

#revertModal .revert-snapshot-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 20px;
    padding: 0 8px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 600;
    border: 1px solid var(--border-color);
    background: var(--bg-tertiary);
    color: var(--text-secondary);
}

#revertModal .revert-snapshot-badge.ready {
    border-color: var(--success);
    background: var(--success-light);
    color: var(--success);
}

#revertModal .revert-snapshot-badge.missing {
    border-color: var(--error);
    background: var(--error-light);
    color: var(--error);
}

#revertModal .revert-snapshot-sub {
    font-size: 11px;
    color: var(--text-tertiary);
}

#revertModal .revert-snapshot-time {
    margin-top: 4px;
    font-size: 11px;
    color: var(--text-secondary);
}

#revertModal .revert-snapshot-fingerprint {
    margin-top: 4px;
    font-size: 11px;
    color: var(--text-secondary);
    font-family: SF Mono, Monaco, Consolas, monospace;
    word-break: break-all;
}

/* Revert Preview Header */
#revertModal .revert-preview-header {
    padding: 10px 20px;
    border-bottom: 1px solid var(--border-color);
    background: var(--bg-secondary);
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 10px;
    text-align: left;
}

#revertModal .revert-preview-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    text-align: left;
}

#revertModal .revert-preview-title-wrap {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-left: 2px;
}

#revertModal .modal-header.compact h3 {
    margin-left: 6px;
    text-align: left;
}

#revertModal .revert-preview-help-btn {
    width: 24px;
    height: 24px;
    border-radius: 999px;
    border: 1px solid var(--border-color);
    background: var(--bg-primary);
    color: var(--text-secondary);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    flex-shrink: 0;
    transition: all 0.2s ease;
}

#revertModal .revert-preview-help-btn:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

#revertModal .revert-preview-help-btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px var(--accent-light);
}

#revertModal .revert-preview-help-content {
    margin: 8px 20px 0;
    padding: 8px 10px;
    border-radius: 8px;
    border: 1px solid var(--warning);
    background: var(--warning-light);
}

#revertModal .revert-preview-help-line {
    font-size: 12px;
    line-height: 1.45;
    color: var(--text-secondary);
}

#revertModal .revert-preview-help-line+.revert-preview-help-line {
    margin-top: 4px;
}

#revertModal .revert-preview-sub {
    font-size: 11px;
    color: var(--text-tertiary);
    text-align: left;
}

.action-btn:hover .btn-tooltip {
    visibility: visible;
    opacity: 1;
}

.action-btn:hover {
    background: var(--accent-light);
    color: var(--accent-primary);
    border-color: var(--accent-primary);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

.action-btn:active {
    transform: translateY(0);
}

.action-btn i {
    font-size: 13px;
}

/* 紧凑版按钮 - 与 toggle-btn 尺寸协调 */
.action-btn.compact {
    padding: 5px 8px;
    min-width: 28px;
    height: 28px;
}

.action-btn.compact i {
    font-size: 12px;
}

/* 详情按钮特殊样式 */
/* 详情按钮特殊样式 - 统一为图标按钮 */
.action-btn.detail-btn {
    /* 复用 action-btn 默认样式 (32x32 centered) */
    background: transparent;
    color: var(--text-secondary);
    border: 1px solid var(--border-color);
    padding: 0;
    gap: 0;
}

/* List item quick-open "Search Changes" button: smaller and square */
.action-btn.detail-search-open-btn {
    background: transparent;
    color: var(--text-secondary);
    border: 1px solid var(--border-color);
    padding: 0;
    gap: 0;
}

.action-btn.detail-search-open-btn i {
    font-size: 13px;
}

/* Tighter icon buttons only inside history list rows */
.commit-actions .action-btn.detail-btn,
.commit-actions .action-btn.detail-search-open-btn {
    width: 28px;
    min-width: 28px;
    height: 28px;
}

.commit-actions .action-btn.detail-btn i,
.commit-actions .action-btn.detail-search-open-btn i {
    font-size: 12px;
}

.action-btn.detail-btn i {
    font-size: 13px;
    /* 统一大小 */
}

/* 移除之前的 hover 覆盖，使用默认 action-btn hover 效果 */

/* 详情按钮不显示旧版伪类tooltip，使用新的 .btn-tooltip */
.action-btn.detail-btn::after {
    display: none;
}

/* 操作按钮的自定义tooltip - 快速显示 */
.action-btn::after {
    content: attr(title);
    position: absolute;
    bottom: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    white-space: nowrap;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.05s ease, visibility 0.05s ease;
    z-index: 1000;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    pointer-events: none;
}

.detail-actions-right .action-btn {
    z-index: 2;
}

.detail-actions-right .action-btn::after {
    z-index: 30000;
    bottom: auto;
    top: calc(100% + 8px);
}

.action-btn:hover::after {
    visibility: visible;
    opacity: 1;
    transition-delay: 0s;
}

/* 隐藏浏览器默认tooltip */
.action-btn[title] {
    position: relative;
}

.action-btn[title]:hover {
    color: inherit;
}

/* 隐藏 Tooltip */
.action-btn.no-tooltip::after,
.action-btn.no-tooltip .btn-tooltip {
    display: none !important;
    content: none !important;
}

/* 清除记录按钮的tooltip显示在下方 */
#clearBackupHistoryBtn::after {
    content: attr(data-title);
    bottom: auto;
    top: calc(100% + 1px);
}

.commit-meta {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: nowrap;
    margin-bottom: 0;
    padding: 10px 0;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--bg-secondary);
    width: 100%;
    box-sizing: border-box;
}

/* Left content in commit meta can wrap without affecting hash alignment */
.commit-meta-left {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
    min-width: 0;
    flex-wrap: wrap;
    padding-left: 12px;
    padding-right: 12px;
}

.commit-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
}

.commit-badge.auto {
    background: var(--success-light);
    color: var(--success);
}

.commit-badge.manual {
    background: var(--info-light);
    color: var(--info);
}

.commit-badge.success {
    background: var(--success-light);
    color: var(--success);
}

.commit-badge.error {
    background: var(--error-light);
    color: var(--error);
}

.commit-badge.direction {
    background: var(--bg-tertiary);
    color: var(--text-secondary);
}

/* 切换备份标识 */
.commit-badge.switch {
    background: var(--warning-light);
    color: var(--warning);
}

.commit-stats {
    display: flex;
    gap: 16px;
    font-size: 13px;
    color: var(--text-secondary);
}

.commit-stats.no-change {
    gap: 0;
}

.stat-change {
    display: flex;
    align-items: center;
    gap: 4px;
}

.stat-change.added {
    color: var(--git-added);
}

.stat-change.deleted {
    color: var(--git-deleted);
}

.stat-change.modified {
    color: var(--git-modified);
}

.stat-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 11px;
    font-weight: 500;
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    white-space: nowrap;
}

.stat-badge.quantity {
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    border: 1px solid var(--border-color);
    padding: 4px 12px;
    font-size: 13px;
    font-weight: 600;
}

.stat-color {
    font-weight: 600;
}

.stat-color.added {
    color: var(--git-added);
}

.stat-color.deleted {
    color: var(--git-deleted);
}

.stat-color.moved {
    color: var(--git-moved);
}

.stat-color.modified {
    color: var(--git-modified);
}

.stat-label {
    font-size: 10px;
    font-weight: 600;
    color: var(--text-tertiary);
    text-transform: uppercase;
}

.stat-badge.struct {
    background: var(--git-modified);
    color: #ffffff;
}

.stat-badge.struct.moved {
    background: #2196F3;
    color: #ffffff;
}

.stat-badge.struct.modified {
    background: #FF9800;
    color: #ffffff;
}

.stat-badge.no-change {
    background: var(--success-light);
    color: var(--success);
}

.stat-badge.first {
    background: var(--success-light);
    color: var(--success);
}

.commit-note {
    margin-top: 8px;
    padding: 8px 12px;
    background: var(--bg-secondary);
    border-left: 3px solid var(--accent-primary);
    border-radius: 4px;
    font-size: 13px;
    color: var(--text-secondary);
    font-style: italic;
}

.commit-note-edit-btn {
    padding: 2px 6px;
    margin: 0;
    border: none;
    background: transparent;
    color: var(--accent-primary);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    line-height: 1;
    vertical-align: middle;
}

.commit-note-edit-btn:hover {
    background: var(--accent-light);
    border-radius: 4px;
}

.commit-footer {
    display: none;
}

.commit-fingerprint {
    font-family: 'Courier New', monospace;
    color: var(--accent-primary);
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.5px;
    flex-shrink: 0;

    /* Always stay at far right and vertically centered */
    margin-left: auto;
    align-self: center;
    padding-right: 12px;
    white-space: nowrap;
}

/* 树形视图 */
.bookmark-tree {
    background: var(--bg-elevated);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 16px;
}

/* 图例 */
.tree-legend {
    display: flex;
    gap: 20px;
    margin-bottom: 16px;
    padding: 10px;
    background: var(--bg-secondary);
    border-radius: 6px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--text-secondary);
}

.legend-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.legend-dot.added {
    background: #28a745;
}

.legend-dot.deleted {
    background: #dc3545;
}

.legend-dot.modified {
    background: #fd7e14;
}

.legend-dot.moved {
    background: #0d6efd;
}

/* 树节点 */
.tree-node {
    margin-bottom: 4px;
}

.tree-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 8px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    user-select: none;
}

/* 永久栏目（含副本/当前变化预览）：多行标题时，让变化标识与第一行文本对齐 */
.permanent-bookmark-section .tree-item {
    align-items: flex-start;
}

.changes-tree-preview-inline .tree-item {
    align-items: flex-start;
    /* 保持0内边距，确保不挤压变化标识 */
    padding-right: 0px;
}

/* 永久栏目（含副本）：hover 小标识略向右、略向下 */
.permanent-bookmark-section .tree-item::after {
    right: -6px;
    top: 18px;
    transform: translateY(-50%);
}

/* 当前变化预览：保持原来的小标识位置（不要跟随永久栏目） */
.changes-tree-preview-inline .tree-item::after {
    /* 突破右侧圆圈（悬浮背景），置于更右侧的空白区域 */
    right: -10px;
    /* 垂直对齐第一行文字中心 */
    top: 12.5px;
    transform: none;
}

.permanent-bookmark-section .tree-toggle,
.permanent-bookmark-section .tree-icon,
.changes-tree-preview-inline .tree-toggle,
.changes-tree-preview-inline .tree-icon {
    margin-top: 2px;
}

.permanent-bookmark-section .change-badges,
.changes-tree-preview-inline .change-badges {
    margin-top: 1px;
}

/* Bookmark tree: make change badges slightly wider/bigger for readability. */
.permanent-bookmark-section .change-badge,
.changes-tree-preview-inline .change-badge {
    width: 34px;
    font-size: 14px;
}

.permanent-bookmark-section .change-badge.moved,
.changes-tree-preview-inline .change-badge.moved {
    letter-spacing: 0.5px;
}

/* Keep a hook so we can nudge just the glyph (not the whole badge). */
.change-badge .badge-symbol {
    display: inline-block;
}

/* Glyph optical alignment: "+" often looks slightly low in a centered box. */
.change-badge.added .badge-symbol {
    transform: translateY(-2px);
}

.tree-item:hover {
    background: var(--bg-secondary);
}

/* 文件夹整行可点击视觉反馈 */
.tree-node:has(.tree-children) .tree-item:active {
    background: var(--bg-tertiary);
    transform: scale(0.99);
}

.tree-toggle {
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: var(--text-tertiary);
    transition: transform 0.2s ease;
}

.tree-toggle.expanded {
    transform: rotate(90deg);
}

.tree-icon {
    width: 16px;
    height: 16px;
    color: var(--text-secondary);
}

.tree-label {
    flex: 1;
    font-size: 14px;
    color: var(--text-primary);
    /* 优化长文本换行，避免第一行很少字第二行很多字的情况 */
    word-break: break-all;
    overflow-wrap: anywhere;
}

/* 书签链接样式 */
a.tree-label.tree-bookmark-link {
    text-decoration: none;
    cursor: pointer;
    transition: color 0.2s ease, text-decoration 0.2s ease;
}

a.tree-label.tree-bookmark-link:hover {
    color: var(--accent-primary);
    text-decoration: underline;
}

/* 变动标记 - 统一所有状态标识的UI大小 */
.change-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    /* Use a fixed box so + / - / ~ / >> all look aligned and consistent. */
    width: 30px;
    height: 24px;
    font-size: 13px;
    font-weight: bold;
    padding: 0;
    border-radius: 4px;
    line-height: 1;
    vertical-align: middle;
    box-sizing: border-box;
}

.change-badge.added {
    background: rgba(40, 167, 69, 0.15);
    color: #28a745;
}

.change-badge.deleted {
    background: rgba(220, 53, 69, 0.15);
    color: #dc3545;
}

.change-badge.modified {
    background: rgba(253, 126, 20, 0.15);
    color: #fd7e14;
}

.change-badge.ambiguous {
    background: rgba(111, 66, 193, 0.15);
    color: #6f42c1;
}

.change-badge.has-changes {
    background: rgba(108, 117, 125, 0.15);
    color: #6c757d;
}

/* 移动按钮的面包屑tooltip */
.change-badge.moved {
    background: rgba(13, 110, 253, 0.15);
    color: #0d6efd;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    /* Keep ">>" visually crisp and centered. */
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

.change-badge.moved:hover {
    background: rgba(13, 110, 253, 0.25);
    transform: scale(1.1);
}

/* 统一移动标识内图标的大小 */
.change-badge.moved i {
    font-size: 11px;
    line-height: 1;
}

.change-badge.moved:hover::before {
    content: '';
    position: absolute;
    right: 100%;
    top: 50%;
    transform: translateY(-50%);
    margin-right: -6px;
    border: 6px solid transparent;
    border-left-color: var(--border-color);
    z-index: 1001;
    opacity: 1;
}

.change-badge.moved .move-tooltip {
    display: none;
    position: absolute;
    right: calc(100% + 8px);
    top: 50%;
    transform: translateY(-50%);
    padding: 10px 12px;
    background: var(--bg-elevated);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    white-space: nowrap;
    min-width: 200px;
}

.change-badge.moved:hover .move-tooltip {
    display: block;
}

/* 双路径显示的分隔线 */
.move-tooltip .path-separator {
    height: 1px;
    background: var(--border-color);
    margin: 8px 0;
    width: 100%;
}

/* 每个路径占一行 */
.move-tooltip>span,
.move-tooltip>.path-separator {
    display: flex;
    align-items: center;
    gap: 8px;
}

.move-tooltip-label {
    font-size: 11px;
    color: var(--text-tertiary);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.move-tooltip .breadcrumb-item {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 8px;
    background: rgba(33, 150, 243, 0.08);
    border: 1px solid rgba(33, 150, 243, 0.2);
    border-radius: 4px;
    font-size: 11px;
    color: var(--text-primary);
}

.move-tooltip .breadcrumb-item.root {
    background: rgba(76, 175, 80, 0.08);
    border-color: rgba(76, 175, 80, 0.2);
}

.move-tooltip .breadcrumb-item i {
    font-size: 10px;
    color: #2196F3;
    opacity: 0.8;
}

.move-tooltip .breadcrumb-item.root i {
    color: #4CAF50;
}

.move-tooltip .breadcrumb-separator {
    color: var(--text-tertiary);
    font-size: 8px;
    opacity: 0.5;
    margin: 0 2px;
}

[data-theme="dark"] .change-badge.moved .move-tooltip {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
}

[data-theme="dark"] .move-tooltip .breadcrumb-item {
    background: rgba(33, 150, 243, 0.12);
    border-color: rgba(33, 150, 243, 0.25);
}

[data-theme="dark"] .move-tooltip .breadcrumb-item.root {
    background: rgba(76, 175, 80, 0.12);
    border-color: rgba(76, 175, 80, 0.25);
}

/* 变动节点文字颜色 - 使用直接子选择器，只影响当前项，不影响子项 */
.tree-change-added>.tree-label,
.tree-change-added>a.tree-label {
    color: #28a745;
    font-weight: 500;
}

.tree-change-deleted>.tree-label,
.tree-change-deleted>a.tree-label {
    color: #dc3545;
    font-weight: 500;
    text-decoration: line-through;
    opacity: 0.7;
}

.tree-change-modified>.tree-label,
.tree-change-modified>a.tree-label {
    color: #fd7e14;
    font-weight: 500;
}

.tree-change-ambiguous>.tree-label,
.tree-change-ambiguous>a.tree-label {
    color: #6f42c1;
    font-weight: 500;
}

.tree-change-moved>.tree-label,
.tree-change-moved>a.tree-label {
    color: #0d6efd;
    font-weight: 500;
}

/* 混合类型（modified+moved）*/
.tree-change-mixed>.tree-label,
.tree-change-mixed>a.tree-label {
    background: linear-gradient(180deg, #fd7e14 0%, #0d6efd 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 500;
}

/* 多个变化标记的容器 */
.change-badges {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    margin-left: auto;
}

/* Path hint group: gray dot + aggregated change badges for descendants. */
.path-badges {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    /* Match the single change-badge box sizing so rows align nicely. */
    height: 24px;
    padding: 0 6px;
    border-radius: 6px;
    background: rgba(108, 117, 125, 0.08);
    border: 1px solid rgba(108, 117, 125, 0.18);
    box-sizing: border-box;
}

.path-dot {
    color: #6c757d;
    font-weight: 700;
    line-height: 1;
}

/* In path-badges, use plain colored symbols (no boxed badges). */
.path-symbol {
    display: inline-block;
    font-weight: 800;
    font-size: 13px;
    line-height: 1;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

.path-symbol.added { color: var(--git-added); }
.path-symbol.deleted { color: var(--git-deleted); }
.path-symbol.modified { color: var(--git-modified); }
.path-symbol.moved { color: var(--git-moved); }

.tree-children {
    margin-left: 12px;
    display: none;
}

.tree-children.expanded {
    display: block;
}

/* JSON视图 */
.bookmark-json {
    background: var(--bg-elevated);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    overflow: hidden;
}

.json-header {
    padding: 12px 16px;
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: flex-end;
}

.json-copy-btn {
    padding: 6px 12px;
    background: #2196F3;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s;
}

.json-copy-btn:hover {
    background: #1976D2;
}

/* JSON Diff视图 */
.json-diff-content {
    margin: 0;
    padding: 0;
    background: var(--bg-elevated);
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 13px;
    line-height: 1.5;
    overflow-x: auto;
    max-height: 70vh;
    overflow-y: auto;
}

.json-diff-line {
    display: flex;
    align-items: stretch;
    min-height: 20px;
}

.json-diff-line.same {
    background: var(--bg-elevated);
}

.json-diff-line.added {
    background: rgba(40, 167, 69, 0.15);
    border-left: 3px solid #28a745;
}

.json-diff-line.deleted {
    background: rgba(220, 53, 69, 0.15);
    border-left: 3px solid #dc3545;
}

.json-line-num {
    display: inline-block;
    width: 50px;
    padding: 2px 8px;
    text-align: right;
    color: var(--text-tertiary);
    background: var(--bg-primary);
    border-right: 1px solid var(--border-color);
    user-select: none;
    flex-shrink: 0;
}

.json-line-num.old {
    border-right: none;
}

.json-prefix {
    display: inline-block;
    width: 24px;
    padding: 2px 0;
    text-align: center;
    font-weight: bold;
    flex-shrink: 0;
}

.json-diff-line.added .json-prefix {
    color: #28a745;
}

.json-diff-line.deleted .json-prefix {
    color: #dc3545;
}

.json-diff-line.same .json-prefix {
    color: var(--text-tertiary);
}

.json-line-text {
    flex: 1;
    padding: 2px 12px;
    white-space: pre;
    color: var(--text-primary);
}

/* 深色模式 */
[data-theme="dark"] .json-diff-line.added {
    background: rgba(40, 167, 69, 0.2);
}

[data-theme="dark"] .json-diff-line.deleted {
    background: rgba(220, 53, 69, 0.2);
}

/* ==================== 弹窗 ==================== */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 21000;
    align-items: center;
    justify-content: center;
}

.modal#exportChangesModal {
    z-index: 22000;
}

.modal.show {
    display: flex;
}

/* 弹窗在右侧内容区居中（考虑侧边栏宽度） */
.modal.content-center {
    left: var(--sidebar-width, 260px);
    width: calc(100% - var(--sidebar-width, 260px));
}

/* 右上角快捷键二级 UI：定位在头部工具按钮正下方靠右 */
#shortcutsModal {
    align-items: flex-start;
    justify-content: flex-end;
    padding-top: 72px;
    /* 约等于 header 高度，刚好在四个按钮下方 */
    padding-right: 24px;
}

.modal-content {
    background: var(--bg-elevated);
    border-radius: 16px;
    width: 90%;
    max-width: 800px;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    box-shadow: var(--shadow-lg);
}

/* 专门给快捷键二级 UI 使用：覆盖默认宽度为“按内容自适应” */
.modal-content.shortcuts-modal {
    width: auto;
    max-width: none;
    display: inline-block;
    border-radius: 10px;
    padding: 10px 10px 8px;
    margin: 8px 0 0 0;
    /* 右边缘与 header 右内边距对齐 */
    align-self: flex-start;
    /* 在 flex 容器中靠上对齐 */
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 24px;
    border-bottom: 1px solid var(--border-color);
}

.modal-header-left {
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 0;
}

.modal-header h3 {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary);
}

.modal-close {
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 50%;
    background: var(--bg-secondary);
    color: var(--text-primary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.modal-close:hover {
    background: var(--bg-tertiary);
}

.modal-body {
    padding: 24px;
    overflow-y: auto;
    flex: 1;
}

/* 详情内容样式 */
.detail-section {
    margin-bottom: 24px;
}

.detail-section-title {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
    text-align: left;
}

.detail-section-icon {
    width: 20px;
    height: 20px;
}

.detail-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.detail-item {
    padding: 12px;
    background: var(--bg-secondary);
    border-radius: 8px;
    font-size: 13px;
}

.detail-item-folder {
    font-weight: 600;
    color: var(--accent-primary);
    margin-bottom: 4px;
}

.detail-item-title {
    color: var(--text-primary);
    margin-bottom: 2px;
}

.detail-item-url {
    color: var(--text-tertiary);
    font-size: 12px;
    word-break: break-all;
}

.detail-empty {
    padding: 24px;
    text-align: center;
    color: var(--text-secondary);
    font-size: 14px;
}

/* 内联备注样式 */
.detail-section-inline {
    display: flex;
    flex-wrap: wrap;
    align-items: baseline;
    gap: 6px;
    margin-bottom: 16px;
    line-height: 1.5;
}

.detail-section-title-inline {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    display: inline-flex;
    align-items: baseline;
    gap: 6px;
    flex-shrink: 0;
}

.detail-section-title-inline .detail-section-icon {
    align-self: center;
}

.detail-item-inline {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.5;
}

/* 标题行带图例 */
.detail-section-title-with-legend {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: nowrap;
    gap: 12px;
}

#revertModal .diff-file-path {
    text-align: left;
}

.detail-title-left {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
}

.detail-actions-row {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    margin-bottom: 8px;
}

.detail-actions-right {
    display: flex;
    align-items: center;
    gap: 8px;
    height: 32px;
    margin-left: auto;
    flex-shrink: 0;
    position: relative;
    z-index: 2;
}

/* Removed overrides to allow global compact styles to apply */

.detail-note-row {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    flex-wrap: wrap;
    min-width: 0;
    padding: 0;
    margin: -2px 0;
    line-height: 1.2;
    overflow: visible;
}

.detail-note-label {
    flex-shrink: 0;
}

.detail-note-text {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    flex: 0 1 auto;
    min-width: 0;
    white-space: normal;
    word-break: break-word;
}

.detail-note-text-wrapper {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
    flex: 1 1 auto;
    min-width: 0;
}

.detail-note-edit-btn {
    margin-left: 2px;
}

.detail-mode-label {
    font-size: 0.85em;
    color: var(--text-tertiary);
}

.detail-title-legend {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
}

.detail-title-legend .legend-item {
    display: inline-flex;
    align-items: center;
    gap: 3px;
}

.detail-title-legend .legend-dot {
    width: 12px;
    height: 12px;
}

.detail-title-legend .legend-count {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-secondary);
}

/* 备份历史树容器 */
.history-tree-container {
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 12px;
    background: var(--bg-secondary);
}

.history-tree-container .tree-item::after {
    /* 只在备份历史里：略向右、略向下（仍在容器内，不做额外留白） */
    right: -4px;
    top: calc(50% + 1px);
}

/* 备份历史树形视图样式 */
.history-tree-node {
    padding: 4px 8px;
    line-height: 1.6;
    transition: background-color 0.15s ease;
    border-radius: 4px;
}

.history-tree-node:hover {
    background: var(--bg-tertiary);
}

.history-tree-folder,
.history-tree-bookmark {
    display: flex;
    align-items: center;
    font-size: 13px;
}

.history-tree-folder {
    font-weight: 500;
    color: var(--text-primary);
}

.history-tree-bookmark {
    color: var(--text-primary);
}

.history-tree-url {
    flex-shrink: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.history-tree-node.tree-change-added {
    background: var(--git-added-bg);
}

.history-tree-node.tree-change-deleted {
    background: var(--git-deleted-bg);
}

.history-tree-node.tree-change-modified {
    background: var(--git-modified-bg);
}

.history-tree-node.tree-change-moved {
    background: var(--git-moved-bg);
}

.history-tree-node.tree-change-mixed {
    background: linear-gradient(180deg, var(--git-modified-bg) 0%, var(--git-moved-bg) 100%);
}

/* 详略模式切换按钮组 */
.toggle-btn-group {
    display: inline-flex;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    overflow: hidden;
}

.toggle-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 10px;
    font-size: 12px;
    background: var(--bg-secondary);
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
}

.toggle-btn:not(:last-child) {
    border-right: 1px solid var(--border-color);
}

.toggle-btn:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.toggle-btn.active {
    background: var(--accent-primary);
    color: white;
}

.toggle-btn i {
    font-size: 11px;
}


.toggle-btn span {
    margin-top: 1px;
}

/* 备份历史树形视图连接线 */
.history-tree-container .history-tree-root-children {
    --tree-toggle-center: 16px;
    --tree-children-indent: 12px;
    margin-left: var(--tree-toggle-center);
    padding-left: var(--tree-children-indent);
}

.history-tree-container .tree-children {
    --tree-toggle-center: 16px;
    --tree-children-indent: 12px;
    margin-left: var(--tree-toggle-center);
    padding-left: var(--tree-children-indent);
    position: relative;
    border-left: 1px solid var(--border-color);
}

.history-tree-container .tree-node {
    position: relative;
}

.history-tree-container .tree-children>.tree-node>.tree-item {
    position: relative;
}

.history-tree-container .tree-children>.tree-node>.tree-item::before {
    content: '';
    position: absolute;
    left: calc(-1 * var(--tree-children-indent));
    top: 50%;
    width: calc(var(--tree-children-indent) + var(--tree-toggle-center));
    height: 1px;
    transform: translateY(-50%);
    background: var(--border-color);
}

/* 确保最后一个子节点的连接线正确 */
.history-tree-container .tree-children>.tree-node:last-child::after {
    content: '';
    position: absolute;
    left: calc(-1 * var(--tree-children-indent) - 1px);
    top: 50%;
    bottom: 0;
    width: 1px;
    background: var(--bg-secondary);
}

/* ==================== 滚动条样式 ==================== */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-secondary);
}

::-webkit-scrollbar-thumb {
    background: var(--border-color);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--border-hover);
}

/* ==================== 当前变化视图 ==================== */
.current-changes-container {
    display: flex;
    flex-direction: column;
    gap: 24px;
}

/* ==================== 书签树映射预览（内嵌到Bookmark Changes下方） ==================== */
.changes-tree-preview-inline {
    margin-top: 0;
    padding-top: 10px;
    border-top: 1px dashed var(--border-color);
}

/* 克隆的永久栏目 - 重置定位，去掉标题和边框，内嵌融入 */
.changes-tree-preview-inline .changes-preview-readonly {
    position: relative !important;
    top: auto !important;
    left: auto !important;
    transform: none !important;
    width: 100% !important;
    height: auto !important;
    border: none !important;
    box-shadow: none !important;
    background: transparent !important;
    margin: 0 !important;
    z-index: auto !important;
}

.changes-tree-preview-inline .changes-preview-readonly .permanent-section-header {
    display: none !important;
}

.changes-tree-preview-inline .changes-preview-readonly .permanent-section-body {
    max-height: none !important;
    min-height: 0 !important;
    border: none !important;
    background: transparent !important;
    padding: 0 !important;
    overflow: visible !important;
    /* Prevent scroll anchoring from causing subtle jumps on async DOM updates (lazy-load / icon load). */
    overflow-anchor: none;
}

/* 当前变化视图：隐藏拉伸手柄（只读视图不需要调整大小） */
.changes-tree-preview-inline .changes-preview-readonly .resize-handle,
.changes-tree-preview-inline .changes-preview-readonly .resize-handle-nw,
.changes-tree-preview-inline .changes-preview-readonly .resize-handle-ne,
.changes-tree-preview-inline .changes-preview-readonly .resize-handle-sw,
.changes-tree-preview-inline .changes-preview-readonly .resize-handle-se,
.changes-tree-preview-inline .changes-preview-readonly .resize-handle-n,
.changes-tree-preview-inline .changes-preview-readonly .resize-handle-s,
.changes-tree-preview-inline .changes-preview-readonly .resize-handle-e,
.changes-tree-preview-inline .changes-preview-readonly .resize-handle-w {
    display: none !important;
}

/* 简略模式：隐藏没有变化的节点
   - 保留“变化路径上的祖先节点”（含 path-badges / 路径提示），否则树会变成断裂的孤立叶子 */
.changes-tree-preview-inline.compact-mode .tree-node:not(:has(.tree-change-added)):not(:has(.tree-change-deleted)):not(:has(.tree-change-modified)):not(:has(.tree-change-moved)):not(:has(.tree-change-mixed)):not(:has(.path-badges)) {
    display: none !important;
}

/* 简略模式：确保有变化的节点显示 */
.changes-tree-preview-inline.compact-mode .tree-node:has(.tree-change-added),
.changes-tree-preview-inline.compact-mode .tree-node:has(.tree-change-deleted),
.changes-tree-preview-inline.compact-mode .tree-node:has(.tree-change-modified),
.changes-tree-preview-inline.compact-mode .tree-node:has(.tree-change-moved),
.changes-tree-preview-inline.compact-mode .tree-node:has(.tree-change-mixed) {
    display: block !important;
}

/* 简略模式：变化路径祖先（path-badges）也应显示 */
.changes-tree-preview-inline.compact-mode .tree-node:has(.path-badges) {
    display: block !important;
}

/* 简略模式：也显示路径徽标，和详细模式保持一致（避免用户误以为未刷新） */
.changes-tree-preview-inline.compact-mode .path-badges {
    display: inline-flex !important;
}



/* 简略模式：保留 has-changes 灰点（用于定位变化路径） */

/* 简略模式：展开“移动文件夹”时，允许显示其全部子树（即使子节点无变化） */
.changes-tree-preview-inline.compact-mode .tree-node.compact-reveal-all .tree-node {
    display: block !important;
}

/* 覆盖简略模式的“无变化节点隐藏规则”（需要更高特异性，避免被 :not(:has(...)) + !important 压制） */
.changes-tree-preview-inline.compact-mode .tree-node.compact-reveal-all .tree-node:not(:has(.tree-change-added)):not(:has(.tree-change-deleted)):not(:has(.tree-change-modified)):not(:has(.tree-change-moved)):not(:has(.tree-change-mixed)) {
    display: block !important;
}

/* 详略切换按钮激活状态 */
.diff-edit-btn.icon-only.active {
    background: rgba(33, 150, 243, 0.25);
}

/* 点击diff行时高亮对应节点 */
.diff-line.clickable {
    cursor: pointer;
}

.diff-line.clickable:hover {
    filter: brightness(0.92);
}

/* diff行中的跳转按钮 - 默认隐藏，hover时显示 */
.diff-line.clickable:hover .jump-to-related-btn-container {
    opacity: 1 !important;
}

/* ========== 跳转至书签关联记录按钮 ========== */
.jump-to-related-btn-container {
    opacity: 0;
    transition: opacity 0.2s ease;
}

/* 悬停时显示跳转按钮 */
*:hover>.jump-to-related-btn-container,
.jump-to-related-btn-container:hover {
    opacity: 1;
}

.jump-to-related-btn {
    width: 24px;
    height: 24px;
    padding: 0;
    border: 1px solid rgba(33, 150, 243, 0.28);
    background: rgba(33, 150, 243, 0.10);
    color: rgba(33, 150, 243, 0.95);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    transition: all 0.2s ease;
    opacity: 0.85;
}

.jump-to-related-btn:hover {
    background: rgba(33, 150, 243, 0.16);
    border-color: rgba(33, 150, 243, 0.42);
    color: rgba(33, 150, 243, 1);
    transform: scale(1.1);
    opacity: 0.9;
}

.jump-to-related-btn i {
    font-size: 12px;
}

/* 高亮闪烁动画 */
.tree-item.highlight-added {
    animation: highlightPulseAdded 0.6s ease-in-out 2;
    border-radius: 4px;
}

.tree-item.highlight-deleted {
    animation: highlightPulseDeleted 0.6s ease-in-out 2;
    border-radius: 4px;
}

.tree-item.highlight-modified {
    animation: highlightPulseModified 0.6s ease-in-out 2;
    border-radius: 4px;
}

.tree-item.highlight-moved {
    animation: highlightPulseMoved 0.6s ease-in-out 2;
    border-radius: 4px;
}

@keyframes highlightPulseAdded {

    0%,
    100% {
        box-shadow: none;
    }

    50% {
        box-shadow: inset 0 0 0 2px var(--git-added), 0 0 8px var(--git-added);
        background: var(--git-added-bg);
    }
}

@keyframes highlightPulseDeleted {

    0%,
    100% {
        box-shadow: none;
    }

    50% {
        box-shadow: inset 0 0 0 2px var(--git-deleted), 0 0 8px var(--git-deleted);
        background: var(--git-deleted-bg);
    }
}

@keyframes highlightPulseModified {

    0%,
    100% {
        box-shadow: none;
    }

    50% {
        box-shadow: inset 0 0 0 2px var(--git-modified), 0 0 8px var(--git-modified);
        background: var(--git-modified-bg);
    }
}

@keyframes highlightPulseMoved {

    0%,
    100% {
        box-shadow: none;
    }

    50% {
        box-shadow: inset 0 0 0 2px var(--git-moved), 0 0 8px var(--git-moved);
        background: var(--git-moved-bg);
    }
}

/* Git Diff 折叠样式 */
.git-diff-viewer.collapsed-default .diff-folder-group {
    /* 默认折叠 */
}

.git-diff-section-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    color: var(--text-secondary);
    transition: all 0.2s ease;
    margin-top: 16px;
}

.git-diff-section-toggle:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.git-diff-section-toggle i {
    transition: transform 0.3s ease;
}

.git-diff-section-toggle.expanded i {
    transform: rotate(180deg);
}

.git-diff-collapsible {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.git-diff-collapsible.expanded {
    max-height: none;
}

.change-category {
    background: var(--bg-elevated);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    overflow: hidden;
}

.change-category-header {
    padding: 16px 20px;
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    gap: 12px;
}

.change-category-icon {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    font-size: 14px;
}

.change-category-icon.added {
    background: var(--git-added-bg);
    color: var(--git-added);
}

.change-category-icon.deleted {
    background: var(--git-deleted-bg);
    color: var(--git-deleted);
}

.change-category-icon.modified {
    background: var(--git-modified-bg);
    color: var(--git-modified);
}

.change-category-icon.moved {
    background: var(--git-moved-bg);
    color: var(--git-moved);
}

.change-category-title {
    flex: 1;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
}

.change-category-count {
    font-size: 14px;
    color: var(--text-secondary);
    font-weight: normal;
}

.change-tree {
    padding: 16px;
}

.change-tree-node {
    margin-bottom: 8px;
}

.change-tree-folder {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: var(--bg-secondary);
    border-radius: 8px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.change-tree-folder:hover {
    background: var(--bg-tertiary);
}

.change-tree-folder i {
    color: var(--text-secondary);
}

.change-tree-folder-name {
    flex: 1;
    font-weight: 500;
    color: var(--text-primary);
}

.change-tree-items {
    margin-left: 32px;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.change-tree-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 12px;
    border-radius: 6px;
    transition: all 0.2s ease;
}

.change-tree-item:hover {
    background: var(--bg-secondary);
}

.change-tree-item-icon {
    width: 16px;
    height: 16px;
    object-fit: contain;
    flex-shrink: 0;
}

.change-tree-item-info {
    flex: 1;
    min-width: 0;
}

.change-tree-item-title {
    font-size: 14px;
    color: var(--text-primary);
    /* 允许长文本合理换行 */
    word-break: break-all;
    overflow-wrap: anywhere;
}

.change-tree-item-url {
    font-size: 12px;
    color: var(--text-tertiary);
    /* 允许长URL合理换行 */
    word-break: break-all;
    overflow-wrap: anywhere;
    margin-top: 2px;
}

.change-tree-item-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 500;
    white-space: nowrap;
}

.change-tree-item-badge.added {
    background: var(--git-added-bg);
    color: var(--git-added);
}

.change-tree-item-badge.deleted {
    background: var(--git-deleted-bg);
    color: var(--git-deleted);
}

.change-tree-item-badge.modified {
    background: var(--git-modified-bg);
    color: var(--git-modified);
}

.change-tree-item-badge.moved {
    background: var(--git-moved-bg);
    color: var(--git-moved);
}

.no-changes-message {
    text-align: center;
    padding: 60px 24px;
    color: var(--text-secondary);
}

.no-changes-icon {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.3;
}

.no-changes-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--text-primary);
}

.no-changes-desc {
    font-size: 14px;
}

/* ==================== 响应式设计 ==================== */
/* 在中等屏幕（1024px以下）时，自动收缩侧边栏 */
@media (max-width: 1024px) {
    .sidebar {
        width: var(--sidebar-collapsed-width);
        padding: 16px 4px;
    }

    .sidebar .nav-tab span,
    .sidebar .nav-group-title {
        display: none;
    }

    .sidebar .nav-group {
        border-bottom: none;
        margin-bottom: 8px;
        padding-bottom: 8px;
    }

    .sidebar .nav-tab {
        justify-content: center;
        padding: 12px 0;
    }

    .sidebar .nav-tab i {
        margin: 0;
    }

    /* time widget removed */
}

@media (max-width: 768px) {

    /* 保持横向布局，不要纵向堆叠 */
    .main-container {
        flex-direction: row;
        /* 保持横向 */
    }

    /* 自动收缩侧边栏，而不是占满宽度 */
    .sidebar {
        width: var(--sidebar-collapsed-width);
        /* 自动收缩到最小宽度 */
        padding: 16px 4px;
        border-right: 1px solid var(--border-color);
        border-bottom: none;
    }

    /* 在小屏幕上自动隐藏侧边栏文字（相当于自动收起） */
    .sidebar .nav-tab span,
    .sidebar .nav-group-title {
        display: none;
    }

    .sidebar .nav-group {
        border-bottom: none;
        margin-bottom: 8px;
        padding-bottom: 8px;
    }

    .sidebar .nav-tab {
        justify-content: center;
        padding: 12px 0;
    }

    .sidebar .nav-tab i {
        margin: 0;
    }

    /* time widget removed */

    .search-container input {
        width: 200px;
    }

    .search-container input:focus {
        width: 240px;
    }
}

/* ==================== 加载动画 ==================== */
.loading {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
    color: var(--text-secondary);
}

.loading::after {
    content: '';
    width: 24px;
    height: 24px;
    margin-left: 12px;
    border: 3px solid var(--border-color);
    border-top-color: var(--accent-primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* ==================== 空状态 ==================== */
.empty-state {
    text-align: center;
    padding: 60px 24px;
    color: var(--text-secondary);
}

.empty-state-icon {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.empty-state-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--text-primary);
}

.empty-state-description {
    font-size: 14px;
}

/* ==================== Git Diff 风格（类似 IDE） ==================== */
.git-diff-container {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    margin-bottom: 24px;
    overflow: hidden;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.diff-header {
    background: var(--bg-primary);
    border-bottom: 1px solid var(--border-color);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    font-weight: 600;
}

.diff-icon {
    font-size: 18px;
    align-self: center;
}

.diff-title {
    color: var(--text-primary);
    font-size: 14px;
}

.diff-header-legend {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-left: 16px;
    padding-left: 16px;
    border-left: 1px solid var(--border-color);
}

/* 当前变化视图：四个操作（新增/删除/移动/修改）2x2 */
.current-changes-ops-grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 10px;
    padding: 10px 16px;
}

/* 只有一个操作时铺满一行 */
.current-changes-ops-grid.single-op {
    grid-template-columns: 1fr;
}

.current-changes-ops-grid .diff-line {
    border-radius: 8px;
    padding: 8px 12px;
    min-height: 0;
    /* In the 2x2 "jump" tiles, center the symbol/text as a single row. */
    align-items: center;
}

.current-changes-ops-grid .diff-prefix {
    transform: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    line-height: 1;
    height: 24px;
    width: 30px;
    font-size: 15px;
    vertical-align: middle;
}

.current-changes-ops-grid .diff-line.modified .diff-prefix {
    /* Make "~" feel longer without changing the underlying text content. */
    width: 34px;
    transform: scaleX(1.35);
    transform-origin: center;
}

.current-changes-ops-grid .diff-content {
    display: inline-flex;
    align-items: center;
    line-height: 1;
}

/* The left chunk inside each tile is an inline-styled flex container; reassert centering. */
.current-changes-ops-grid .diff-line > div:first-child {
    display: flex;
    align-items: center;
    gap: 2px;
}

@media (max-width: 520px) {
    .current-changes-ops-grid {
        grid-template-columns: 1fr;
    }
}

.diff-header-legend .legend-item {
    display: inline-flex;
    align-items: baseline;
    gap: 4px;
    font-size: 11px;
    font-weight: normal;
    color: var(--text-secondary);
}

.diff-header-legend .legend-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
}

.diff-header-legend .legend-dot.added {
    background: var(--git-added);
}

.diff-header-legend .legend-dot.deleted {
    background: var(--git-deleted);
}

.diff-header-legend .legend-dot.modified {
    background: var(--git-modified);
}

.diff-header-legend .legend-dot.moved {
    background: var(--git-moved);
}

.diff-header-spacer {
    flex: 1;
}

.diff-edit-btn {
    display: flex;
    align-items: center;
    align-self: center;
    gap: 6px;
    padding: 6px 12px;
    background: var(--accent-primary);
    color: #ffffff;
    border: none;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.diff-edit-btn:hover {
    background: var(--accent-hover);
    transform: translateY(-1px);
}

.diff-edit-btn i {
    font-size: 12px;
}

/* 仅图标样式 - 透明淡蓝色 */
.diff-edit-btn.icon-only {
    padding: 6px;
    background: rgba(33, 150, 243, 0.1);
    color: #2196F3;
    border-radius: 6px;
}

.diff-edit-btn.icon-only:hover {
    background: rgba(33, 150, 243, 0.2);
}

.diff-edit-btn.icon-only svg {
    display: block;
}

/* 快速显示 tooltip - 当前变化视图的按钮（与顶部按钮一致的样式） */
.diff-header .diff-edit-btn.icon-only {
    position: relative;
}

/* 当前变化视图按钮的tooltip（继承顶部按钮样式） */
.diff-header .diff-edit-btn.icon-only .btn-tooltip {
    position: absolute;
    top: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    white-space: nowrap;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.05s ease, visibility 0.05s ease;
    pointer-events: none;
    z-index: 10000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
}

.diff-header .diff-edit-btn.icon-only .btn-tooltip::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 5px solid transparent;
    border-bottom-color: rgba(0, 0, 0, 0.9);
}

.diff-header .diff-edit-btn.icon-only:hover .btn-tooltip {
    visibility: visible;
    opacity: 1;
}

.diff-stats {
    color: var(--text-secondary);
    font-size: 13px;
    font-weight: 500;
}

.diff-body {
    padding: 0;
}

.diff-line {
    display: flex;
    align-items: baseline;
    padding: 6px 16px;
    border-left: 4px solid transparent;
    transition: background-color 0.2s ease;
    min-height: 32px;
}

.diff-line:hover {
    filter: brightness(0.95);
}

.diff-prefix {
    display: inline-block;
    width: 20px;
    margin-right: 8px;
    font-weight: bold;
    font-size: 14px;
    flex-shrink: 0;
    vertical-align: text-top;
    transform: translateY(-2px);
}

.diff-content {
    flex: 1;
    font-size: 14px;
    line-height: 1.5;
}

/* 添加状态（绿色） */
.diff-line.added {
    background-color: rgba(40, 167, 69, 0.1);
    border-left-color: #28a745;
}

.diff-line.added .diff-prefix {
    color: #28a745;
}

.diff-line.added .diff-content {
    color: #1e7e34;
}

/* 删除状态（红色） */
.diff-line.deleted {
    background-color: rgba(220, 53, 69, 0.1);
    border-left-color: #dc3545;
}

.diff-line.deleted .diff-prefix {
    color: #dc3545;
}

.diff-line.deleted .diff-content {
    color: #bd2130;
}

/* 修改状态（橙色） */
.diff-line.modified {
    background-color: var(--git-modified-bg);
    border-left-color: var(--git-modified);
}

.diff-line.modified .diff-prefix {
    color: var(--git-modified);
}

.diff-line.modified .diff-content {
    color: var(--git-modified);
}

/* 移动状态（蓝色） */
.diff-line.moved {
    background-color: var(--git-moved-bg);
    border-left-color: var(--git-moved);
}

.diff-line.moved .diff-prefix {
    color: var(--git-moved);
}

.diff-line.moved .diff-content {
    color: var(--git-moved);
}

/* 无变化状态（灰色） */
.diff-line.unchanged {
    background-color: rgba(108, 117, 125, 0.05);
    border-left-color: #6c757d;
}

.diff-line.unchanged .diff-prefix {
    color: #6c757d;
}

.diff-line.unchanged .diff-content {
    color: #6c757d;
    font-style: italic;
}

/* 深色模式适配 */
[data-theme="dark"] .diff-line.added {
    background-color: rgba(40, 167, 69, 0.15);
}

[data-theme="dark"] .diff-line.added .diff-content {
    color: #4caf50;
}

[data-theme="dark"] .diff-line.deleted {
    background-color: rgba(220, 53, 69, 0.15);
}

[data-theme="dark"] .diff-line.deleted .diff-content {
    color: #f44336;
}

[data-theme="dark"] .diff-line.modified {
    background-color: var(--git-modified-bg);
}

[data-theme="dark"] .diff-line.modified .diff-content {
    color: var(--git-modified);
}

[data-theme="dark"] .diff-line.moved {
    background-color: var(--git-moved-bg);
}

[data-theme="dark"] .diff-line.moved .diff-content {
    color: var(--git-moved);
}

/* ==================== Git Diff Viewer（真正的 diff 格式） ==================== */
.git-diff-viewer {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    margin: 16px 0;
    overflow: hidden;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 13px;
}

.diff-file-header {
    background: var(--bg-primary);
    padding: 10px 16px;
    border-bottom: 1px solid var(--border-color);
    font-weight: 600;
    color: var(--text-secondary);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.diff-file-path {
    flex: 1;
}

/* 复制diff按钮（Current Changes中） */
.copy-diff-btn {
    padding: 6px 12px;
    background: var(--accent-primary);
    color: #ffffff;
    border: none;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}

.copy-diff-btn:hover {
    background: var(--accent-hover);
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.copy-diff-btn:active {
    transform: translateY(0);
}

.copy-diff-btn i {
    font-size: 12px;
}

/* 文件夹分组 */
.diff-folder-group {
    border-bottom: 1px solid var(--border-color);
}

.diff-folder-group:last-child {
    border-bottom: none;
}

.diff-folder-header-static {
    background: var(--bg-primary);
    padding: 12px 16px;
    border-bottom: 1px solid var(--border-color);
}

/* 面包屑导航 */
.breadcrumb {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 6px;
}

.breadcrumb-item {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    background: rgba(33, 150, 243, 0.08);
    border: 1px solid rgba(33, 150, 243, 0.2);
    border-radius: 4px;
    font-size: 12px;
    color: var(--text-primary);
    font-weight: 500;
    transition: all 0.2s;
}

.breadcrumb-item:hover {
    background: rgba(33, 150, 243, 0.12);
    border-color: rgba(33, 150, 243, 0.3);
}

.breadcrumb-item.root {
    background: rgba(76, 175, 80, 0.08);
    border-color: rgba(76, 175, 80, 0.2);
}

.breadcrumb-item.root:hover {
    background: rgba(76, 175, 80, 0.12);
    border-color: rgba(76, 175, 80, 0.3);
}

.breadcrumb-item i {
    font-size: 11px;
    color: #2196F3;
    opacity: 0.8;
}

.breadcrumb-item.root i {
    color: #4CAF50;
}

.breadcrumb-text {
    line-height: 1;
}

.breadcrumb-separator {
    color: var(--text-tertiary);
    font-size: 9px;
    opacity: 0.5;
}

/* 深色模式 */
[data-theme="dark"] .breadcrumb-item {
    background: rgba(33, 150, 243, 0.12);
    border-color: rgba(33, 150, 243, 0.25);
}

[data-theme="dark"] .breadcrumb-item:hover {
    background: rgba(33, 150, 243, 0.18);
    border-color: rgba(33, 150, 243, 0.35);
}

[data-theme="dark"] .breadcrumb-item.root {
    background: rgba(76, 175, 80, 0.12);
    border-color: rgba(76, 175, 80, 0.25);
}

[data-theme="dark"] .breadcrumb-item.root:hover {
    background: rgba(76, 175, 80, 0.18);
    border-color: rgba(76, 175, 80, 0.35);
}

.diff-hunk {
    margin: 0;
}

.diff-hunk-header {
    background: rgba(33, 150, 243, 0.1);
    color: #2196F3;
    padding: 6px 16px;
    font-weight: 600;
    border-top: 1px solid var(--border-color);
    border-bottom: 1px solid var(--border-color);
}

.diff-hunk-header.collapsible {
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    user-select: none;
    transition: background 0.2s;
}

.diff-hunk-header.collapsible:hover {
    background: rgba(33, 150, 243, 0.15);
}

.collapse-icon {
    font-size: 10px;
    color: rgba(33, 150, 243, 0.7);
    width: 12px;
    flex-shrink: 0;
}

.hunk-location {
    flex: 1;
}

.hunk-stats {
    display: flex;
    gap: 8px;
    font-size: 12px;
    font-weight: 600;
}

.stat-add {
    color: #28a745;
}

.stat-delete {
    color: #dc3545;
}

.diff-hunk-content {
    display: block;
}

.diff-hunk-content.collapsed {
    display: none;
}

.diff-line-wrapper {
    display: flex;
    align-items: stretch;
    line-height: 1.5;
    border-left: 4px solid transparent;
}

.diff-line-wrapper:hover {
    filter: brightness(0.95);
}

.diff-line-num {
    display: inline-block;
    width: 50px;
    padding: 2px 8px;
    text-align: right;
    color: var(--text-tertiary);
    background: var(--bg-primary);
    border-right: 1px solid var(--border-color);
    user-select: none;
    flex-shrink: 0;
}

.diff-line-num.old {
    border-right: none;
}

.diff-line-prefix {
    display: inline-block;
    width: 20px;
    padding: 2px 0;
    text-align: center;
    font-weight: bold;
    flex-shrink: 0;
}

.diff-line-content {
    flex: 1;
    padding: 2px 8px;
    white-space: pre;
    overflow-x: auto;
}

/* 上下文行 */
.diff-line-wrapper.context {
    background: var(--bg-secondary);
}

.diff-line-wrapper.context .diff-line-prefix {
    color: var(--text-tertiary);
}

/* 添加的行 */
.diff-line-wrapper.added {
    background: rgba(40, 167, 69, 0.15);
    border-left-color: #28a745;
}

.diff-line-wrapper.added .diff-line-prefix {
    color: #28a745;
    background: rgba(40, 167, 69, 0.2);
}

.diff-line-wrapper.added .diff-line-content {
    color: var(--text-primary);
}

/* 删除的行 */
.diff-line-wrapper.deleted {
    background: rgba(220, 53, 69, 0.15);
    border-left-color: #dc3545;
}

.diff-line-wrapper.deleted .diff-line-prefix {
    color: #dc3545;
    background: rgba(220, 53, 69, 0.2);
}

.diff-line-wrapper.deleted .diff-line-content {
    color: var(--text-primary);
}

/* 深色模式 */
[data-theme="dark"] .diff-line-wrapper.added {
    background: rgba(40, 167, 69, 0.2);
}

[data-theme="dark"] .diff-line-wrapper.deleted {
    background: rgba(220, 53, 69, 0.2);
}

[data-theme="dark"] .diff-hunk-header {
    background: rgba(33, 150, 243, 0.15);
}

/* ==================== Git Diff 文件列表样式 ==================== */
.diff-file-line {
    display: flex;
    align-items: center;
    padding: 8px 16px;
    border-left: 4px solid transparent;
    transition: all 0.2s ease;
    min-height: 48px;
    gap: 12px;
}

.diff-file-line:hover {
    filter: brightness(0.95);
}

.diff-file-prefix {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    font-weight: bold;
    font-size: 18px;
    flex-shrink: 0;
}

.diff-file-icon {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
    border-radius: 4px;
    object-fit: contain;
}

.diff-file-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.diff-file-path {
    font-size: 11px;
    color: var(--text-tertiary);
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.diff-file-title {
    font-size: 14px;
    color: var(--text-primary);
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.diff-file-meta {
    font-size: 11px;
    color: var(--text-tertiary);
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
}

.diff-file-meta-label {
    font-weight: 600;
    margin-right: 4px;
}

.diff-file-meta-value {
    opacity: 0.8;
}

.diff-file-url {
    font-size: 12px;
    color: var(--text-secondary);
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 300px;
    flex-shrink: 0;
}

/* 添加状态 */
.diff-file-line.added {
    background-color: rgba(40, 167, 69, 0.08);
    border-left-color: #28a745;
}

.diff-file-line.added .diff-file-prefix {
    color: #28a745;
}

.diff-file-line.added .diff-file-title {
    color: #1e7e34;
}

/* 删除状态 */
.diff-file-line.deleted {
    background-color: rgba(220, 53, 69, 0.08);
    border-left-color: #dc3545;
}

.diff-file-line.deleted .diff-file-prefix {
    color: #dc3545;
}

.diff-file-line.deleted .diff-file-title {
    color: #bd2130;
}

/* 修改状态 */
.diff-file-line.modified {
    background-color: rgba(255, 193, 7, 0.08);
    border-left-color: #ffc107;
}

.diff-file-line.modified .diff-file-prefix {
    color: #ff9800;
}

.diff-file-line.modified .diff-file-title {
    color: #e68a00;
}

/* 移动状态 */
.diff-file-line.moved {
    background-color: rgba(111, 66, 193, 0.08);
    border-left-color: #6f42c1;
}

.diff-file-line.moved .diff-file-prefix {
    color: #6f42c1;
}

.diff-file-line.moved .diff-file-title {
    color: #5a32a3;
}

/* 深色模式适配 */
[data-theme="dark"] .diff-file-line.added {
    background-color: rgba(40, 167, 69, 0.12);
}

[data-theme="dark"] .diff-file-line.added .diff-file-title {
    color: #4caf50;
}

[data-theme="dark"] .diff-file-line.deleted {
    background-color: rgba(220, 53, 69, 0.12);
}

[data-theme="dark"] .diff-file-line.deleted .diff-file-title {
    color: #f44336;
}

[data-theme="dark"] .diff-file-line.modified {
    background-color: rgba(255, 193, 7, 0.12);
}

[data-theme="dark"] .diff-file-line.modified .diff-file-title {
    color: #ffb74d;
}

[data-theme="dark"] .diff-file-line.moved {
    background-color: rgba(111, 66, 193, 0.12);
}

[data-theme="dark"] .diff-file-line.moved .diff-file-title {
    color: #9575cd;
}

/* 响应式 */
@media (max-width: 768px) {
    .diff-file-line {
        flex-wrap: wrap;
        min-height: auto;
    }

    .diff-file-url {
        width: 100%;
        max-width: 100%;
        margin-top: 4px;
        padding-left: 36px;
    }
}

/* 卡片头部 */
.change-card-header {
    padding: 16px 20px;
    background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    gap: 12px;
}

.change-card-header .change-icon {
    font-size: 20px;
}

.change-card.quantity-change .change-icon {
    color: #28a745;
}

.change-card.structure-change .change-icon {
    color: #6f42c1;
}

.change-card-header .change-title {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
}

/* 卡片主体 */
.change-card-body {
    padding: 16px 20px;
}

.change-summary {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 6px;
}

.change-details {
    font-size: 14px;
    color: var(--text-secondary);
    line-height: 1.6;
}

.change-list {
    margin: 8px 0 0 16px;
    padding: 0;
    list-style: disc;
    color: var(--text-secondary);
    font-size: 13px;
    line-height: 1.6;
}

/* 变化项 */
.change-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px;
    margin: 8px 0;
    background: var(--bg-primary);
    border-radius: 8px;
    transition: all 0.2s ease;
}

.change-item:hover {
    background: var(--bg-tertiary, var(--bg-secondary));
    transform: translateX(4px);
}

.change-item:first-child {
    margin-top: 0;
}

.change-item:last-child {
    margin-bottom: 0;
}

/* 变化标签 */
.change-item .change-label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: var(--text-secondary);
}

.change-item .change-label i {
    font-size: 14px;
    color: var(--text-tertiary);
}

/* 变化值 - 数量变化 */
.change-item .change-value {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 20px;
    font-weight: 700;
}

.change-item.positive .change-value {
    color: #28a745;
}

.change-item.negative .change-value {
    color: #dc3545;
}

.change-item .change-value i {
    font-size: 16px;
}

/* 变化计数 - 结构变化 */
.change-item .change-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    height: 24px;
    padding: 0 8px;
    background: var(--accent-color, #6f42c1);
    color: white;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
}

.change-card.structure-change .change-item .change-label i {
    color: #6f42c1;
}

/* 空状态 */
.change-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 24px;
    text-align: center;
    color: var(--text-tertiary);
    font-size: 14px;
}

.change-empty i {
    font-size: 32px;
    margin-bottom: 8px;
    opacity: 0.5;
}

.change-empty span {
    font-style: italic;
}

/* 响应式：在小屏幕上垂直堆叠 */
@media (max-width: 768px) {
    .changes-grid {
        grid-template-columns: 1fr;
        gap: 16px;
    }

    .change-card-header {
        padding: 14px 16px;
    }

    .change-card-body {
        padding: 12px 16px;
    }

    .change-item {
        padding: 10px;
    }
}

/* ==================== 右键菜单样式 ==================== */

.bookmark-context-menu {
    position: relative;
    z-index: 10000;
    background: var(--bg-elevated);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
    min-width: 200px;
    max-width: 250px;
    padding: 6px 0;
    font-size: 13px;
    margin-left: 20px;
    margin-top: 5px;
    margin-bottom: 5px;
}

/* 禁用超链接右键菜单的所有浏览器默认tooltip */
.bookmark-context-menu .context-menu-item[title]::before {
    content: '' !important;
}

.bookmark-context-menu .context-menu-item[title]:hover::after {
    content: none !important;
    display: none !important;
}

[data-theme="dark"] .bookmark-context-menu {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
}

.context-menu-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 16px;
    cursor: pointer;
    color: var(--text-primary);
    transition: background-color 0.2s;
    user-select: none;
}

.context-menu-item:hover {
    background: var(--bg-secondary);
}

.context-menu-item.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.context-menu-item.disabled:hover {
    background: transparent;
}

.context-menu-item i {
    width: 16px;
    text-align: center;
    color: var(--text-secondary);
}

.context-menu-separator {
    height: 1px;
    background: var(--border-color);
    margin: 6px 0;
}

/* ==================== 右键菜单横向布局 - 按钮并排 ==================== */

.bookmark-context-menu.horizontal-layout {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    width: auto;
    max-width: min(95vw, 640px);
    /* 中文最大宽度：视口95%或640px，取较小值 */
    min-width: auto;
    overflow-x: visible;
    overflow-y: visible;
    padding: 8px;
    gap: 10px;
    /* 列间距 */
    row-gap: 16px;
    /* 行间距更大一些 */
    align-items: center;
    justify-content: flex-start;
}

/* 英文模式下横向布局更宽 */
.bookmark-context-menu.horizontal-layout.lang-en {
    max-width: min(95vw, 831px);
    /* 英文最大宽度：视口95%或800px，取较小值 */
}

/* ========== 纵向菜单（第一种形态）更紧凑：缩小按钮的上下内边距与分隔的上下间距 ==========
   仅作用于非横向形态，避免影响第二种形态（横向） */
.bookmark-context-menu:not(.horizontal-layout) .context-menu-item {
    padding-top: 5px;
    /* 原 10px → 5px，约减半 */
    padding-bottom: 5px;
}

.bookmark-context-menu:not(.horizontal-layout) .context-menu-separator {
    margin-top: 3px;
    /* 原 6px → 3px */
    margin-bottom: 3px;
}

/* 纵向菜单：短分隔线（宽度为标准分隔线的一半） */
.bookmark-context-menu:not(.horizontal-layout) .context-menu-separator.short {
    width: 50%;
    margin-left: 0;
    margin-right: auto;
}

.bookmark-context-menu.horizontal-layout .context-menu-item {
    flex: 0 0 auto;
    padding: 8px 12px;
    white-space: nowrap;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    border-radius: 6px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    cursor: pointer;
    transition: all 0.2s;
    margin: 0;
}

/* 选中的默认打开方式：蓝色高亮描边 */
.bookmark-context-menu .context-menu-item.selected-open {
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 2px var(--accent-light);
}

/* “Open/打开”标签样式：仅作为分组标题，不可点击 */
.bookmark-context-menu .context-menu-item.section-label {
    cursor: default;
    background: transparent;
    border: none;
    padding: 2px 6px;
    margin-right: 4px;
    color: var(--text-secondary);
    font-weight: 600;
}

.bookmark-context-menu .context-menu-item.section-label:hover {
    background: transparent;
}

.bookmark-context-menu .context-menu-item .context-menu-item-label {
    display: inline-flex;
    flex-direction: column;
    gap: 2px;
    align-items: flex-start;
}

.bookmark-context-menu .context-menu-item.swsg-option {
    min-width: 240px;
    align-items: flex-start;
    font-size: 0.9em;
    line-height: 1.25;
}

.bookmark-context-menu.horizontal-layout .context-menu-item.swsg-option {
    min-width: auto;
    align-items: center;
}

.bookmark-context-menu .context-menu-item .swsg-title {
    font-weight: 500;
    line-height: 1.15;
}

/* 仅中文：字号和字重与其他菜单项一致 */
.bookmark-context-menu .context-menu-item .swsg-title:not(.swsg-title-compact) {
    font-weight: normal;
    font-size: 1.111em;
}

.bookmark-context-menu:not(.horizontal-layout) .context-menu-item .swsg-title.swsg-title-compact {
    font-size: 0.92em;
}

.bookmark-context-menu .context-menu-item .swsg-badge-row {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

/* 右键菜单：次级提示徽标（New Group / New Window） */
.bookmark-context-menu .context-menu-item .sub-badge {
    display: inline-block;
    margin-left: 6px;
    padding: 1px 6px;
    border-radius: 10px;
    font-size: 11px;
    line-height: 1.6;
    background: var(--bg-tertiary, rgba(0, 0, 0, 0.06));
    color: var(--text-secondary);
}

[data-theme="dark"] .bookmark-context-menu .context-menu-item .sub-badge {
    background: rgba(255, 255, 255, 0.08);
}

.bookmark-context-menu .context-menu-item .sub-badge[data-sub-action] {
    cursor: pointer;
    user-select: none;
}

.bookmark-context-menu .context-menu-item .sub-badge[data-sub-action]:hover {
    background: var(--accent-light, rgba(0, 0, 0, 0.08));
    color: var(--accent-primary, var(--text-primary));
}

.bookmark-context-menu.horizontal-layout .context-menu-item:hover {
    background: var(--accent-light);
    border-color: var(--accent-primary);
}

.bookmark-context-menu.horizontal-layout .context-menu-separator {
    display: none;
    width: 0;
    height: 0;
}

/* 分组分隔符 - 隐藏 */
.bookmark-context-menu.horizontal-layout .context-menu-group-separator {
    display: inline-block;
    width: 1px;
    height: 26px;
    margin: 0 6px;
    background: var(--border-color);
    vertical-align: middle;
}

/* 分组容器（用于更好地控制间距）*/
.bookmark-context-menu.horizontal-layout .context-menu-group {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
    /* 纵向额外留白，确保行与行更明显 */
}

/* 横向布局的强制换行占位（用于指定行次） */
.bookmark-context-menu.horizontal-layout .context-menu-break {
    flex-basis: 100%;
    height: 0;
}

/* 相邻分组之间的分隔与内边距 */
.bookmark-context-menu.horizontal-layout .context-menu-group+.context-menu-group {
    border-left: none;
    padding-left: 0;
    margin-left: 12px;
}

/* section label 不应用 disabled 的半透明样式 */
.bookmark-context-menu .context-menu-item.section-label.disabled {
    opacity: 1;
    cursor: default;
}

/* 纵向布局：增加按钮行距 */


/* ==================== 自适应密度（根据容器宽度切换） ==================== */
.bookmark-context-menu.density-xs {
    font-size: 12px;
}

.bookmark-context-menu.density-xs.horizontal-layout {
    padding: 6px;
    gap: 6px;
}

.bookmark-context-menu.density-xs.horizontal-layout .context-menu-item {
    padding: 6px 10px;
    gap: 6px;
    border-radius: 6px;
}

.bookmark-context-menu.density-xs.horizontal-layout .context-menu-group+.context-menu-group {
    margin-left: 8px;
}

.bookmark-context-menu.density-sm {
    font-size: 12.5px;
}

.bookmark-context-menu.density-sm.horizontal-layout {
    padding: 8px;
    gap: 8px;
}

.bookmark-context-menu.density-sm.horizontal-layout .context-menu-item {
    padding: 7px 11px;
    gap: 7px;
    border-radius: 6px;
}

.bookmark-context-menu.density-sm.horizontal-layout .context-menu-group+.context-menu-group {
    margin-left: 10px;
}

.bookmark-context-menu.density-md {
    font-size: 13px;
}

.bookmark-context-menu.density-md.horizontal-layout {
    padding: 8px;
    gap: 10px;
}

.bookmark-context-menu.density-md.horizontal-layout .context-menu-item {
    padding: 8px 12px;
    gap: 8px;
    border-radius: 6px;
}

.bookmark-context-menu.density-md.horizontal-layout .context-menu-group+.context-menu-group {
    margin-left: 12px;
}

.bookmark-context-menu.density-lg {
    font-size: 13.5px;
}

.bookmark-context-menu.density-lg.horizontal-layout {
    padding: 10px;
    gap: 12px;
}

.bookmark-context-menu.density-lg.horizontal-layout .context-menu-item {
    padding: 10px 14px;
    gap: 10px;
    border-radius: 8px;
}

.bookmark-context-menu.density-lg.horizontal-layout .context-menu-group+.context-menu-group {
    margin-left: 16px;
}

/* ==================== 右键菜单按钮颜色样式 ==================== */

/* Select按钮 - 蓝色 */
.context-menu-item.color-blue {
    background: #2196F3;
    border-color: #1976D2;
    color: white;
}

.context-menu-item.color-blue i {
    color: white;
}

.context-menu-item.color-blue:hover {
    background: #1976D2;
    border-color: #1565C0;
}

[data-theme="dark"] .context-menu-item.color-blue {
    background: #2196F3;
    border-color: #42A5F5;
    color: white;
}

[data-theme="dark"] .context-menu-item.color-blue:hover {
    background: #42A5F5;
    border-color: #64B5F6;
}

/* Delete按钮 - 红色 */
.context-menu-item.color-red {
    background: #f44336;
    border-color: #d32f2f;
    color: white;
}

.context-menu-item.color-red i {
    color: white;
}

.context-menu-item.color-red:hover {
    background: #d32f2f;
    border-color: #c62828;
}

[data-theme="dark"] .context-menu-item.color-red {
    background: #f44336;
    border-color: #ef5350;
    color: white;
}

[data-theme="dark"] .context-menu-item.color-red:hover {
    background: #ef5350;
    border-color: #f44336;
}

/* ==================== 拖拽样式 ==================== */

.tree-item[draggable="true"] {
    /* 默认不显示十字光标，避免“选择时总出现拖动按钮”的体验问题 */
    cursor: default;
}

/* 仅在“点击按住”或正在拖动时显示移动光标 */
.tree-item[draggable="true"]:active,
.tree-item.dragging {
    cursor: move;
}

.tree-item.dragging {
    opacity: 0.5;
}

.tree-item.drag-over {
    background: var(--accent-light);
    border-radius: 4px;
}

[data-theme="dark"] .tree-item.drag-over {
    background: rgba(24, 119, 242, 0.2);
}

.drop-indicator {
    position: absolute;
    background: var(--accent-primary);
    pointer-events: auto;
    /* 改为auto以接收点击和右键事件 */
    z-index: 1000;
    border-radius: 1px;
    transition: opacity 0.1s ease-in-out;
}

/* 吸附提示闪烁动画 */
@keyframes dropIndicatorFlash {

    0%,
    100% {
        opacity: 1;
        box-shadow: 0 0 8px rgba(24, 119, 242, 0.8);
    }

    50% {
        opacity: 0.4;
        box-shadow: 0 0 4px rgba(24, 119, 242, 0.4);
    }
}

/* 应用闪烁效果的类 */
.drop-indicator.flashing {
    animation: dropIndicatorFlash 0.6s ease-in-out infinite;
    box-shadow: 0 0 8px rgba(24, 119, 242, 0.8);
}

/* 拖拽时禁止选择文本 */
.dragging-active {
    user-select: none;
}

/* ==================== 右键菜单和拖拽动画 ==================== */

@keyframes contextMenuFadeIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

.bookmark-context-menu {
    animation: contextMenuFadeIn 0.15s ease-out;
}

/* ==================== 树节点额外样式 ==================== */

.tree-item {
    position: relative;
}

/* 拖拽提示 */
.tree-item::after {
    content: '';
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 12px;
    background: linear-gradient(to bottom,
            var(--text-tertiary) 0px,
            var(--text-tertiary) 2px,
            transparent 2px,
            transparent 4px,
            var(--text-tertiary) 4px,
            var(--text-tertiary) 6px,
            transparent 6px,
            transparent 8px,
            var(--text-tertiary) 8px,
            var(--text-tertiary) 10px,
            transparent 10px,
            transparent 12px);
    opacity: 0;
    transition: opacity 0.2s;
}

.tree-item:hover::after {
    opacity: 0.3;
}

.tree-item.dragging::after {
    opacity: 0;
}

/* ==================== 剪切标记样式 ==================== */

.tree-item.cut-marked {
    opacity: 0.5;
    position: relative;
}

.tree-item.cut-marked::before {
    content: '✂';
    position: absolute;
    left: 4px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 12px;
    color: var(--warning);
}

.tree-item.cut-marked .tree-label {
    text-decoration: line-through;
}

/* ==================== 多选样式 ==================== */

.tree-item.selected {
    background: rgba(250, 204, 21, 0.22);
    border-left: 3px solid rgba(234, 179, 8, 0.95);
    padding-left: calc(12px - 3px);
    /* 补偿边框宽度 */
}

[data-theme="dark"] .tree-item.selected {
    background: rgba(250, 204, 21, 0.18);
}

.tree-item.selected .tree-label {
    font-weight: 500;
}

/* 多选计数器（可选，显示在页面顶部） */
.selection-counter {
    position: fixed;
    top: 60px;
    right: 20px;
    background: var(--accent-primary);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 500;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from {
        transform: translateX(100px);
        opacity: 0;
    }

    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.selection-counter .count {
    font-weight: 700;
}

.selection-counter .clear-btn {
    margin-left: 12px;
    cursor: pointer;
    opacity: 0.8;
    transition: opacity 0.2s;
}

.selection-counter .clear-btn:hover {
    opacity: 1;
}

/* ==================== 右键选中标识 ==================== */

.tree-item.context-selected {
    outline: 2px solid rgba(234, 179, 8, 0.95);
    outline-offset: -2px;
    background: rgba(250, 204, 21, 0.22);
    border-radius: 4px;
}

[data-theme="dark"] .tree-item.context-selected {
    background: rgba(250, 204, 21, 0.14);
}

/* 右键菜单定位 */
.bookmark-context-menu {
    /* 不强制relative，允许JS动态设置为fixed（批量菜单）或relative（常规菜单） */
    will-change: auto;
}

/* ==================== 批量操作工具栏 ==================== */

.batch-toolbar {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 15px;
    background: linear-gradient(135deg, var(--accent-light) 0%, rgba(24, 119, 242, 0.1) 100%);
    border: 1px solid var(--accent-primary);
    border-radius: 8px;
    margin: 15px 0;
    flex-wrap: wrap;
    animation: toolbarSlideIn 0.3s ease-out;
}

@keyframes toolbarSlideIn {
    from {
        transform: translateY(-10px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

[data-theme="dark"] .batch-toolbar {
    background: linear-gradient(135deg, rgba(24, 119, 242, 0.2) 0%, rgba(24, 119, 242, 0.05) 100%);
}

.selected-count {
    font-weight: 600;
    color: var(--accent-primary);
    font-size: 14px;
    padding: 4px 12px;
    background: white;
    border-radius: 16px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

[data-theme="dark"] .selected-count {
    background: rgba(255, 255, 255, 0.1);
    color: #e4e6eb;
    /* 使用浅色文字，确保在深色背景下可读 */
}

.batch-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 14px;
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-primary);
    transition: all 0.2s ease;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
}

.batch-btn:hover {
    background: var(--accent-primary);
    color: white;
    border-color: var(--accent-primary);
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(24, 119, 242, 0.3);
}

.batch-btn:active {
    transform: translateY(0);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
}

.batch-btn i {
    font-size: 12px;
}

[data-theme="dark"] .batch-btn {
    background: rgba(255, 255, 255, 0.05);
    color: var(--text-primary);
    border-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .batch-btn:hover {
    background: var(--accent-primary);
    color: white;
}

/* ==================== Select模式蓝框 ==================== */

.select-mode-overlay {
    position: absolute;
    inset: 0;
    border: 3px solid rgba(234, 179, 8, 0.95);
    border-radius: inherit;
    background: transparent;
    /* 移除淡蓝色蒙版，保持透明 */
    pointer-events: none;
    /* 仅作视觉提示，事件交由全局捕获处理（支持跨栏目/不阻塞滚动） */
    z-index: 100;
    animation: selectModeIn 0.3s ease-out;
}

@keyframes selectModeIn {
    from {
        opacity: 0;
        transform: scale(0.98);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

[data-theme="dark"] .select-mode-overlay {
    background: transparent;
    /* 暗色主题也保持透明 */
}

.select-mode-tip {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 24px;
    background: var(--accent-primary);
    color: white;
    border-radius: 24px;
    box-shadow: 0 4px 16px rgba(24, 119, 242, 0.4);
    font-size: 14px;
    font-weight: 500;
    pointer-events: auto;
    z-index: 10001;
    animation: tipSlideDown 0.3s ease-out;
}

@keyframes tipSlideDown {
    from {
        transform: translateX(-50%) translateY(-20px);
        opacity: 0;
    }

    to {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
    }
}

.select-mode-tip i {
    font-size: 16px;
}

.exit-select-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 16px;
    color: white;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.exit-select-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.05);
}

.exit-select-btn:active {
    transform: scale(0.98);
}

/* ==================== 工具栏样式更新 ==================== */

.batch-toolbar {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
}

/* 移除之前的独立样式，改为内联显示 */
.batch-toolbar .selected-count {
    font-size: 13px;
    margin-right: 4px;
}

.batch-toolbar .batch-btn {
    padding: 6px 12px;
    font-size: 12px;
}

/* 退出按钮特殊样式 - 红色 */
.batch-toolbar .exit-select-btn {
    background: #ff4444 !important;
    color: white !important;
    border-color: #cc0000 !important;
    margin-left: 12px;
}

.batch-toolbar .exit-select-btn:hover {
    background: #cc0000 !important;
    border-color: #990000 !important;
}

[data-theme="dark"] .batch-toolbar .exit-select-btn {
    background: #ff4444 !important;
    border-color: #cc0000 !important;
}

[data-theme="dark"] .batch-toolbar .exit-select-btn:hover {
    background: #cc0000 !important;
    border-color: #990000 !important;
}

/* ==================== 批量操作固定面板 ==================== */

.batch-action-panel {
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    width: 1000px;
    height: fit-content;
    /* 改为fit-content，完全贴合内容 */
    min-width: 150px;
    max-width: 95vw;
    max-height: 200px;
    background: rgba(248, 250, 252, 0.96) !important;
    backdrop-filter: blur(22px) saturate(125%) !important;
    -webkit-backdrop-filter: blur(22px) saturate(125%) !important;
    border: 1px solid rgba(148, 163, 184, 0.4);
    border-radius: 14px;
    box-shadow: 0 12px 40px rgba(15, 23, 42, 0.22);
    z-index: 99999;
    animation: panelFadeIn 0.25s ease-out;
    display: flex;
    flex-direction: column;
    resize: none;
    overflow: hidden;
    /* 改为hidden，避免内容溢出产生滚动条和空白 */
}

@keyframes panelFadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.batch-panel-header {
    position: relative;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    padding: 3px 8px;
    /* 更小的padding，极致紧凑 */
    background: rgba(37, 99, 235, 0.12) !important;
    backdrop-filter: blur(10px) !important;
    -webkit-backdrop-filter: blur(10px) !important;
    color: white;
    text-shadow: 0 1px 4px rgba(0, 0, 0, 1), 0 0 8px rgba(0, 0, 0, 0.8);
    border-radius: 10px 10px 0 0;
    flex-shrink: 0;
    min-height: 0;
    /* 移除最小高度 */
    line-height: 1;
    /* 紧凑行高 */
    user-select: none;
    cursor: grab;
}

.batch-panel-header:active {
    cursor: grabbing;
}

.batch-panel-title {
    font-weight: 600;
    font-size: 12px;
    /* 更小的字体 */
    margin-right: auto;
    line-height: 1.2;
    /* 紧凑行高 */
}

.batch-panel-count {
    font-size: 11px;
    /* 更小的字体 */
    padding: 2px 8px;
    /* 更小的padding */
    background: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    line-height: 1.2;
}

.batch-panel-exit-btn {
    background: rgba(244, 67, 54, 0.92);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.7);
    border-radius: 4px;
    padding: 2px 8px;
    /* 更小的padding */
    font-size: 11px;
    /* 更小的字体 */
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 2px;
    /* 更小的gap */
    transition: all 0.2s;
    font-weight: 500;
    line-height: 1.2;
}

.batch-panel-exit-btn:hover {
    background: rgba(244, 67, 54, 1);
    border-color: rgba(255, 255, 255, 0.8);
    transform: scale(1.05);
}

.batch-panel-exit-btn:active {
    transform: scale(0.98);
}

.batch-panel-exit-btn i {
    font-size: 13px;
}

.batch-panel-help-btn {
    width: 16px;
    height: 16px;
    border-radius: 999px;
    border: 1px solid rgba(148, 163, 184, 0.7);
    background: rgba(255, 255, 255, 0.22);
    color: rgba(255, 255, 255, 0.95);
    font-weight: 700;
    font-size: 10px;
    line-height: 1;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0;
}

.batch-panel-help-btn:hover {
    background: rgba(255, 255, 255, 0.32);
}


.batch-help-popover {
    position: fixed;
    left: 16px;
    top: 16px;
    width: 360px;
    z-index: 100000;
}

.batch-help-popover-inner {
    position: relative;
    background: rgba(37, 99, 235, 0.18);
    border: 1px solid rgba(96, 165, 250, 0.45);
    border-radius: 14px;
    box-shadow: 0 18px 56px rgba(15, 23, 42, 0.28);
    backdrop-filter: blur(18px) saturate(140%);
    -webkit-backdrop-filter: blur(18px) saturate(140%);
    color: rgba(255, 255, 255, 0.95);
    overflow: hidden;
}

.batch-help-popover-close {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 22px;
    height: 22px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.35);
    background: rgba(255, 255, 255, 0.16);
    color: rgba(255, 255, 255, 0.95);
    font-size: 16px;
    line-height: 1;
    cursor: pointer;
    padding: 0;
}

.batch-help-popover-body {
    padding: 12px 12px 12px 12px;
    font-size: 12px;
    line-height: 1.45;
}

.batch-help-card {
    margin-top: 10px;
    padding: 10px 10px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.22);
    background: rgba(255, 255, 255, 0.12);
}

.batch-help-card-title {
    display: flex;
    align-items: center;
    gap: 0;
    font-weight: 800;
    margin-bottom: 4px;
}

.batch-help-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    border-radius: 999px;
    margin-right: 8px;
    background: rgba(96, 165, 250, 0.9);
    color: rgba(15, 23, 42, 0.9);
    font-size: 11px;
    font-weight: 900;
    flex: 0 0 auto;
}

/* Numbers on batch buttons while help is open */
.batch-help-anchor {
    position: absolute;
    right: 28px;
    top: 50%;
    transform: translateY(-50%);
    width: 16px;
    height: 16px;
    border-radius: 999px;
    background: rgba(96, 165, 250, 0.18);
    border: 1px solid rgba(96, 165, 250, 0.55);
    color: rgba(96, 165, 250, 0.95);
    font-size: 11px;
    font-weight: 900;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
}


.batch-help-section-title {
    margin-top: 6px;
    font-weight: 700;
}

.batch-help-line {
    margin-top: 4px;
}

.batch-panel-content .context-menu-item,
.batch-toolbar .batch-btn {
    position: relative;
}

.batch-panel-content .context-menu-item.action-success::after {
    content: "\2713";
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%) scale(0.7);
    color: rgba(34, 197, 94, 0.95);
    font-weight: 900;
    opacity: 0;
    animation: batchActionTick 0.9s ease-out;
}

.batch-toolbar .batch-btn.action-success::after {
    content: "\2713";
    position: absolute;
    right: 8px;
    top: 50%;
    transform: translateY(-50%) scale(0.7);
    color: rgba(34, 197, 94, 0.95);
    font-weight: 900;
    opacity: 0;
    animation: batchActionTick 0.9s ease-out;
}

@keyframes batchActionTick {
    0% {
        opacity: 0;
        transform: translateY(-50%) scale(0.6);
    }

    18% {
        opacity: 1;
        transform: translateY(-50%) scale(1);
    }

    80% {
        opacity: 1;
        transform: translateY(-50%) scale(1);
    }

    100% {
        opacity: 0;
        transform: translateY(-50%) scale(0.9);
    }
}

[data-theme="dark"] .batch-menu-group {
    border-right-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .batch-group-label {
    color: rgba(255, 255, 255, 0.6);
    border-bottom-color: rgba(255, 255, 255, 0.1);
}

/* 调整大小句柄 - 四边和四角 */
.batch-panel-resize-handles {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 10002;
}

.resize-handle {
    position: absolute;
    pointer-events: auto !important;
    z-index: 10003 !important;
    background: transparent;
    transition: all 0.2s ease;
}

/* 四边 - 增加可拖动区域的宽度 */
.resize-n {
    top: -8px;
    left: 0;
    right: 0;
    height: 18px;
    cursor: ns-resize;
}

.resize-s {
    bottom: -8px;
    left: 0;
    right: 0;
    height: 18px;
    cursor: ns-resize;
}

.resize-w {
    left: -8px;
    top: 0;
    bottom: 0;
    width: 18px;
    cursor: ew-resize;
}

/* 【修复】右侧resize handle完全在栏目外部，避免与垂直滚动条冲突 */
.resize-e {
    right: -8px;
    top: 0;
    bottom: 0;
    width: 18px;
    cursor: ew-resize;
}

/* 四角 - 更大的可拖动区域 */
.resize-nw {
    top: -10px;
    left: -10px;
    width: 28px;
    height: 28px;
    cursor: nwse-resize;
    z-index: 10004 !important;
}

.resize-ne {
    top: -10px;
    right: -10px;
    width: 28px;
    height: 28px;
    cursor: nesw-resize;
    z-index: 10004 !important;
}

.resize-sw {
    bottom: -10px;
    left: -10px;
    width: 28px;
    height: 28px;
    cursor: nesw-resize;
    z-index: 10004 !important;
}

.resize-se {
    bottom: -10px;
    right: -10px;
    width: 28px;
    height: 28px;
    cursor: nwse-resize;
    z-index: 10004 !important;
}

/* 视觉提示 - 悬停时显示边框（极致扁平化） */
.resize-handle:hover {
    background: rgba(74, 144, 226, 0.05);
    border-radius: 8px;
    /* 与栏目一致 */
}

.resize-n:hover,
.resize-s:hover {
    border-top: 2px solid rgba(74, 144, 226, 0.25);
}

.resize-w:hover,
.resize-e:hover {
    border-left: 2px solid rgba(74, 144, 226, 0.25);
}

.resize-nw:hover,
.resize-ne:hover,
.resize-sw:hover,
.resize-se:hover {
    background: rgba(74, 144, 226, 0.08);
    border-radius: 12px;
    /* 角handle更大圆角 */
}

/* 永久栏目的resize handles - 保持12px圆角 */
.permanent-bookmark-section .resize-handle:hover {
    border-radius: 12px;
}

/* 右下角的可见调整大小指示器 */
.resize-se::after {
    content: '';
    position: absolute;
    bottom: 4px;
    right: 4px;
    width: 10px;
    height: 10px;
    background: linear-gradient(135deg,
            transparent 0%,
            transparent 46%,
            rgba(74, 144, 226, 0.4) 46%,
            rgba(74, 144, 226, 0.4) 50%,
            transparent 50%,
            transparent 96%,
            rgba(74, 144, 226, 0.4) 96%);
    background-size: 5px 5px;
    opacity: 0.6;
    transition: opacity 0.2s ease;
}

.resize-se:hover::after {
    opacity: 1;
}

/* 其他角落的指示器 */
.resize-nw::after,
.resize-ne::after,
.resize-sw::after {
    content: '';
    position: absolute;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: rgba(74, 144, 226, 0.3);
    opacity: 0;
    transition: opacity 0.2s ease;
}

.resize-nw::after {
    top: 4px;
    left: 4px;
}

.resize-ne::after {
    top: 4px;
    right: 4px;
}

.resize-sw::after {
    bottom: 4px;
    left: 4px;
}

.resize-nw:hover::after,
.resize-ne:hover::after,
.resize-sw:hover::after {
    opacity: 1;
}

[data-theme="dark"] .resize-se::after {
    background: linear-gradient(135deg,
            transparent 0%,
            transparent 46%,
            rgba(88, 166, 255, 0.5) 46%,
            rgba(88, 166, 255, 0.5) 50%,
            transparent 50%,
            transparent 96%,
            rgba(88, 166, 255, 0.5) 96%);
    background-size: 5px 5px;
}

[data-theme="dark"] .resize-nw::after,
[data-theme="dark"] .resize-ne::after,
[data-theme="dark"] .resize-sw::after {
    background: rgba(88, 166, 255, 0.4);
}

.batch-panel-content {
    padding: 8px;
    flex: 0 1 auto;
    /* 改为不自动增长，只根据内容大小 */
    overflow-y: auto;
    overflow-x: hidden;
    background: transparent;
}

.batch-panel-content .context-menu-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 14px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    color: var(--text-primary);
    background: rgba(255, 255, 255, 0.75) !important;
    border: 1px solid rgba(148, 163, 184, 0.24);
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
}

.batch-panel-content .context-menu-item:hover {
    background: rgba(226, 232, 240, 0.92) !important;
}

.batch-panel-content .context-menu-item i {
    width: 16px;
    font-size: 14px;
    color: var(--accent-primary);
}

/* 退出按钮红色样式 */
.batch-panel-content .context-menu-item.exit-item,
.batch-panel-content .context-menu-item[data-action="exit-select-mode"] {
    background: #ffebee;
    color: #c62828;
    border: 1px solid #ef5350;
}

.batch-panel-content .context-menu-item.exit-item:hover,
.batch-panel-content .context-menu-item[data-action="exit-select-mode"]:hover {
    background: #ffcdd2;
}

.batch-panel-content .context-menu-item.exit-item i,
.batch-panel-content .context-menu-item[data-action="exit-select-mode"] i {
    color: #c62828;
}

/* Delete action should be red text (panel) */
.batch-panel-content .context-menu-item[data-action="batch-delete"] {
    color: #c62828;
}

.batch-panel-content .context-menu-item[data-action="batch-delete"] i {
    color: #c62828;
}

[data-theme="dark"] .batch-panel-content .context-menu-item[data-action="batch-delete"] {
    color: #ff5252;
}

[data-theme="dark"] .batch-panel-content .context-menu-item[data-action="batch-delete"] i {
    color: #ff5252;
}

/* Delete action should be red text (toolbar) */
.batch-toolbar .batch-btn[data-action="batch-delete"] {
    color: #c62828;
    border-color: rgba(239, 83, 80, 0.35);
}

.batch-toolbar .batch-btn[data-action="batch-delete"] i {
    color: #c62828;
}

[data-theme="dark"] .batch-toolbar .batch-btn[data-action="batch-delete"] {
    color: #ff5252;
    border-color: rgba(255, 82, 82, 0.4);
}

[data-theme="dark"] .batch-toolbar .batch-btn[data-action="batch-delete"] i {
    color: #ff5252;
}

[data-theme="dark"] .batch-panel-content .context-menu-item.exit-item,
[data-theme="dark"] .batch-panel-content .context-menu-item[data-action="exit-select-mode"] {
    background: rgba(244, 67, 54, 0.15);
    color: #ff5252;
    border-color: #ff5252;
}

[data-theme="dark"] .batch-panel-content .context-menu-item.exit-item:hover,
[data-theme="dark"] .batch-panel-content .context-menu-item[data-action="exit-select-mode"]:hover {
    background: rgba(244, 67, 54, 0.25);
}

[data-theme="dark"] .batch-panel-content .context-menu-item.exit-item i,
[data-theme="dark"] .batch-panel-content .context-menu-item[data-action="exit-select-mode"] i {
    color: #ff5252;
}

.batch-panel-content .context-menu-separator {
    height: 1px;
    background: var(--border-color);
    margin: 4px 0;
}

[data-theme="dark"] .batch-action-panel {
    background: rgba(15, 23, 42, 0.84) !important;
    backdrop-filter: blur(26px) saturate(140%) !important;
    -webkit-backdrop-filter: blur(26px) saturate(140%) !important;
    border-color: rgba(59, 130, 246, 0.45);
    box-shadow: 0 18px 50px rgba(2, 6, 23, 0.6);
}

[data-theme="dark"] .batch-panel-header {
    background: rgba(59, 130, 246, 0.18) !important;
    backdrop-filter: blur(12px) !important;
    -webkit-backdrop-filter: blur(12px) !important;
}

[data-theme="dark"] .batch-panel-content .context-menu-item {
    background: rgba(30, 41, 59, 0.6) !important;
    backdrop-filter: blur(10px) !important;
    -webkit-backdrop-filter: blur(10px) !important;
    color: rgba(226, 232, 240, 0.95);
    border-color: rgba(96, 165, 250, 0.35);
}

[data-theme="dark"] .batch-panel-content .context-menu-item:hover {
    background: rgba(59, 130, 246, 0.24) !important;
}

/* 横向布局样式 - 默认一行显示 */
.batch-action-panel.horizontal-batch-layout {
    /* 移除 !important 和固定样式，允许JavaScript动态调整大小 */
    /* 这些值会被JavaScript在切换布局时设置 */
}

.batch-action-panel.horizontal-batch-layout .batch-panel-content {
    display: grid;
    grid-auto-flow: column;
    grid-template-rows: repeat(2, auto);
    gap: 6px;
    padding: 6px 8px;
    overflow-x: auto;
    overflow-y: hidden;
    align-items: start;
}

/* 横向布局：去掉分组容器的“块占位”，直接把按钮铺成两行 */
.batch-action-panel.horizontal-batch-layout .batch-menu-group,
.batch-action-panel.horizontal-batch-layout .batch-group-items {
    display: contents;
}

/* 横向布局：当高度较大时（>=200px），每个区域内按钮变为纵向排列，但区域之间仍可换行 */
.batch-action-panel.horizontal-batch-layout.tall-layout .batch-panel-content {
    flex-direction: row;
    /* 保持主容器横向，区域横向排列 */
    flex-wrap: wrap;
    /* 区域可以换行 */
    align-items: flex-start;
    /* 顶部对齐 */
    gap: 12px;
    /* 纵向布局时稍大的区域间距 */
}

.batch-action-panel.horizontal-batch-layout.tall-layout .batch-menu-group {
    flex-direction: column;
    /* 每个分组内部变为纵向 */
    border-right: 1px solid rgba(var(--border-color-rgb, 200, 200, 200), 0.3);
    /* 细边框 */
    padding-right: 12px;
    /* 纵向时稍大padding */
    flex: 1 1 auto;
    /* 允许区域自动增长 */
    min-width: 0;
    /* 允许收缩 */
}

.batch-action-panel.horizontal-batch-layout.tall-layout .batch-menu-group:last-child {
    border-right: none;
    padding-right: 0;
}

.batch-action-panel.horizontal-batch-layout.tall-layout .batch-group-items {
    flex-direction: column;
    /* 按钮组变为纵向 */
    gap: 4px;
    /* 纵向时稍大间距 */
    align-items: stretch;
    /* 按钮拉伸到组宽度 */
}

.batch-action-panel.horizontal-batch-layout.tall-layout .context-menu-item {
    width: 100%;
    /* 按钮占满分组宽度 */
    padding: 8px 12px;
    /* 纵向时稍大padding，更容易点击 */
    font-size: 13px;
    /* 纵向时稍大字体 */
}

.batch-action-panel.horizontal-batch-layout.tall-layout .context-menu-item i {
    font-size: 14px;
    /* 纵向时稍大图标 */
}

/* 分组样式 */
.batch-menu-group {
    display: flex;
    flex-direction: column;
    gap: 0;
    /* 移除间隙，让分组更紧凑 */
    padding-right: 8px;
    /* 紧凑的右padding */
    padding-top: 0;
    /* 移除上padding */
    padding-bottom: 0;
    /* 移除下padding，避免额外空白 */
    margin: 0;
    /* 移除所有margin，避免额外空白 */
    border-right: 1px solid rgba(var(--border-color-rgb, 200, 200, 200), 0.3);
    /* 更细的分隔线 */
    align-items: stretch;
    /* 子元素拉伸填充 */
    min-height: 0;
    /* 移除最小高度 */
    height: auto;
    /* 高度自适应内容 */
}

.batch-menu-group:last-child {
    border-right: none;
    padding-right: 0;
}

.batch-group-label {
    display: none;
    height: 0;
    /* 确保隐藏时不占空间 */
    margin: 0;
    padding: 0;
}

.batch-group-items {
    display: flex;
    flex-direction: row;
    gap: 2px;
    /* 极小的按钮间距，紧凑布局 */
    flex-wrap: wrap;
    /* 允许换行，根据宽度自适应 */
    min-height: 0;
    /* 移除默认最小高度，允许完全收缩 */
    margin: 0;
    /* 移除margin，避免额外空白 */
    padding: 0;
    /* 移除padding，避免额外空白 */
}

.batch-action-panel.horizontal-batch-layout .context-menu-item {
    flex: 0 0 auto;
    min-width: auto;
    min-height: 0;
    /* 移除最小高度 */
    height: auto;
    /* 高度自适应 */
    padding: 4px 8px;
    /* 更紧凑的padding */
    margin: 0;
    white-space: nowrap;
    font-size: 12px;
    line-height: 1.2;
    /* 紧凑的行高 */
}

.batch-action-panel.horizontal-batch-layout .context-menu-item i {
    font-size: 13px;
    line-height: 1.35;
}

.batch-action-panel.horizontal-batch-layout .context-menu-separator {
    display: none;
}

/* 纵向布局样式 */
.batch-action-panel.vertical-batch-layout {
    /* 移除 !important，允许JavaScript动态调整大小 */
    /* 这些值会被JavaScript在切换布局时设置 */
    max-height: 80vh;
}

.batch-action-panel.vertical-batch-layout .batch-panel-content {
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding: 8px;
    overflow-y: auto;
    overflow-x: hidden;
}

.batch-action-panel.vertical-batch-layout .batch-menu-group {
    flex-direction: column;
    border-right: none;
    border-bottom: 1px solid var(--border-color);
    padding-right: 0;
    padding-bottom: 8px;
    margin-bottom: 4px;
}

.batch-action-panel.vertical-batch-layout .batch-menu-group:last-child {
    border-bottom: none;
    padding-bottom: 0;
    margin-bottom: 0;
}

.batch-action-panel.vertical-batch-layout .batch-group-items {
    flex-direction: column;
    gap: 6px;
    flex-wrap: nowrap;
}

.batch-action-panel.vertical-batch-layout .context-menu-item {
    display: flex;
    width: 100%;
    padding: 10px 12px;
}

/* 纵向布局：避免为了文字撑宽面板 */
.batch-action-panel.vertical-batch-layout .context-menu-item span {
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.batch-action-panel.vertical-batch-layout .context-menu-separator {
    display: block;
}


/* ==================== 对照组补齐样式 ==================== */

.permanent-bookmark-section.drag-origin-active {
    border-color: rgba(16, 185, 129, 0.6);
    box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.06), 0 12px 30px rgba(16, 185, 129, 0.18);
}

.permanent-bookmark-section {
    --section-color: #10b981;
}

@keyframes dropTargetPulse {
    from {
        box-shadow: 0 0 0 0 rgba(66, 183, 42, 0.16), var(--shadow-lg);
    }

    to {
        box-shadow: 0 0 0 4px rgba(66, 183, 42, 0.2), var(--shadow-lg);
    }
}

.permanent-section-header {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    padding: 14px 18px;
    cursor: move;
    user-select: none;
    border-bottom: 1px solid rgba(16, 185, 129, 0.2);
    border-top-left-radius: 9px;
    border-top-right-radius: 9px;
    /* 外层 overflow:hidden 会自动裁剪圆角，无需单独设置 */
}

.permanent-section-header:hover {
    background: linear-gradient(135deg, #059669 0%, #10b981 100%);
}

.permanent-section-title {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 6px;
}

.permanent-section-title-left {
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 0;
    flex: 1;
}

.permanent-section-index-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 2px 6px;
    border-radius: 999px;
    font-size: 11px;
    line-height: 1;
    font-weight: 700;
    letter-spacing: 0.2px;
    background: rgba(255, 255, 255, 0.18);
    border: 1px solid rgba(255, 255, 255, 0.28);
    color: rgba(255, 255, 255, 0.95);
    flex: 0 0 auto;
}

.permanent-section-title h3 {
    margin: 0;
    font-size: 15px;
    font-weight: 600;
    letter-spacing: -0.2px;
    flex: 1;
}

.permanent-section-actions {
    display: flex;
    gap: 6px;
    align-items: center;
}

.permanent-section-action-btn {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    width: 26px;
    height: 26px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 0;
    font-size: 12px;
    transition: all 0.2s ease;
}

.permanent-section-action-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-1px);
}

.permanent-section-action-btn.pinned {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
}

/* 默认隐藏删除按钮：仅在“永久栏目副本”上显示 */
.permanent-section-remove-btn {
    display: none;
}

.permanent-bookmark-section.permanent-section-copy .permanent-section-remove-btn {
    display: flex;
}

.permanent-section-tip-container {
    display: flex;
    flex-direction: column;
    gap: 6px;
    margin-top: 6px;
    position: relative;
    width: 100%;
}

.permanent-section-tip-content {
    display: flex;
    align-items: center;
    gap: 4px;
}

.permanent-section-tip {
    margin: 0;
    font-size: 11px;
    opacity: 0.95;
    line-height: 1.4;
    flex: 1;
}

/* 永久栏目说明：复用 WYSIWYG 的 placeholder 机制 */
.permanent-section-tip.md-wysiwyg-editor:empty::before {
    color: rgba(255, 255, 255, 0.7);
}

/* 永久栏目 Markdown 渲染样式 */
.permanent-section-tip p {
    margin: 0;
    padding: 0;
}

.permanent-section-tip h1,
.permanent-section-tip h2,
.permanent-section-tip h3,
.permanent-section-tip h4,
.permanent-section-tip h5,
.permanent-section-tip h6 {
    margin: 4px 0;
    font-size: 11px;
    font-weight: 600;
}

.permanent-section-tip ul,
.permanent-section-tip ol {
    margin: 2px 0;
    padding-left: 16px;
}

.permanent-section-tip li {
    margin: 2px 0;
}

.permanent-section-tip code {
    background: rgba(255, 255, 255, 0.15);
    padding: 2px 4px;
    border-radius: 2px;
    font-family: 'Courier New', monospace;
    font-size: 10px;
}

.permanent-section-tip blockquote {
    margin: 4px 0;
    padding-left: 8px;
    border-left: 2px solid rgba(255, 255, 255, 0.3);
}

.permanent-section-tip strong {
    font-weight: 600;
}

.permanent-section-tip em {
    font-style: italic;
}

/* 支持Obsidian风格的HTML标签（永久栏目说明） */
.permanent-section-tip font {
    /* font标签的color属性会自动应用 */
}

.permanent-section-tip u {
    text-decoration: underline;
}

.permanent-section-tip b {
    font-weight: 600;
}

.permanent-section-tip i {
    font-style: italic;
}

.permanent-section-tip del,
.permanent-section-tip s {
    text-decoration: line-through;
}

.permanent-section-tip sub {
    vertical-align: sub;
    font-size: 0.8em;
}

.permanent-section-tip sup {
    vertical-align: super;
    font-size: 0.8em;
}

.permanent-section-tip mark {
    background: #fcd34d;
    color: #000000;
    padding: 0 2px;
    border-radius: 2px;
}

.permanent-section-tip a {
    color: #93c5fd;
    text-decoration: none;
    border-bottom: 1px solid rgba(147, 197, 253, 0.4);
    cursor: pointer;
    /* 使用伪元素扩大点击区域，不影响视觉效果 */
    position: relative;
    /* 确保链接始终可以接收鼠标事件（右键菜单、点击跳转） */
    pointer-events: auto;
}

/* 使用::before伪元素扩大点击区域 */
.permanent-section-tip a::before {
    content: '';
    position: absolute;
    top: -4px;
    left: -4px;
    right: -4px;
    bottom: -4px;
}

.permanent-section-tip a:hover {
    border-bottom-color: rgba(147, 197, 253, 0.7);
}

/* 任务列表样式（永久栏目说明） */
.permanent-section-tip input[type="checkbox"] {
    margin-right: 6px;
    cursor: pointer;
}

.permanent-section-tip-controls {
    display: flex;
    align-items: center;
    gap: 2px;
    position: relative;
}

.permanent-section-tip-edit-btn {
    background: rgba(255, 255, 255, 0.25);
    border: none;
    color: white;
    width: 16px;
    height: 16px;
    border-radius: 3px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 0;
    font-size: 10px;
    transition: all 0.2s ease;
    opacity: 0;
    pointer-events: none;
}

.permanent-section-tip-format-btn {
    background: rgba(255, 255, 255, 0.25);
    border: none;
    color: white;
    width: 16px;
    height: 16px;
    border-radius: 3px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 0;
    font-size: 10px;
    transition: all 0.2s ease;
    opacity: 0;
    pointer-events: none;
}

.permanent-section-tip-close {
    background: rgba(255, 255, 255, 0.25);
    border: none;
    color: white;
    width: 16px;
    height: 16px;
    border-radius: 3px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 0;
    font-size: 10px;
    transition: all 0.2s ease;
    opacity: 0;
    pointer-events: none;
}

/* hover在容器上时显示编辑和关闭按钮 */
.permanent-section-tip-container:hover .permanent-section-tip-edit-btn,
.permanent-section-tip-container:hover .permanent-section-tip-format-btn,
.permanent-section-tip-container:hover .permanent-section-tip-close {
    opacity: 1;
    pointer-events: auto;
}

.permanent-section-tip-container.editing .permanent-section-tip-edit-btn,
.permanent-section-tip-container.editing .permanent-section-tip-format-btn,
.permanent-section-tip-container.editing .permanent-section-tip-close {
    opacity: 1;
    pointer-events: auto;
}

.permanent-section-tip-edit-btn:hover,
.permanent-section-tip-format-btn:hover,
.permanent-section-tip-close:hover {
    background: rgba(255, 255, 255, 0.4);
    transform: scale(1.15);
}

.permanent-section-tip-edit-btn:active,
.permanent-section-tip-format-btn:active,
.permanent-section-tip-close:active {
    transform: scale(0.9);
}

.permanent-section-tip-container.editing .permanent-section-tip {
    padding: 8px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    font-size: 11px;
    font-family: inherit;
    line-height: 1.4;
    min-height: 50px;
    max-height: 120px;
    overflow: auto;
    transition: all 0.2s ease;
}

.permanent-section-tip-container.editing .permanent-section-tip:focus {
    outline: none;
    background: rgba(255, 255, 255, 0.15);
    border-color: rgba(255, 255, 255, 0.5);
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
}

.permanent-section-tip-editor {
    width: 100%;
    padding: 8px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    font-size: 11px;
    font-family: inherit;
    line-height: 1.4;
    resize: vertical;
    min-height: 50px;
    max-height: 100px;
    transition: all 0.2s ease;
}

.permanent-section-tip-editor:focus {
    outline: none;
    background: rgba(255, 255, 255, 0.15);
    border-color: rgba(255, 255, 255, 0.5);
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
}

[data-theme="dark"] .permanent-section-tip-edit-btn {
    opacity: 0;
    pointer-events: none;
}

[data-theme="dark"] .permanent-section-tip-format-btn {
    opacity: 0;
    pointer-events: none;
}

[data-theme="dark"] .permanent-section-tip-close {
    background: rgba(255, 255, 255, 0.2);
}

[data-theme="dark"] .permanent-section-tip-edit-btn:hover,
[data-theme="dark"] .permanent-section-tip-format-btn:hover,
[data-theme="dark"] .permanent-section-tip-close:hover {
    background: rgba(255, 255, 255, 0.35);
}

[data-theme="dark"] .permanent-section-tip-container.editing .permanent-section-tip {
    background: rgba(0, 0, 0, 0.3);
    color: rgba(255, 255, 255, 0.8);
    border-color: rgba(255, 255, 255, 0.25);
}

[data-theme="dark"] .permanent-section-tip-container.editing .permanent-section-tip:focus {
    outline: none;
    background: rgba(0, 0, 0, 0.5);
    border-color: rgba(255, 255, 255, 0.4);
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.15);
}

[data-theme="dark"] .permanent-section-tip-editor {
    background: rgba(0, 0, 0, 0.3);
    color: rgba(255, 255, 255, 0.8);
    border-color: rgba(255, 255, 255, 0.25);
}

[data-theme="dark"] .permanent-section-tip-editor:focus {
    outline: none;
    background: rgba(0, 0, 0, 0.5);
    border-color: rgba(255, 255, 255, 0.4);
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.15);
}

.permanent-section-body {
    padding: 16px;
    flex: 1;
    /* 填充剩余空间 */
    overflow-y: auto;
    /* 滚动条在这里，跟随栏目窗口大小 */
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    border-bottom-left-radius: 9px;
    border-bottom-right-radius: 9px;
    /* 外层 overflow:hidden 会自动裁剪圆角，无需单独设置 */
    /* 背景色填充整个区域 */
    background: var(--bg-elevated);
}

/* 永久栏目内的书签树样式调整 */
.permanent-bookmark-section .bookmark-tree {
    /* 继承原有的bookmark-tree样式，不需要额外padding */
    flex: 1;
    /* 填充父容器 */
    overflow: visible;
    /* 让内容自然扩展 */
}

/* 永久栏目：折叠提示的小栏 UI */
.permanent-section-tip-collapsed {
    display: none;
    align-items: center;
    gap: 6px;
    padding: 6px 8px;
    border-radius: 4px;
    background: rgba(0, 0, 0, 0.05);
    color: rgba(0, 0, 0, 0.6);
    font-size: 11px;
    cursor: pointer;
    user-select: none;
    transition: background 0.2s ease, color 0.2s ease;
}

.permanent-section-tip-collapsed:hover {
    background: rgba(0, 0, 0, 0.08);
    color: rgba(0, 0, 0, 0.8);
}

[data-theme="dark"] .permanent-section-tip-collapsed {
    background: rgba(255, 255, 255, 0.06);
    color: rgba(255, 255, 255, 0.6);
}

[data-theme="dark"] .permanent-section-tip-collapsed:hover {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.8);
}

.permanent-section-tip-container.collapsed .permanent-section-tip-content,
.permanent-section-tip-container.collapsed .permanent-section-tip-editor {
    display: none !important;
}

.permanent-section-tip-container.collapsed .permanent-section-tip-collapsed {
    display: flex;
}

/* 永久栏目滚动条样式 */
.permanent-section-body::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}

.permanent-section-body::-webkit-scrollbar-track {
    background: var(--bg-tertiary);
    border-radius: 6px;
}

.permanent-section-body::-webkit-scrollbar-thumb {
    background: var(--border-hover);
    border-radius: 6px;
    border: 2px solid var(--bg-tertiary);
}

.permanent-section-body::-webkit-scrollbar-thumb:hover {
    background: var(--text-tertiary);
}

/* 永久栏目书签树连线与图标对齐（来自 canvas_obsidian_style.css 的共用部分） */
.permanent-section-body .tree-children {
    position: relative;
    --tree-toggle-center: 16px;
    --tree-children-indent: 12px;
    margin-left: var(--tree-toggle-center);
    padding-left: var(--tree-children-indent);
    border-left: 1px solid var(--border-color);
}

.permanent-section-body .tree-children > .tree-node {
    position: relative;
}

.permanent-section-body .tree-children > .tree-node > .tree-item {
    position: relative;
}

.permanent-section-body .tree-children > .tree-node > .tree-item::before {
    content: '';
    position: absolute;
    left: calc(-1 * var(--tree-children-indent));
    top: 50%;
    width: calc(var(--tree-children-indent) + var(--tree-toggle-center));
    height: 1px;
    transform: translateY(-50%);
    background: var(--border-color);
    pointer-events: none;
}

[data-theme="dark"] .permanent-section-body .tree-children {
    border-left-color: #3a3b3c;
}

[data-theme="dark"] .permanent-section-body .tree-children > .tree-node > .tree-item::before {
    background: #3a3b3c;
}

.permanent-section-body i.fas.fa-folder,
.permanent-section-body i.fas.fa-folder-open {
    color: var(--accent-primary) !important;
    font-size: 15px !important;
}

.permanent-section-body .tree-item .tree-icon {
    vertical-align: middle;
    position: relative;
    top: 0;
}

/* "加载更多"按钮样式（树懒加载） */
.tree-load-more {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    margin: 4px 0 4px 20px;
    font-size: 12px;
    color: var(--accent-primary, #2563eb);
    background: var(--bg-secondary, #f9fafb);
    border: 1px dashed var(--border-color, #e5e7eb);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.15s ease;
    user-select: none;
}

.tree-load-more:hover {
    background: var(--accent-primary-light, #eff6ff);
    border-color: var(--accent-primary, #2563eb);
    transform: translateX(2px);
}

.tree-load-more i {
    font-size: 10px;
    opacity: 0.7;
}

[data-theme="dark"] .tree-load-more {
    background: #1f2937;
    border-color: #374151;
    color: #60a5fa;
}

[data-theme="dark"] .tree-load-more:hover {
    background: #1e3a5f;
    border-color: #60a5fa;
}

.md-wikilink {
    color: #2563eb;
    font-weight: 600;
    cursor: default;
    border-bottom: 1px dashed rgba(37, 99, 235, 0.4);
}

[data-theme="dark"] .md-wikilink {
    color: #93c5fd;
    border-bottom-color: rgba(147, 197, 253, 0.5);
}

.md-callout {
    border-left: 4px solid #2563eb;
    background: rgba(37, 99, 235, 0.08);
    border-radius: 8px;
    padding: 8px 12px;
    margin: 8px 0;
    box-shadow: inset 0 0 0 1px rgba(37, 99, 235, 0.1);
}

.md-callout-header {
    display: flex;
    align-items: center;
    gap: 6px;
    font-weight: 600;
    margin-bottom: 6px;
}

.md-callout-body {
    font-weight: 400;
}

.md-callout.collapsed .md-callout-body {
    display: none;
}

.md-callout-toggle {
    width: 18px;
    height: 18px;
    border: 1px solid rgba(38, 38, 38, 0.2);
    border-radius: 50%;
    background: linear-gradient(to bottom, #fff, #f3f4f6);
    cursor: pointer;
    position: relative;
    opacity: 0;
    transform: translateX(-4px);
    pointer-events: none;
    transition: opacity 0.18s ease, transform 0.18s ease;
    margin-left: -2px;
    margin-right: 4px;
}

.md-callout-toggle::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 8px;
    height: 2px;
    background: #1f2937;
    transform: translate(-50%, -50%);
}

.md-callout:not(.collapsed) .md-callout-toggle::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 2px;
    height: 8px;
    background: #1f2937;
    transform: translate(-50%, -50%);
}

[data-theme="dark"] .md-callout-toggle {
    border-color: rgba(148, 163, 184, 0.4);
    background: linear-gradient(to bottom, #1f2937, #111827);
}

.md-callout:hover .md-callout-toggle,
.md-callout:focus-within .md-callout-toggle {
    opacity: 1;
    transform: translateX(0);
    pointer-events: auto;
}

[data-theme="dark"] .md-callout-toggle::after,
[data-theme="dark"] .md-callout-toggle::before {
    background: #f8fafc;
}

.md-callout-icon {
    font-size: 16px;
}

.md-callout-title {
    text-transform: capitalize;
}

.md-callout-tip {
    border-color: #14b8a6;
    background: rgba(20, 184, 166, 0.08);
    box-shadow: inset 0 0 0 1px rgba(20, 184, 166, 0.12);
}

.md-callout-warning {
    border-color: #f59e0b;
    background: rgba(245, 158, 11, 0.09);
    box-shadow: inset 0 0 0 1px rgba(245, 158, 11, 0.18);
}

.md-callout-danger {
    border-color: #ef4444;
    background: rgba(239, 68, 68, 0.08);
    box-shadow: inset 0 0 0 1px rgba(239, 68, 68, 0.15);
}

.md-callout-success {
    border-color: #22c55e;
    background: rgba(34, 197, 94, 0.08);
    box-shadow: inset 0 0 0 1px rgba(34, 197, 94, 0.12);
}

.md-callout-note,
.md-callout-info,
.md-callout-question,
.md-callout-example,
.md-callout-quote,
.md-callout-bug {
    border-color: rgba(37, 99, 235, 0.9);
    background: rgba(59, 130, 246, 0.08);
    box-shadow: inset 0 0 0 1px rgba(59, 130, 246, 0.15);
}

[data-theme="dark"] .md-callout {
    box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.2);
    background: rgba(148, 163, 184, 0.08);
}

.empty-state-small {
    padding: 20px;
    text-align: center;
    color: var(--text-tertiary);
    font-size: 13px;
}

/* ==================== 编辑书签弹窗 ==================== */
.edit-bookmark-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.edit-bookmark-field {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.edit-bookmark-field label {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
}

.edit-bookmark-input {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-size: 14px;
    transition: border-color 0.2s, box-shadow 0.2s;
    box-sizing: border-box;
}

.edit-bookmark-input:focus {
    outline: none;
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
}

.edit-bookmark-input::placeholder {
    color: var(--text-tertiary);
}

.edit-bookmark-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 8px;
    padding-top: 16px;
    border-top: 1px solid var(--border-color);
}

.modal-btn {
    padding: 8px 20px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
}

.modal-btn:hover {
    background: var(--bg-tertiary);
}

.modal-btn.primary {
    border: none;
    background: var(--accent-primary);
    color: white;
}

.modal-btn.primary:hover {
    background: var(--accent-hover);
}

.modal-btn.danger {
    border: none;
    background: var(--error);
    color: white;
}

.modal-btn.danger:hover {
    filter: brightness(0.95);
}

/* 刷新设置弹窗 */
.refresh-settings-modal .modal-body {
    padding: 16px 20px 12px;
}

.refresh-settings-section {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.refresh-setting-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 10px;
    background: var(--bg-secondary);
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s;
    font-size: 13px;
}

.refresh-settings-modal #refreshSettingsSaveBtn {
    padding: 6px 14px;
    font-size: 12px;
}

.refresh-setting-item:hover {
    background: var(--bg-tertiary);
}

.refresh-setting-item input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

.refresh-setting-item input[type="number"] {
    padding: 4px 8px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--bg-primary);
    color: var(--text-primary);
    text-align: center;
}

.refresh-setting-item input[type="number"]:focus {
    outline: none;
    border-color: var(--accent-primary);
}

/* 刷新设置弹窗特定样式 */
.refresh-settings-modal {
    max-width: 450px;
}

.modal-header.compact {
    padding: 10px 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.modal-header.compact h3 {
    margin: 0;
    margin-left: 8px;
    font-size: 17px;
}

/* ==================== 手动选择窗口+组选择器 ==================== */
.manual-selector-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100000;
    animation: fadeIn 0.2s ease-out;
}

.manual-selector-dialog {
    background: var(--bg-primary);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    width: 90%;
    max-width: 720px;
    max-height: 70vh;
    display: flex;
    flex-direction: column;
    animation: slideUp 0.3s ease-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.manual-selector-header {
    padding: 16px 20px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    flex-wrap: wrap;
}

.manual-selector-title {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
}

.manual-selector-close {
    background: none;
    border: none;
    font-size: 24px;
    color: var(--text-secondary);
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.2s;
}

.manual-selector-close:hover {
    background: var(--hover-bg);
    color: var(--text-primary);
}

.manual-selector-body {
    display: flex;
    flex: 1;
    overflow: hidden;
}

.manual-selector-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.manual-selector-panel + .manual-selector-panel {
    border-left: 1px solid var(--border-color);
}

.manual-selector-panel-title {
    padding: 12px 16px;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
}

.manual-selector-help-icon {
    color: var(--text-secondary);
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
    padding: 2px 4px;
    border-radius: 3px;
}

.manual-selector-help-icon:hover {
    color: var(--accent-primary);
    background: var(--accent-light);
}

/* 窗口帮助提示框 */
.manual-selector-help-tooltip {
    position: absolute;
    top: 38px;
    left: 50%;
    right: auto;
    transform: translateX(-50%);
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 10px 16px;
    width: 260px;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    z-index: 100001;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s, visibility 0.2s;
    pointer-events: auto;
    white-space: normal;
    text-align: center;
}

.manual-selector-help-tooltip::before {
    display: none;
}

.manual-selector-help-tooltip p {
    margin: 0;
    font-size: 11px;
    line-height: 1.5;
    color: var(--text-primary);
    text-align: center;
}

.manual-selector-help-tooltip p + p {
    margin-top: 6px;
}

.manual-selector-list {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 6px;
    /* 确保滚动流畅 */
    -webkit-overflow-scrolling: touch;
    /* 自定义滚动条样式 */
    scrollbar-width: thin;
    scrollbar-color: var(--accent-primary) var(--bg-secondary);
}

.manual-selector-list::-webkit-scrollbar {
    width: 8px;
}

.manual-selector-list::-webkit-scrollbar-track {
    background: var(--bg-secondary);
    border-radius: 4px;
}

.manual-selector-list::-webkit-scrollbar-thumb {
    background: var(--accent-primary);
    border-radius: 4px;
}

.manual-selector-list::-webkit-scrollbar-thumb:hover {
    background: var(--accent-hover);
}

.manual-selector-item {
    padding: 12px 14px;
    margin-bottom: 6px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
    border: 2px solid transparent;
    background: var(--bg-primary);
}

.manual-selector-item:hover {
    background: var(--hover-bg);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.manual-selector-item.selected {
    background: var(--accent-light);
    border-color: var(--accent-primary);
    box-shadow: 0 2px 8px rgba(var(--accent-primary-rgb), 0.2);
}

.manual-selector-item-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-primary);
    margin-bottom: 3px;
    flex: 1;
    word-break: break-all;
    hyphens: none;
    line-height: 1.4;
    min-width: 0;
}

.manual-selector-item-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 3px;
    gap: 8px;
}

.manual-selector-item-actions {
    display: flex;
    align-items: center;
    gap: 2px;
    opacity: 0;
    transition: opacity 0.2s;
}

.manual-selector-item:hover .manual-selector-item-actions {
    opacity: 1;
}

.manual-selector-edit-btn {
    background: none;
    border: none;
    color: var(--accent-primary);
    cursor: pointer;
    padding: 0;
    font-size: 12px;
    transition: all 0.2s;
    border-radius: 3px;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.manual-selector-edit-btn i {
    line-height: 1;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.manual-selector-edit-btn .fa-check {
    transform: translateY(-0.5px);
}

.manual-selector-edit-btn .fa-undo {
    font-size: 11px;
    transform: translateY(1px);
}

.manual-selector-edit-btn:hover {
    background: var(--accent-light);
}

.manual-selector-item-input {
    width: 100%;
    padding: 4px 8px;
    border: 1px solid var(--accent-primary);
    border-radius: 4px;
    background: var(--bg-primary);
    color: var(--text-primary);
    font-size: 13px;
    font-weight: 500;
}

.manual-selector-item-input:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--accent-light);
}

.manual-selector-item-badge {
    font-size: 9px;
    padding: 2px 5px;
    border-radius: 3px;
    background: var(--accent-primary);
    color: white;
}

.manual-selector-item-info {
    font-size: 11px;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
}

.manual-selector-item-meta {
    display: inline-flex;
    align-items: center;
    gap: 3px;
}

.manual-selector-item-meta i {
    font-size: 10px;
}

.manual-selector-empty {
    padding: 30px 16px;
    text-align: center;
    color: var(--text-secondary);
    font-size: 12px;
}

.manual-selector-footer {
    padding: 12px 18px;
    border-top: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    gap: 10px;
}

.manual-selector-btn {
    padding: 8px 16px;
    border-radius: 5px;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    border: none;
}

.manual-selector-btn-clear {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

.manual-selector-btn-clear:hover {
    background: var(--hover-bg);
}

.manual-selector-btn-confirm {
    background: var(--accent-primary);
    color: white;
    flex: 1;
}

.manual-selector-btn-confirm:hover {
    background: var(--accent-hover);
}

.manual-selector-btn-confirm:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

[data-theme="dark"] .manual-selector-dialog {
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
}

[data-theme="dark"] .manual-selector-item.selected {
    background: rgba(24, 119, 242, 0.2);
}

/* 批量选择器header中的h3标题 */
.manual-selector-header h3 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-primary);
    flex: 1;
    min-width: 0;
}

/* 书签计数标签 */
.manual-selector-count {
    font-size: 13px;
    color: var(--accent-primary);
    background: var(--accent-light);
    padding: 5px 12px;
    border-radius: 12px;
    font-weight: 600;
    white-space: nowrap;
}

/* 取消按钮 */
.manual-selector-btn-cancel {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
}

.manual-selector-btn-cancel:hover {
    background: var(--hover-bg);
    border-color: var(--text-secondary);
}

/* 标签组颜色指示器 */
.manual-selector-group-color {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 3px;
    margin-right: 8px;
    flex-shrink: 0;
}

.group-color-grey {
    background-color: #5f6368;
}

.group-color-blue {
    background-color: #1a73e8;
}

.group-color-red {
    background-color: #ea4335;
}

.group-color-yellow {
    background-color: #fbbc04;
}

.group-color-green {
    background-color: #34a853;
}

.group-color-pink {
    background-color: #e91e63;
}

.group-color-purple {
    background-color: #a142f4;
}

.group-color-cyan {
    background-color: #24c1e0;
}

.group-color-orange {
    background-color: #fa7b17;
}

/* 列表项名称样式 */
.manual-selector-item-name {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-primary);
    flex: 1;
}

/* 列表项信息样式 */
.manual-selector-item-info {
    font-size: 11px;
    color: var(--text-secondary);
    margin-left: auto;
}

/* 空提示样式 */
.manual-selector-empty {
    padding: 30px 16px;
    text-align: center;
    color: var(--text-secondary);
    font-size: 12px;
}

/* 面板内的列表容器 */
.manual-selector-panels {
    display: flex;
    flex: 1;
    overflow: hidden;
}

/* 头部右侧区域 */
.manual-selector-header-right {
    display: flex;
    align-items: center;
    gap: 14px;
    flex-shrink: 0;
}

/* 层级控制容器 */
.manual-selector-depth-control {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 6px 12px;
    background: var(--bg-secondary);
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

/* 复选框标签 */
.manual-selector-depth-checkbox {
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    font-size: 13px;
    color: var(--text-primary);
    user-select: none;
    font-weight: 500;
}

.manual-selector-depth-checkbox input[type="checkbox"] {
    width: 15px;
    height: 15px;
    cursor: pointer;
    accent-color: var(--accent-primary);
}

.manual-selector-depth-checkbox span {
    white-space: nowrap;
}

/* 层级选择下拉框 */
.manual-selector-depth-select {
    padding: 5px 10px;
    font-size: 12px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--bg-primary);
    color: var(--text-primary);
    cursor: pointer;
    min-width: 90px;
    font-weight: 500;
}

.manual-selector-depth-select:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    background: var(--bg-tertiary);
}

.manual-selector-depth-select:not(:disabled):hover {
    border-color: var(--accent-primary);
}

.manual-selector-depth-select:not(:disabled):focus {
    outline: none;
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 2px var(--accent-light);
}

/* 面板提示文字 */
.manual-selector-panel-hint {
    font-size: 10px;
    color: var(--text-tertiary);
    font-weight: normal;
    margin-left: 6px;
}

/* 窗口序号标签 */
.manual-selector-window-index {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 20px;
    height: 20px;
    padding: 0 6px;
    background: var(--accent-primary);
    color: white;
    border-radius: 10px;
    font-size: 11px;
    font-weight: 600;
    margin-right: 8px;
}

/* 特色功能说明区域 */
.manual-selector-features {
    padding: 12px 16px;
    background: linear-gradient(135deg, var(--accent-light) 0%, var(--bg-secondary) 100%);
    border-top: 1px solid var(--border-color);
}

.manual-selector-features-title {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    font-weight: 600;
    color: var(--accent-primary);
    margin-bottom: 10px;
}

.manual-selector-features-title i {
    color: #f59e0b;
    font-size: 14px;
}

.manual-selector-features-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px 16px;
}

.manual-selector-feature-item {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    font-size: 11px;
    color: var(--text-secondary);
    line-height: 1.4;
}

.manual-selector-feature-item i {
    color: var(--accent-primary);
    font-size: 12px;
    margin-top: 2px;
    flex-shrink: 0;
}

.manual-selector-feature-item span {
    flex: 1;
}

@media (max-width: 600px) {
    .manual-selector-features-grid {
        grid-template-columns: 1fr;
    }
}

[data-theme="dark"] .manual-selector-depth-control {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .manual-selector-depth-select {
    background: var(--bg-secondary);
    border-color: rgba(255, 255, 255, 0.15);
}

[data-theme="dark"] .manual-selector-depth-select:disabled {
    background: rgba(255, 255, 255, 0.03);
}

/* 表格容器样式 */
.global-export-table-container {
    border: 1px solid var(--border-color);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

/* 表格头部样式 */
#globalExportTable thead {
    background: var(--bg-secondary);
    border-bottom: 2px solid var(--border-color);
}

#globalExportTable th {
    font-weight: 600;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-size: 12px;
    padding: 12px 10px;
}

/* 表格行样式 */
#globalExportTable tbody tr {
    transition: background 0.15s ease;
    border-bottom: 1px solid var(--border-color);
}

#globalExportTable tbody tr:hover {
    background: var(--bg-tertiary);
}

#globalExportTable td {
    padding: 12px 10px;
    color: var(--text-primary);
    font-size: 13px;
    vertical-align: middle;
}

/* 下拉框自定义样式 */
.global-export-mode-select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-color: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 6px 24px 6px 10px;
    font-size: 12px;
    color: var(--text-primary);
    cursor: pointer;
    transition: all 0.2s;
    background-image: url(\"data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M7%2010l5%205%205-5z%22%20fill%3D%22%23999%22%2F%3E%3C%2Fsvg%3E\");
    background-repeat: no-repeat;
    background-position: right 4px center;
    min-width: 90px;
}

.global-export-mode-select:hover {
    border-color: var(--accent-primary);
    background-color: var(--bg-primary);
}

.global-export-mode-select:focus {
    outline: none;
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 2px var(--accent-light);
}

/* 导出按钮优化 */
#globalExportConfirmBtn {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-hover));
    box-shadow: 0 2px 6px rgba(var(--accent-rgb), 0.3);
    border: none;
    font-weight: 600;
}

#globalExportConfirmBtn:hover {
    box-shadow: 0 4px 12px rgba(var(--accent-rgb), 0.4);
    transform: translateY(-1px);
}

#globalExportConfirmBtn:disabled {
    background: var(--bg-tertiary);
    color: var(--text-tertiary);
    box-shadow: none;
    transform: none;
    cursor: not-allowed;
}

/* ==================== 历史记录视图头部优化 ==================== */

/* 控制区域容器 */
.view-header-right {
    display: flex;
    align-items: center;
    gap: 12px;
    /* 统一间距 */
}

/* 统一 Action Button 样式 */
.action-btn {
    width: 32px;
    height: 32px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    /* 统一圆角 */
    background: var(--bg-secondary);
    color: var(--text-primary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    position: relative;
    /* 用于定位 tooltip */
}

.action-btn:hover {
    background: var(--bg-tertiary);
    border-color: var(--border-hover);
    color: var(--text-primary);
}

.action-btn i {
    font-size: 14px;
    /* 统一图标大小 */
    color: var(--text-secondary);
}

.action-btn:hover i {
    color: var(--text-primary);
}

/* 红色删除按钮特殊样式 */
#clearBackupHistoryBtn:hover {
    background: var(--error-light);
    border-color: var(--error);
}

#clearBackupHistoryBtn:hover i {
    color: var(--error);
}

/* 切换按钮组容器 */
.toggle-btn-group {
    display: flex;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 2px;
    gap: 2px;
}

/* 切换按钮样式 */
.toggle-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    font-size: 13px;
    font-weight: 500;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    height: 28px;
    /* 固定高度，确保对齐 */
    position: relative;
    /* 用于 tooltip */
}

.toggle-btn i,
.toggle-btn svg {
    font-size: 13px;
    width: 14px;
    height: 14px;
    fill: currentColor;
}

.toggle-btn:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

.toggle-btn.active {
    background: var(--bg-primary);
    color: var(--accent-primary);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    font-weight: 600;
}

/* Tooltip 支持 (复用 .btn-tooltip) */
.action-btn:hover .btn-tooltip,
.toggle-btn:hover .btn-tooltip {
    visibility: visible;
    opacity: 1;
    transform: translateX(-50%) translateY(4px);
    /* 微调位置动画 */
}

/* 修正 tooltip 初始位置 */
.btn-tooltip {
    top: 100%;
    margin-top: 6px;
}

/* ==================== 全局导出表格 Toggle 按钮样式 ==================== */

/* 覆盖 .toggle-btn-group 在表格中的样式 */
#globalExportTable .toggle-btn-group {
    background: transparent;
    border: none;
    padding: 0;
    gap: 4px;
}

#globalExportTable .toggle-btn {
    width: 32px;
    height: 32px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--bg-secondary);
    color: var(--text-tertiary);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    transition: all 0.2s ease;
}

#globalExportTable .toggle-btn i,
#globalExportTable .toggle-btn svg {
    width: 16px;
    height: 16px;
    fill: currentColor;
    font-size: 14px;
}

#globalExportTable .toggle-btn:hover {
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    border-color: var(--border-hover);
}

#globalExportTable .toggle-btn.active {
    background: var(--bg-primary);
    color: var(--accent-primary);
    border-color: var(--accent-primary);
    box-shadow: 0 1px 3px rgba(var(--accent-rgb), 0.15);
}

#globalExportTable .toggle-btn.active svg {
    fill: var(--accent-primary);
}

/* 移除 .toggle-btn 默认 tooltip (如果已经在 HTML 中内联定义 title) */
/* 为了更干净的界面，可以自定义 tooltip */
#globalExportTable .toggle-btn::after {
    /* 简单的 CSS tooltip 也许就够了，或者依赖 title 属性的 browser native tooltip */
}

/* ==================== 视图模式切换按钮优化 ==================== */
#globalExportTable .toggle-btn-group {
    background: transparent;
    border: none;
    padding: 0;
    gap: 8px;
    /* 增加间距 */
}

#globalExportTable .toggle-btn {
    width: 28px;
    /* 稍微调小尺寸，适应表格 */
    height: 28px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background: var(--bg-secondary);
    color: var(--text-tertiary);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    transition: all 0.2s ease;
    position: relative;
    /* 为 tooltip定位 */
}

#globalExportTable .toggle-btn i,
#globalExportTable .toggle-btn svg {
    width: 14px;
    height: 14px;
    fill: currentColor;
}

/* 激活状态 */
#globalExportTable .toggle-btn.active {
    background: var(--bg-primary);
    color: var(--accent-primary);
    border-color: var(--accent-primary);
    box-shadow: 0 1px 3px rgba(var(--accent-rgb), 0.15);
}

/* Tooltip 下方显示 */
#globalExportTable .toggle-btn::after {
    content: attr(title);
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    margin-top: 6px;
    /* 距离按钮的距离 */
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 11px;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s;
    pointer-events: none;
    z-index: 10;
}

#globalExportTable .toggle-btn:hover::after {
    opacity: 1;
    visibility: visible;
}

/* 模态框底部按钮优化 */
#globalExportCancelBtn {
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-secondary);
}

#globalExportCancelBtn:hover {
    background: var(--bg-tertiary);
    color: var(--text-primary);
}

#globalExportConfirmBtn {
    background: var(--accent-primary);
    color: white;
    border: none;
    box-shadow: 0 2px 6px rgba(var(--accent-rgb), 0.3);
}

#globalExportConfirmBtn:hover {
    background: var(--accent-hover);
    box-shadow: 0 4px 12px rgba(var(--accent-rgb), 0.4);
}

/* ==================== 视图切换器自定义 (Global Export) ==================== */
.mode-toggle-group {
    display: inline-flex;
    background: var(--bg-tertiary);
    border-radius: 6px;
    padding: 2px;
    border: 1px solid var(--border-color);
}

.mode-toggle-option {
    padding: 4px 12px;
    font-size: 12px;
    cursor: pointer;
    border-radius: 4px;
    color: var(--text-secondary);
    transition: all 0.2s ease;
    user-select: none;
    font-weight: 500;
}

.mode-toggle-option:hover {
    color: var(--text-primary);
}

.mode-toggle-option.active {
    background: var(--bg-elevated);
    /* or white */
    color: var(--accent-primary);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    font-weight: 600;
}

/* 强制详情按钮文字不换行 */
.detail-btn span {
    white-space: nowrap;
}

/* 顶部按钮间距优化 */
.view-header-right {
    gap: 12px;
    /* 增加按钮组之间的间距 */
}

/* 全局导出按钮的 Tooltip 下方显示 */
#globalExportBtn .btn-tooltip {
    top: calc(100% + 10px);
    /* 确保在下方 */
    bottom: auto;
    /* 重置默认可能存在的 bottom 定位 */
}

#globalExportBtn .btn-tooltip::before {
    bottom: 100%;
    /* 箭头在 Tooltip 上方 */
    top: auto;
    border-bottom-color: rgba(0, 0, 0, 0.9);
    border-top-color: transparent;
}

/* Global Export Button Tooltip - Exact match with Clear Button */
#globalExportBtn::after {
    display: block !important;
    content: attr(data-title) !important;
    white-space: nowrap;
    position: absolute;
    /* Align with clearBackupHistoryBtn::after */
    bottom: auto;
    top: calc(100% + 1px);
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.05s ease, visibility 0.05s ease;
    z-index: 1000;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    font-weight: normal;
    text-transform: none;
    pointer-events: none;
}

#globalExportBtn:hover::after {
    visibility: visible;
    opacity: 1;
}

/* 详情按钮重构 */
.action-btn.detail-btn {
    width: auto !important;
    height: 28px !important;
    padding: 0 8px !important;
    background: var(--bg-secondary) !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 6px !important;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
    line-height: 1;
}

.action-btn.detail-btn:hover {
    color: var(--accent-primary);
    border-color: var(--accent-primary) !important;
    background: var(--bg-tertiary) !important;
    text-decoration: none;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05) !important;
    transform: translateY(-1px) !important;
}

.action-btn.detail-btn:active {
    transform: translateY(0) !important;
}

.action-btn.detail-btn i {
    font-size: 12px;
    color: inherit;
}

.action-btn.detail-btn .btn-tooltip {
    position: static !important;
    visibility: visible !important;
    opacity: 1 !important;
    background: transparent !important;
    color: inherit !important;
    padding: 0 !important;
    box-shadow: none !important;
    transform: none !important;
    font-size: inherit !important;
    pointer-events: auto !important;
    white-space: nowrap;
}

.action-btn.detail-btn .btn-tooltip {
    display: block;
    position: static !important;
    margin-top: -1px;
    background: transparent !important;
    color: inherit !important;
    padding: 0 !important;
    box-shadow: none !important;
    font-size: inherit !important;
    visibility: visible !important;
    opacity: 1 !important;
    transform: none !important;
    pointer-events: auto !important;
    white-space: nowrap;
    line-height: normal;
}

.action-btn.detail-btn .btn-tooltip::before {
    display: none !important;
}

/* Custom Text Switch used in Global Export Modal - Button Group Style */
.global-export-toggle-group {
    display: inline-flex;
    background: var(--bg-tertiary);
    border-radius: 6px;
    padding: 2px;
    border: 1px solid var(--border-color);
    gap: 2px;
}

.global-export-toggle-btn {
    appearance: none;
    border: none;
    background: transparent;
    padding: 4px 12px;
    font-size: 12px;
    color: var(--text-secondary);
    cursor: pointer;
    border-radius: 4px;
    transition: all 0.2s ease;
    line-height: 1.4;
    font-weight: 500;
}

.global-export-toggle-btn:hover {
    color: var(--text-primary);
    background: rgba(0, 0, 0, 0.05);
}

/* 选中状态：白色背景 + 阴影 + 主色文字 */
.global-export-toggle-btn.active {
    background: var(--bg-elevated);
    color: var(--accent-primary);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    font-weight: 600;
}

[data-theme="dark"] .global-export-toggle-group {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .global-export-toggle-btn.active {
    background: #3e4042;
    color: var(--accent-primary);
}

/* ==================== 详情弹窗顶部按钮样式 (一致性) ==================== */
.detail-actions-right {
    display: flex;
    align-items: center;
    gap: 12px;
    /* Consistent with view-header-right */
}

/* ==================== 清除历史弹窗双滑块样式 (Premium Design) ==================== */
.range-slider-container {
    position: relative;
    width: 100%;
    height: 36px;
    display: flex;
    align-items: center;
    margin-bottom: 12px;
}

/* 轨道背景 - Flip for Largest on Left */
.range-slider-track {
    position: absolute;
    top: 50%;
    transform: translateY(-50%) scaleX(-1);
    width: 100%;
    height: 4px;
    background-color: var(--bg-tertiary);
    border-radius: 4px;
    pointer-events: none;
    overflow: hidden;
}

/* 选中范围高亮 */
.range-slider-highlight {
    position: absolute;
    top: 0;
    height: 100%;
    background-color: var(--error);
    border-radius: 4px;
    pointer-events: none;
    z-index: 1;
    transition: none;
}

/* 刻度标签 */
.range-slider-labels {
    position: absolute;
    bottom: -22px;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: space-between;
    pointer-events: none;
}

.range-slider-labels span {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-tertiary);
    transition: color 0.2s ease;
}

/* 输入控件（隐形轨道） - Flip for Largest on Left */
.range-slider-input {
    -webkit-appearance: none;
    appearance: none;
    position: absolute;
    top: 50%;
    transform: translateY(-50%) scaleX(-1);
    left: 0;
    width: 100%;
    height: 20px;
    background: transparent;
    pointer-events: none;
    margin: 0;
    z-index: 2;
}

/* 确保两个滑块重叠时都能操作 */
#clearHistoryRangeMin {
    z-index: 3;
}

#clearHistoryRangeMax {
    z-index: 4;
}

/* ==================== 全局导出范围选择滑块样式 ==================== */
#globalExportRangeMin {
    z-index: 3;
}

#globalExportRangeMax {
    z-index: 4;
}

#globalExportRangeHighlight {
    background-color: var(--accent-primary);
}

/* Global Export: keep end labels inside the slider line */
#globalExportRangeContainer .range-slider-labels {
    bottom: auto;
    top: 50%;
    transform: translateY(-50%);
    padding: 0;
    left: 10px;
    width: calc(100% - 20px);
}

#globalExportRangeContainer .range-slider-labels span {
    background: var(--bg-secondary);
    padding: 1px 6px;
    border-radius: 999px;
    border: 1px solid var(--border-color);
    line-height: 1.2;
    z-index: 1;
}

/* Global Export: inset track so thumbs stay inside at both ends */
#globalExportRangeContainer .range-slider-track,
#globalExportRangeContainer .range-slider-input {
    left: 10px;
    width: calc(100% - 20px);
}

/* Range slider: value bubbles (numbers over the thumb circles) */
.range-slider-bubble {
    position: absolute;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: transparent;
    font-size: 11px;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    z-index: 6;
    text-shadow: none;
}

[data-theme="dark"] .range-slider-bubble {
    text-shadow: none;
}

#globalExportRangeContainer .range-slider-bubble {
    color: var(--accent-primary);
}

#clearHistoryRangeContainer .range-slider-bubble {
    color: var(--error);
}

/* Clear History: keep end labels inside the slider line (match Global Export) */
#clearHistoryRangeContainer .range-slider-labels {
    bottom: auto;
    top: 50%;
    transform: translateY(-50%);
    padding: 0;
    left: 10px;
    width: calc(100% - 20px);
}

#clearHistoryRangeContainer .range-slider-labels span {
    background: var(--bg-secondary);
    padding: 1px 6px;
    border-radius: 999px;
    border: 1px solid var(--border-color);
    line-height: 1.2;
    z-index: 1;
}

/* Clear History: inset track so thumbs stay inside at both ends */
#clearHistoryRangeContainer .range-slider-track,
#clearHistoryRangeContainer .range-slider-input {
    left: 10px;
    width: calc(100% - 20px);
}

/* Global Export: keep layout stable by always showing scrollbar (avoid gutter gap) */
#globalExportModal .modal-body {
    overflow-y: scroll;
}

#globalExportModal .modal-content {
    overflow: hidden;
}

#globalExportModal .modal-body {
    background: var(--bg-elevated);
}

#globalExportModal .modal-body::-webkit-scrollbar {
    background: transparent;
}

#globalExportModal .modal-body::-webkit-scrollbar-thumb {
    border-radius: 999px;
    border: 2px solid var(--bg-elevated);
    background-clip: padding-box;
}

#globalExportModal .modal-body::-webkit-scrollbar-track {
    border-radius: 999px;
    background: transparent;
}

#globalExportModal .modal-body::-webkit-scrollbar-corner {
    background: transparent;
}

/* Global Export: thumb active glow should follow accent (blue), not delete (red) */
#globalExportRangeMin::-webkit-slider-thumb:active,
#globalExportRangeMax::-webkit-slider-thumb:active {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 0 0 4px color-mix(in srgb, var(--accent-primary) 22%, transparent);
}

#globalExportRangeMin::-moz-range-thumb:active,
#globalExportRangeMax::-moz-range-thumb:active {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 0 0 4px color-mix(in srgb, var(--accent-primary) 22%, transparent);
}

.range-slider-input:focus {
    outline: none;
}

/* Webkit 滑道 (隐形) */
.range-slider-input::-webkit-slider-runnable-track {
    width: 100%;
    height: 20px;
    cursor: pointer;
    background: transparent;
    border: none;
}

/* Webkit 手柄 (圆形) - Clean White Premium Style */
.range-slider-input::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #ffffff;
    border: none;
    cursor: grab;
    pointer-events: auto;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(0, 0, 0, 0.05);
    margin-top: 0px;
    transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease;
}

/* 手柄悬停态 */
.range-slider-input::-webkit-slider-thumb:hover {
    transform: scale(1.15);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(0, 0, 0, 0.05);
}

/* 手柄按下态 */
.range-slider-input::-webkit-slider-thumb:active {
    cursor: grabbing;
    transform: scale(1.05);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 0 0 4px rgba(231, 76, 60, 0.15);
}

/* Firefox 滑道 */
.range-slider-input::-moz-range-track {
    width: 100%;
    height: 20px;
    cursor: pointer;
    background: transparent;
    border: none;
}

/* Firefox 手柄 */
.range-slider-input::-moz-range-thumb {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #ffffff;
    border: none;
    cursor: grab;
    pointer-events: auto;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(0, 0, 0, 0.05);
    transform: none;
}

.range-slider-input::-moz-range-thumb:hover {
    transform: scale(1.15);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(0, 0, 0, 0.05);
}

.range-slider-input::-moz-range-thumb:active {
    cursor: grabbing;
    transform: scale(1.05);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 0 0 4px rgba(231, 76, 60, 0.15);
}

/* ==================== Revert Toast 动画 ==================== */
@keyframes slideUp {
    from {
        transform: translateY(100%);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

@keyframes slideDown {
    from {
        transform: translateY(0);
        opacity: 1;
    }

    to {
        transform: translateY(100%);
        opacity: 0;
    }
}

/* ==================== 撤销覆盖层 ==================== */
.revert-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    z-index: 20000;
    display: none;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(2px);
}

.revert-overlay-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    background: var(--bg-elevated);
    padding: 40px;
    border-radius: 12px;
    box-shadow: var(--shadow-lg);
    min-width: 280px;
    animation: scaleIn 0.3s ease-out;
}

.revert-spinner {
    width: 50px;
    height: 50px;
    border: 4px solid var(--bg-tertiary);
    border-top-color: var(--accent-primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

.revert-text {
    font-size: 16px;
    font-weight: 500;
    color: var(--text-primary);
    text-align: center;
}

/* 主内容区域过渡 */
.main-container {
    transition: opacity 0.3s ease;
}

@keyframes scaleIn {
    from {
        transform: scale(0.9);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

.revert-toast {
    animation: slideUp 0.3s ease !important;
}
