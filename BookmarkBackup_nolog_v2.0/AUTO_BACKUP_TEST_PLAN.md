# 实时自动备份功能测试计划

## 功能概述
实时自动备份功能已完成开发，支持三种模式：
1. **实时自动备份** - 书签变化时立即备份（需满足使用活动和变化检测双重条件）
2. **循环自动备份** - 按设定的天、小时、分钟间隔定期备份
3. **准点定时备份** - 在每天的固定时间点进行备份

## 测试准备

### 1. 安装扩展
- 在Chrome浏览器中加载扩展
- 确认扩展图标显示正常
- 检查控制台是否有错误信息

### 2. 基础设置
- 配置WebDAV或本地备份（至少一种）
- 确认网络连接正常
- 准备一些测试书签用于变化检测

## 测试项目

### A. UI功能测试

#### A1. 界面切换测试
1. **手动模式界面**
   - [ ] 关闭「实时自动备份」开关
   - [ ] 验证显示「动态提醒设置」和「手动备份」按钮
   - [ ] 验证隐藏「自动备份设置」按钮

2. **自动模式界面**
   - [ ] 开启「实时自动备份」开关
   - [ ] 验证隐藏「动态提醒设置」和「手动备份」按钮
   - [ ] 验证显示「自动备份设置」按钮

#### A2. 设置对话框测试
1. **对话框打开和关闭**
   - [ ] 点击「自动备份设置」按钮
   - [ ] 验证对话框正确打开
   - [ ] 测试各种关闭方式（×按钮、外部点击、ESC键）

2. **选项卡切换**
   - [ ] 测试三个选项卡的切换
   - [ ] 验证选项卡样式变化
   - [ ] 验证内容区域正确显示/隐藏

3. **输入验证**
   - [ ] 循环备份：测试天、小时、分钟输入限制
   - [ ] 定时备份：测试时间格式验证
   - [ ] 测试无效输入的错误提示

#### A3. 开关和输入控件测试
1. **切换开关**
   - [ ] 测试循环备份开关的切换动画
   - [ ] 测试定时备份开关的切换动画
   - [ ] 验证开关状态与输入框的启用/禁用联动

2. **数字输入框**
   - [ ] 测试天数输入（0-30）
   - [ ] 测试小时输入（0-24）
   - [ ] 测试分钟输入（0-60）

3. **时间输入框**
   - [ ] 测试24小时格式时间输入
   - [ ] 测试时间选择器的使用

### B. 核心功能测试

#### B1. 实时自动备份测试
1. **基本功能**
   - [ ] 切换到实时模式
   - [ ] 添加/删除/修改书签
   - [ ] 验证备份是否自动触发
   - [ ] 检查备份记录是否正确添加

2. **双重条件检测**
   - [ ] 测试浏览器失去焦点时不触发备份
   - [ ] 测试无书签变化时不触发备份
   - [ ] 测试同时满足两个条件时才触发备份

#### B2. 循环自动备份测试
1. **时间间隔计算**
   - [ ] 设置短间隔（如1分钟）验证定时器
   - [ ] 设置复合间隔（如1天2小时30分钟）
   - [ ] 验证时间转换计算正确性

2. **定时器行为**
   - [ ] 验证定时器按间隔触发
   - [ ] 测试定时器在浏览器休眠后恢复
   - [ ] 验证条件检测正常工作

#### B3. 准点定时备份测试
1. **时间点设置**
   - [ ] 设置当天未来的时间点
   - [ ] 设置已过去的时间点（应设为明天）
   - [ ] 测试多个时间点同时启用

2. **跨天处理**
   - [ ] 验证备份完成后自动设置下一天
   - [ ] 测试跨月、跨年的时间计算
   - [ ] 验证错过的时间点处理

### C. 集成功能测试

#### C1. 备份记录集成
1. **记录格式**
   - [ ] 验证实时备份记录格式
   - [ ] 验证循环备份记录格式
   - [ ] 验证定时备份记录格式

2. **状态显示**
   - [ ] 检查备份历史记录显示
   - [ ] 验证成功/失败状态记录
   - [ ] 检查错误信息记录

#### C2. 角标状态集成
1. **角标更新**
   - [ ] 验证备份后角标状态更新
   - [ ] 检查不同模式下的角标显示
   - [ ] 测试备份失败时的角标变化

### D. 设置管理测试

#### D1. 设置持久化
1. **保存和加载**
   - [ ] 保存设置后重启浏览器
   - [ ] 验证设置正确恢复
   - [ ] 测试默认设置恢复功能

2. **模式切换**
   - [ ] 切换不同备份模式
   - [ ] 验证定时器正确清理和重新创建
   - [ ] 检查模式切换的即时生效

#### D2. 验证和错误处理
1. **输入验证**
   - [ ] 测试各种无效输入
   - [ ] 验证错误提示显示
   - [ ] 检查验证逻辑的完整性

2. **错误恢复**
   - [ ] 测试网络错误情况
   - [ ] 测试配置错误情况
   - [ ] 验证错误后的系统状态

### E. 性能和稳定性测试

#### E1. 长期运行测试
1. **稳定性**
   - [ ] 长时间运行（24小时以上）
   - [ ] 频繁模式切换测试
   - [ ] 大量书签变化测试

2. **资源使用**
   - [ ] 监控内存使用情况
   - [ ] 检查定时器是否正确清理
   - [ ] 验证无内存泄漏

#### E2. 边界情况测试
1. **极限值测试**
   - [ ] 最大时间间隔设置
   - [ ] 最小时间间隔设置
   - [ ] 同时多个定时器运行

2. **异常情况**
   - [ ] 浏览器异常关闭重启
   - [ ] 网络断开重连
   - [ ] 配置文件损坏恢复

## 测试记录模板

### 测试日期：____
### 测试环境：
- 浏览器：Chrome ___ / Edge ___
- 操作系统：___
- 扩展版本：___

### 测试结果：
| 测试项目 | 期望结果 | 实际结果 | 状态 | 备注 |
|---------|---------|---------|------|------|
| A1.1 手动模式UI | 显示手动按钮 |  | ✅❌ |  |
| ... | ... | ... | ... | ... |

### 发现的问题：
1. **问题描述**：
   - **重现步骤**：
   - **期望行为**：
   - **实际行为**：
   - **严重程度**：高/中/低

## 测试完成标准

### 必须通过的测试（阻塞性）
- [ ] 所有UI交互正常工作
- [ ] 三种备份模式都能正确执行备份
- [ ] 设置能够正确保存和加载
- [ ] 无明显的内存泄漏或性能问题
- [ ] 备份记录能够正确集成到现有系统

### 建议通过的测试（重要性）
- [ ] 长期运行稳定性良好
- [ ] 边界情况处理正确
- [ ] 错误恢复机制有效
- [ ] 用户体验流畅

## 已知限制和注意事项

1. **浏览器权限依赖**
   - 需要书签访问权限
   - 需要存储权限
   - 需要alarm权限

2. **网络依赖**
   - WebDAV备份需要网络连接
   - 配置验证需要网络访问

3. **时间精度**
   - Chrome alarm API的最小精度为1分钟
   - 非常短的间隔可能不精确

4. **浏览器状态检测**
   - 依赖window focus事件
   - 某些场景下可能检测不准确

## 测试工具建议

1. **浏览器开发者工具**
   - Console查看错误和日志
   - Application > Storage检查存储数据
   - Performance监控资源使用

2. **扩展管理页面**
   - chrome://extensions/
   - 检查扩展状态和权限

3. **手动测试辅助**
   - 准备测试用的书签文件夹
   - 配置测试用的WebDAV服务器
   - 记录测试时间和结果