# Bookmark Canvas 测试指南

## 修复内容

已修复JavaScript错误：
- ✅ 更新 `navTreeText` → `navCanvasText`
- ✅ 更新 `treeViewTitle` → `canvasViewTitle`
- ✅ 移除 `revertAllTreeBtn` 相关代码
- ✅ 添加 Canvas 工具栏按钮的国际化文本

## 快速测试步骤

### 1. 加载插件
1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 启用「开发者模式」
4. 点击「加载已解压的扩展程序」
5. 选择项目文件夹

### 2. 打开 Canvas
1. 点击插件图标
2. 点击「历史记录查看器」
3. 在左侧导航点击「Bookmark Canvas」

### 3. 测试永久栏目
- ✅ 中心显示蓝色边框区域
- ✅ 可以看到浏览器书签树
- ✅ 点击文件夹可展开/折叠
- ✅ 点击书签可在新标签页打开

### 4. 测试拖出创建临时节点
1. 在永久栏目中找一个书签
2. 按住鼠标左键拖动
3. 拖到画布空白区域（点阵背景）
4. 释放鼠标
5. ✅ 应该创建一个白色卡片节点

### 5. 测试移动临时节点
1. 将鼠标移到临时节点的**标题栏**（灰色区域）
2. 按住拖动
3. ✅ 节点应该跟随鼠标移动
4. 释放鼠标
5. ✅ 位置自动保存（刷新页面后还在）

### 6. 测试拖回永久栏目
1. 将鼠标移到临时节点的**内容区域**（白色区域）
2. 按住拖动
3. ✅ 永久栏目应该显示**绿色边框**高亮
4. 拖到永久栏目上释放
5. ✅ 应该弹出「已添加到浏览器书签！」
6. ✅ 临时节点应该消失
7. 检查浏览器书签栏，✅ 应该看到新增的书签

### 7. 测试导入
1. 点击工具栏「导入」按钮
2. 选择「导入 HTML 书签」或「导入 JSON 书签」
3. 选择一个测试文件
4. ✅ 应该在画布上创建多个临时节点

### 8. 测试导出
1. 确保画布上有几个临时节点
2. 点击工具栏「导出」按钮
3. ✅ 应该下载一个 `.canvas` 文件
4. 用文本编辑器打开
5. ✅ 应该是格式化的 JSON
6. ✅ 应该包含 `nodes` 和 `edges` 数组

### 9. 测试清空
1. 点击工具栏「清空临时节点」
2. 确认对话框
3. ✅ 所有临时节点应该消失
4. ✅ 永久栏目应该保持不变

### 10. 测试数据持久化
1. 创建几个临时节点
2. 刷新页面（F5）
3. 再次点击「Bookmark Canvas」
4. ✅ 临时节点应该还在原来的位置

## 常见问题排查

### 问题1：页面报错
**检查浏览器控制台（F12）是否有错误信息**

### 问题2：拖拽没反应
- 确保拖动的是正确的区域（标题栏 vs 内容区）
- 检查是否已经在拖拽状态

### 问题3：临时节点不保存
- 检查浏览器是否允许 localStorage
- 查看控制台是否有存储错误

### 问题4：无法拖回永久栏目
- 确保从**内容区域**开始拖动（不是标题栏）
- 检查永久栏目是否显示绿色高亮
- 确认浏览器有书签权限

### 问题5：导入失败
- 检查文件格式是否正确
- 查看控制台错误信息
- 确认文件内容不为空

## 预期结果

所有测试通过后：
- ✅ 无JavaScript错误
- ✅ 永久栏目正常显示
- ✅ 可以创建临时节点
- ✅ 可以移动临时节点
- ✅ 可以拖回永久栏目
- ✅ 导入导出功能正常
- ✅ 数据持久化正常

## 文件检查清单

- ✅ `/history_html/history.html` - 已更新
- ✅ `/history_html/history.css` - 已追加样式
- ✅ `/history_html/history.js` - 已修复国际化
- ✅ `/history_html/bookmark_canvas_module.js` - 已创建
- ✅ `/manifest.json` - 保持原状

## 下一步

如果测试全部通过：
1. 可以开始使用Canvas功能
2. 根据需要调整样式和交互
3. 添加更多高级功能（连线、分组等）

如果测试失败：
1. 查看控制台错误信息
2. 检查文件是否正确修改
3. 确认所有文件都已保存
