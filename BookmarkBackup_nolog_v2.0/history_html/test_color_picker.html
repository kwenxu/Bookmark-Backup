<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‰²ç›˜æµ‹è¯• - Obsidian Canvas Style</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 40px;
            background: #f5f5f5;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        
        h1 {
            margin-bottom: 30px;
            color: #333;
        }
        
        .demo-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        
        h2 {
            margin-top: 0;
            color: #666;
            font-size: 18px;
        }
        
        /* æ¨¡æ‹ŸCanvasèŠ‚ç‚¹ */
        .md-canvas-node {
            position: relative;
            width: 300px;
            height: 200px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin: 60px auto;
            padding: 20px;
        }
        
        .md-canvas-node:hover .md-node-toolbar,
        .md-node-toolbar:hover,
        .md-node-toolbar:has(.md-color-popover.open) {
            opacity: 1;
            pointer-events: auto;
        }
        
        /* ä»å®é™…CSSå¤åˆ¶çš„æ ·å¼ */
        .md-node-toolbar {
            position: absolute;
            top: -28px;
            left: 50%;
            transform: translateX(-50%);
            height: 24px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 0;
            border: none;
            background: transparent;
            box-shadow: none;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.12s ease;
            z-index: 100;
        }
        
        .md-node-toolbar-btn {
            width: 24px;
            height: 24px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            border: 1px solid rgba(27, 31, 36, 0.25);
            background: transparent;
            color: #57606a;
            cursor: pointer;
            transition: border-color 0.12s ease, color 0.12s ease, background 0.12s ease;
            font-size: 12px;
        }
        
        .md-node-toolbar-btn:hover {
            border-color: rgba(9, 105, 218, 0.55);
            color: #24292f;
            background: rgba(9, 105, 218, 0.06);
        }
        
        /* è‰²ç›˜å¼¹å‡ºå±‚ - ç›¸å¯¹äºå·¥å…·æ å®šä½ */
        .md-color-popover {
            position: absolute;
            bottom: calc(100% + 4px);
            left: 50%;
            transform: translateX(-50%);
            background: #ffffff;
            border: 1px solid rgba(27, 31, 36, 0.25);
            border-radius: 8px;
            box-shadow: 0 6px 18px rgba(15, 23, 42, 0.12);
            padding: 8px;
            display: none;
            gap: 8px;
            z-index: 10;
            white-space: nowrap;
        }
        
        .md-color-popover.open { 
            display: grid; 
            grid-template-columns: repeat(7, 18px); 
            align-items: center; 
        }
        
        .md-color-chip {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 1px solid rgba(0,0,0,0.2);
            cursor: pointer;
            transition: transform 0.12s ease, box-shadow 0.12s ease;
        }
        
        .md-color-chip:hover {
            transform: scale(1.15);
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        /* å½©è‰²åœ†ç›˜æŒ‰é’® */
        .md-color-picker-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            padding: 0;
            border: 1px solid rgba(0,0,0,0.2);
        }
        
        .md-color-picker-btn:hover {
            border-color: rgba(0,0,0,0.4);
        }
        
        .md-color-picker-btn svg {
            display: block;
        }
        
        /* RGBé€‰æ‹©å™¨UI - æ˜¾ç¤ºåœ¨è‰²ç›˜æ­£ä¸Šæ–¹ */
        .md-rgb-picker {
            position: absolute;
            bottom: calc(100% + 4px);
            left: 50%;
            transform: translateX(-50%);
            background: #ffffff;
            border: 1px solid rgba(27, 31, 36, 0.25);
            border-radius: 8px;
            box-shadow: 0 6px 18px rgba(15, 23, 42, 0.12);
            padding: 8px;
            display: none;
            z-index: 20;
        }
        
        .md-rgb-picker.open {
            display: block;
        }
        
        .md-color-input {
            width: 120px;
            height: 32px;
            border: 1px solid rgba(27, 31, 36, 0.25);
            border-radius: 6px;
            cursor: pointer;
            display: block;
        }
        
        .color-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .color-preview {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 4px;
            border: 1px solid #ddd;
            vertical-align: middle;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ¨ ä¹¦ç­¾ç”»å¸ƒè‰²ç›˜æµ‹è¯•</h1>
        
        <div class="demo-section">
            <h2>Obsidian Canvas é£æ ¼è‰²ç›˜</h2>
            <p>æ‚¬åœåœ¨å¡ç‰‡ä¸ŠæŸ¥çœ‹å·¥å…·æ ï¼Œç‚¹å‡»è°ƒè‰²æ¿æŒ‰é’®æµ‹è¯•è‰²ç›˜</p>
            
            <div class="md-canvas-node">
                <div class="md-node-toolbar">
                    <button class="md-node-toolbar-btn" title="åˆ é™¤"><i class="far fa-trash-alt"></i></button>
                    <button class="md-node-toolbar-btn" id="colorBtn" title="é¢œè‰²"><i class="fas fa-palette"></i></button>
                    <button class="md-node-toolbar-btn" title="å®šä½"><i class="fas fa-search-plus"></i></button>
                    <button class="md-node-toolbar-btn" title="ç¼–è¾‘"><i class="far fa-edit"></i></button>
                    
                    <div class="md-color-popover" id="colorPopover">
                        <span class="md-color-chip" data-color="#ff6666" style="background:#ff6666"></span>
                        <span class="md-color-chip" data-color="#ffaa66" style="background:#ffaa66"></span>
                        <span class="md-color-chip" data-color="#ffdd66" style="background:#ffdd66"></span>
                        <span class="md-color-chip" data-color="#66dd99" style="background:#66dd99"></span>
                        <span class="md-color-chip" data-color="#66bbff" style="background:#66bbff"></span>
                        <span class="md-color-chip" data-color="#bb99ff" style="background:#bb99ff"></span>
                        <button class="md-color-chip md-color-picker-btn" id="rgbBtn" title="RGBé¢œè‰²é€‰æ‹©å™¨">
                            <svg viewBox="0 0 24 24" width="14" height="14">
                                <circle cx="12" cy="12" r="10" fill="url(#rainbow-gradient)" />
                                <defs>
                                    <linearGradient id="rainbow-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#ff0000" />
                                        <stop offset="16.67%" style="stop-color:#ff9900" />
                                        <stop offset="33.33%" style="stop-color:#ffff00" />
                                        <stop offset="50%" style="stop-color:#00ff00" />
                                        <stop offset="66.67%" style="stop-color:#0099ff" />
                                        <stop offset="83.33%" style="stop-color:#9900ff" />
                                        <stop offset="100%" style="stop-color:#ff0099" />
                                    </linearGradient>
                                </defs>
                            </svg>
                        </button>
                        
                        <div class="md-rgb-picker" id="rgbPicker">
                            <input type="color" class="md-color-input" id="customColor" value="#2563eb" />
                        </div>
                    </div>
                </div>
                
                <h3 style="margin-top: 0;">ç©ºç™½æ ç›®ç¤ºä¾‹</h3>
                <p>è¿™æ˜¯ä¸€ä¸ªMarkdownæ–‡æœ¬å¡ç‰‡</p>
            </div>
            
            <div class="color-info">
                <strong>å½“å‰é€‰æ‹©çš„é¢œè‰²ï¼š</strong>
                <span id="selectedColor">æœªé€‰æ‹©</span>
                <span class="color-preview" id="colorPreview"></span>
            </div>
        </div>
        
        <div class="demo-section">
            <h2>âœ¨ æ–°ç‰¹æ€§è¯´æ˜</h2>
            <ul>
                <li><strong>6ç§Obsidiané£æ ¼é¢„è®¾é¢œè‰²ï¼š</strong>çº¢ã€æ©™ã€é»„ã€ç»¿ã€è“ã€ç´«</li>
                <li><strong>å½©è‰²åœ†ç›˜æŒ‰é’®ï¼š</strong>ä½äº6ä¸ªé¢„è®¾é¢œè‰²æœ€å³è¾¹ï¼Œå¸¦æœ‰å½©è™¹æ¸å˜å›¾æ ‡</li>
                <li><strong>RGBé¢œè‰²é€‰æ‹©å™¨ï¼š</strong>ç‚¹å‡»å½©è‰²åœ†ç›˜å<strong>ç›´æ¥æ‰“å¼€</strong>åŸç”Ÿé¢œè‰²é€‰æ‹©å™¨</li>
                <li><strong>å·¥å…·æ ä½ç½®ï¼š</strong>äºŒçº§UIï¼ˆè‰²ç›˜ï¼‰å‡ºç°åœ¨å·¥å…·æ æ­£ä¸Šæ–¹</li>
            </ul>
        </div>
    </div>
    
    <script>
        const colorBtn = document.getElementById('colorBtn');
        const colorPopover = document.getElementById('colorPopover');
        const rgbBtn = document.getElementById('rgbBtn');
        const customColor = document.getElementById('customColor');
        const selectedColorSpan = document.getElementById('selectedColor');
        const colorPreview = document.getElementById('colorPreview');
        
        // åˆ‡æ¢è‰²ç›˜æ˜¾ç¤º
        colorBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            colorPopover.classList.toggle('open');
        });
        
        // å½©è‰²åœ†ç›˜æŒ‰é’® - åˆ‡æ¢RGBé€‰æ‹©å™¨æ˜¾ç¤º
        const rgbPicker = document.getElementById('rgbPicker');
        rgbBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            const isOpen = rgbPicker.classList.contains('open');
            if (isOpen) {
                rgbPicker.classList.remove('open');
            } else {
                rgbPicker.classList.add('open');
                // å»¶è¿Ÿè§¦å‘ç‚¹å‡»ï¼Œç¡®ä¿UIå·²æ˜¾ç¤º
                setTimeout(() => customColor.click(), 50);
            }
        });
        
        // é¢„è®¾é¢œè‰²ç‚¹å‡»
        document.querySelectorAll('.md-color-chip[data-color]').forEach(chip => {
            chip.addEventListener('click', (e) => {
                const color = e.target.dataset.color;
                selectedColorSpan.textContent = color;
                colorPreview.style.background = color;
                colorPopover.classList.remove('open');
            });
        });
        
        // è‡ªå®šä¹‰é¢œè‰²é€‰æ‹©
        customColor.addEventListener('input', (e) => {
            const color = e.target.value;
            selectedColorSpan.textContent = color;
            colorPreview.style.background = color;
        });
        
        customColor.addEventListener('change', () => {
            rgbPicker.classList.remove('open');
        });
        
        // ç‚¹å‡»å¤–éƒ¨å…³é—­
        document.addEventListener('click', (e) => {
            if (!colorPopover.contains(e.target) && e.target !== colorBtn) {
                colorPopover.classList.remove('open');
            }
        });
    </script>
</body>
</html>
