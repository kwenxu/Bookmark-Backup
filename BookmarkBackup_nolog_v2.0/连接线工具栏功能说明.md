# 连接线工具栏功能说明 / Edge Toolbar Features

## 概述 / Overview

**中文**: 为 Canvas 画布中的连接线添加了专属工具窗，提供 5 个核心功能，与 Obsidian Canvas 规范保持一致。

**English**: Added a dedicated toolbar for connection lines in the Canvas, providing 5 core features that align with the Obsidian Canvas specification.

---

## 功能列表 / Feature List

### 1. 删除 / Delete

**中文**:
- **图标**: 垃圾桶 (trash-alt)
- **功能**: 删除选中的连接线
- **快捷操作**: 点击连接线后，点击工具栏第一个按钮

**English**:
- **Icon**: Trash can (trash-alt)
- **Function**: Delete the selected connection line
- **Quick Action**: Click the connection line, then click the first button in the toolbar

---

### 2. 颜色 / Color

**中文**:
- **图标**: 调色板 (palette)
- **功能**: 
  - 6 种预设颜色：红、橙、黄、绿、蓝、紫
  - 自定义 RGB 颜色选择器
  - 颜色实时预览
  - 自动保存到本地存储
- **使用方法**: 
  1. 点击调色板按钮
  2. 选择预设颜色或使用自定义颜色选择器
  3. 颜色立即应用到连接线

**English**:
- **Icon**: Palette (palette)
- **Function**: 
  - 6 preset colors: Red, Orange, Yellow, Green, Blue, Purple
  - Custom RGB color picker
  - Real-time color preview
  - Auto-save to local storage
- **How to Use**: 
  1. Click the palette button
  2. Select a preset color or use the custom color picker
  3. Color is immediately applied to the connection line

---

### 3. 定位并放大 / Locate and Zoom

**中文**:
- **图标**: 放大镜加号 (search-plus)
- **功能**: 
  - 自动定位到连接线中心
  - 根据连接线长度智能调整缩放级别
  - 平滑动画过渡
- **使用场景**: 
  - 快速找到画布中的特定连接线
  - 查看长距离连接的全貌
  - 聚焦到关键关联关系

**English**:
- **Icon**: Magnifying glass plus (search-plus)
- **Function**: 
  - Auto-locate to the center of the connection line
  - Intelligently adjust zoom level based on line length
  - Smooth animation transition
- **Use Cases**: 
  - Quickly find specific connection lines in the canvas
  - View the full picture of long-distance connections
  - Focus on key relationships

---

### 4. 直线方向 / Line Direction

**中文**:
- **图标**: 双向箭头 (arrows-alt-h)
- **功能**: 
  - 切换连接线的起点和终点
  - 交换连接方向
  - 保持连接线的其他属性（颜色、标签）不变
- **使用场景**: 
  - 调整关系方向
  - 修正错误的连接方向
  - 优化连接线布局

**English**:
- **Icon**: Bidirectional arrows (arrows-alt-h)
- **Function**: 
  - Toggle the start and end points of the connection line
  - Swap connection direction
  - Keep other properties (color, label) unchanged
- **Use Cases**: 
  - Adjust relationship direction
  - Correct wrong connection direction
  - Optimize connection line layout

---

### 5. 编辑文字 / Edit Label

**中文**:
- **图标**: 编辑 (edit)
- **功能**: 
  - 为连接线添加文字标签
  - 编辑现有标签
  - 删除标签（清空输入）
  - 标签显示在连接线中点
  - 标签带有背景阴影，确保在任何背景下都清晰可见
- **使用场景**: 
  - 标注关系类型（如："依赖"、"关联"、"继承"）
  - 添加说明文字
  - 标记重要连接

**English**:
- **Icon**: Edit (edit)
- **Function**: 
  - Add text labels to connection lines
  - Edit existing labels
  - Delete labels (clear input)
  - Label displayed at the midpoint of the connection line
  - Label has background shadow for visibility on any background
- **Use Cases**: 
  - Annotate relationship types (e.g., "Dependency", "Association", "Inheritance")
  - Add explanatory text
  - Mark important connections

---

## 技术特性 / Technical Features

### 数据持久化 / Data Persistence

**中文**:
- 所有连接线属性（颜色、标签、方向）自动保存到 localStorage
- 页面刷新后保持不变
- 支持导出和导入（与 Obsidian Canvas 兼容）

**English**:
- All connection line properties (color, label, direction) are automatically saved to localStorage
- Persist after page refresh
- Support export and import (compatible with Obsidian Canvas)

### 主题支持 / Theme Support

**中文**:
- 自动适配浅色/深色主题
- 标签文字带有智能背景阴影
- 工具栏样式与空白栏目保持一致

**English**:
- Auto-adapt to light/dark themes
- Label text with intelligent background shadow
- Toolbar style consistent with blank sections

### 交互优化 / Interaction Optimization

**中文**:
- 点击连接线或标签即可选中
- 工具栏自动定位到点击位置附近
- 选择互斥（连接线与空白栏目）
- 连接模式下自动隐藏工具栏
- 点击空白区域取消选择

**English**:
- Click connection line or label to select
- Toolbar auto-positions near click location
- Mutually exclusive selection (connection line vs. blank section)
- Auto-hide toolbar in connection mode
- Click blank area to deselect

### 性能优化 / Performance Optimization

**中文**:
- SVG 渲染，缩放不失真
- 事件委托，减少内存占用
- 按需渲染，提高响应速度

**English**:
- SVG rendering, no distortion when zooming
- Event delegation, reduced memory usage
- On-demand rendering, improved responsiveness

---

## 与 Obsidian Canvas 的兼容性 / Obsidian Canvas Compatibility

**中文**:
- 数据结构符合 JSON Canvas 规范
- 支持导出为 .canvas 文件
- 颜色方案与 Obsidian 保持一致
- 可与 Obsidian 互相导入导出

**English**:
- Data structure complies with JSON Canvas specification
- Support export as .canvas file
- Color scheme consistent with Obsidian
- Can import/export with Obsidian

---

## 快捷键 / Keyboard Shortcuts

**中文**:
- 目前暂无快捷键支持
- 未来可能添加：
  - `Delete` / `Backspace`: 删除选中的连接线
  - `C`: 打开颜色选择器
  - `F`: 定位到选中的连接线
  - `R`: 切换连接线方向
  - `E`: 编辑标签

**English**:
- No keyboard shortcuts currently supported
- Possible future additions:
  - `Delete` / `Backspace`: Delete selected connection line
  - `C`: Open color picker
  - `F`: Locate to selected connection line
  - `R`: Toggle connection line direction
  - `E`: Edit label

---

## 使用建议 / Usage Tips

**中文**:
1. **颜色编码**: 使用不同颜色表示不同类型的关系
2. **标签简洁**: 标签文字尽量简短，避免遮挡连接线
3. **方向一致**: 保持同类关系的方向一致，便于理解
4. **定期整理**: 使用定位功能检查所有连接线，删除无用的连接
5. **主题适配**: 选择颜色时考虑浅色/深色主题的可见性

**English**:
1. **Color Coding**: Use different colors to represent different types of relationships
2. **Concise Labels**: Keep label text short to avoid obscuring connection lines
3. **Consistent Direction**: Keep the direction of similar relationships consistent for better understanding
4. **Regular Cleanup**: Use the locate function to check all connection lines and delete unused ones
5. **Theme Adaptation**: Consider visibility in light/dark themes when choosing colors

---

## 常见问题 / FAQ

### Q: 如何删除连接线？/ How to delete a connection line?
**中文**: 点击连接线选中后，点击工具栏的删除按钮（垃圾桶图标）。

**English**: Click the connection line to select it, then click the delete button (trash icon) in the toolbar.

### Q: 标签文字太长怎么办？/ What if the label text is too long?
**中文**: 建议使用简短的标签（3-5 个字），或者使用缩写。未来可能支持多行标签。

**English**: It's recommended to use short labels (3-5 characters) or abbreviations. Multi-line labels may be supported in the future.

### Q: 可以批量修改连接线颜色吗？/ Can I batch modify connection line colors?
**中文**: 目前不支持批量操作，需要逐个修改。未来可能添加批量编辑功能。

**English**: Batch operations are not currently supported; you need to modify them one by one. Batch editing may be added in the future.

### Q: 连接线可以弯曲吗？/ Can connection lines be curved?
**中文**: 连接线使用贝塞尔曲线自动弯曲，无需手动调整。曲线的弯曲程度根据连接线长度自动计算。

**English**: Connection lines automatically curve using Bézier curves without manual adjustment. The degree of curvature is automatically calculated based on the line length.

### Q: 如何导出连接线数据？/ How to export connection line data?
**中文**: 连接线数据保存在 localStorage 中，可以通过浏览器开发者工具导出。未来可能添加一键导出功能。

**English**: Connection line data is saved in localStorage and can be exported via browser developer tools. One-click export may be added in the future.

---

## 更新日志 / Changelog

### v1.0.0 (2025-11-06)
**中文**:
- ✨ 新增连接线工具栏
- ✨ 支持 5 个核心功能：删除、颜色、定位、方向、标签
- ✨ 支持 6 种预设颜色和自定义颜色
- ✨ 支持连接线标签编辑
- ✨ 自动适配浅色/深色主题
- ✨ 数据持久化到 localStorage
- ✨ 与 Obsidian Canvas 规范兼容

**English**:
- ✨ Added connection line toolbar
- ✨ Support 5 core features: Delete, Color, Locate, Direction, Label
- ✨ Support 6 preset colors and custom colors
- ✨ Support connection line label editing
- ✨ Auto-adapt to light/dark themes
- ✨ Data persistence to localStorage
- ✨ Compatible with Obsidian Canvas specification

---

## 反馈与建议 / Feedback and Suggestions

**中文**: 如有任何问题或建议，欢迎反馈！

**English**: If you have any questions or suggestions, feel free to provide feedback!
